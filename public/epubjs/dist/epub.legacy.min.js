!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("xmldom"),require("JSZip")):"function"==typeof define&&define.amd?define(["xmldom","JSZip"],e):"object"==typeof exports?exports.ePub=e(require("xmldom"),require("JSZip")):t.ePub=e(t.xmldom,t.JSZip)}(window,(function(t,e){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=157)}([function(t,e,n){"use strict";n.r(e),n.d(e,"requestAnimationFrame",(function(){return o})),n.d(e,"uuid",(function(){return a})),n.d(e,"documentHeight",(function(){return u})),n.d(e,"isElement",(function(){return c})),n.d(e,"isNumber",(function(){return h})),n.d(e,"isFloat",(function(){return l})),n.d(e,"prefixed",(function(){return f})),n.d(e,"defaults",(function(){return d})),n.d(e,"extend",(function(){return p})),n.d(e,"insert",(function(){return v})),n.d(e,"locationOf",(function(){return g})),n.d(e,"indexOfSorted",(function(){return y})),n.d(e,"bounds",(function(){return m})),n.d(e,"borders",(function(){return b})),n.d(e,"nodeBounds",(function(){return w})),n.d(e,"windowBounds",(function(){return k})),n.d(e,"indexOfNode",(function(){return x})),n.d(e,"indexOfTextNode",(function(){return E})),n.d(e,"indexOfElementNode",(function(){return S})),n.d(e,"isXml",(function(){return O})),n.d(e,"createBlob",(function(){return _})),n.d(e,"createBlobUrl",(function(){return C})),n.d(e,"revokeBlobUrl",(function(){return T})),n.d(e,"createBase64Url",(function(){return R})),n.d(e,"type",(function(){return j})),n.d(e,"parse",(function(){return I})),n.d(e,"qs",(function(){return L})),n.d(e,"qsa",(function(){return A})),n.d(e,"qsp",(function(){return N})),n.d(e,"sprint",(function(){return P})),n.d(e,"treeWalker",(function(){return D})),n.d(e,"walk",(function(){return z})),n.d(e,"blob2base64",(function(){return B})),n.d(e,"defer",(function(){return M})),n.d(e,"querySelectorByType",(function(){return q})),n.d(e,"findChildren",(function(){return U})),n.d(e,"parents",(function(){return F})),n.d(e,"filterChildren",(function(){return W})),n.d(e,"getParentByTagName",(function(){return H})),n.d(e,"RangeObject",(function(){return V}));n(52),n(62),n(7),n(14),n(15),n(36),n(85),n(189),n(141),n(191),n(10),n(29),n(16),n(31),n(19),n(61),n(11),n(23),n(48);var i=n(87);function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),s="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function a(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:7&n|8).toString(16)}))}function u(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function c(t){return!(!t||1!=t.nodeType)}function h(t){return!isNaN(parseFloat(t))&&isFinite(t)}function l(t){var e=parseFloat(t);return!1!==h(t)&&("string"==typeof t&&t.indexOf(".")>-1||Math.floor(e)!==e)}function f(t){var e=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=t.toLowerCase(),i=["Webkit","webkit","Moz","O","ms"].length;if("undefined"==typeof document||void 0!==document.body.style[n])return t;for(var r=0;r<i;r++)if(void 0!==document.body.style[e[r]+n])return e[r]+n;return t}function d(t){for(var e=1,n=arguments.length;e<n;e++){var i=arguments[e];for(var r in i)void 0===t[r]&&(t[r]=i[r])}return t}function p(t){var e=[].slice.call(arguments,1);return e.forEach((function(e){e&&Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))})),t}function v(t,e,n){var i=g(t,e,n);return e.splice(i,0,t),i}function g(t,e,n,i,r){var o,s=i||0,a=r||e.length,u=parseInt(s+(a-s)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),a-s<=0?u:(o=n(e[u],t),a-s==1?o>=0?u:u+1:0===o?u:-1===o?g(t,e,n,u,a):g(t,e,n,s,u))}function y(t,e,n,i,r){var o,s=i||0,a=r||e.length,u=parseInt(s+(a-s)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),a-s<=0?-1:(o=n(e[u],t),a-s==1?0===o?u:-1:0===o?u:-1===o?y(t,e,n,u,a):y(t,e,n,s,u))}function m(t){var e=window.getComputedStyle(t),n=0,i=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){n+=parseFloat(e[t])||0})),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:n}}function b(t){var e=window.getComputedStyle(t),n=0,i=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){n+=parseFloat(e[t])||0})),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:n}}function w(t){var e,n=t.ownerDocument;if(t.nodeType==Node.TEXT_NODE){var i=n.createRange();i.selectNodeContents(t),e=i.getBoundingClientRect()}else e=t.getBoundingClientRect();return e}function k(){var t=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function x(t,e){for(var n,i=t.parentNode.childNodes,r=-1,o=0;o<i.length&&((n=i[o]).nodeType===e&&r++,n!=t);o++);return r}function E(t){return x(t,3)}function S(t){return x(t,1)}function O(t){return["xml","opf","ncx"].indexOf(t)>-1}function _(t,e){return new Blob([t],{type:e})}function C(t,e){var n=_(t,e);return s.createObjectURL(n)}function T(t){return s.revokeObjectURL(t)}function R(t,e){if("string"==typeof t)return"data:"+e+";base64,"+btoa(encodeURIComponent(t))}function j(t){return Object.prototype.toString.call(t).slice(8,-1)}function I(t,e,n){var r;return r="undefined"==typeof DOMParser||n?i.DOMParser:DOMParser,65279===t.charCodeAt(0)&&(t=t.slice(1)),(new r).parseFromString(t,e)}function L(t,e){var n;if(!t)throw new Error("No Element Provided");return void 0!==t.querySelector?t.querySelector(e):(n=t.getElementsByTagName(e)).length?n[0]:void 0}function A(t,e){return void 0!==t.querySelector?t.querySelectorAll(e):t.getElementsByTagName(e)}function N(t,e,n){var i,r;if(void 0!==t.querySelector){for(var o in e+="[",n)e+=o+"~='"+n[o]+"'";return e+="]",t.querySelector(e)}if(i=t.getElementsByTagName(e),r=Array.prototype.slice.call(i,0).filter((function(t){for(var e in n)if(t.getAttribute(e)===n[e])return!0;return!1})))return r[0]}function P(t,e){void 0!==(t.ownerDocument||t).createTreeWalker?D(t,e,NodeFilter.SHOW_TEXT):z(t,(function(t){t&&3===t.nodeType&&e(t)}))}function D(t,e,n){for(var i,r=document.createTreeWalker(t,n,null,!1);i=r.nextNode();)e(i)}function z(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(z(t,e))return!0;t=t.nextSibling}while(t)}function B(t){return new Promise((function(e,n){var i=new FileReader;i.readAsDataURL(t),i.onloadend=function(){e(i.result)}}))}function M(){var t=this;this.resolve=null,this.reject=null,this.id=a(),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),Object.freeze(this)}function q(t,e,n){var i;if(void 0!==t.querySelector&&(i=t.querySelector("".concat(e,'[*|type="').concat(n,'"]'))),i&&0!==i.length)return i;i=A(t,e);for(var r=0;r<i.length;r++)if(i[r].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||i[r].getAttribute("epub:type")===n)return i[r]}function U(t){for(var e=[],n=t.childNodes,i=0;i<n.length;i++){var r=n[i];1===r.nodeType&&e.push(r)}return e}function F(t){for(var e=[t];t;t=t.parentNode)e.unshift(t);return e}function W(t,e,n){for(var i=[],r=t.childNodes,o=0;o<r.length;o++){var s=r[o];if(1===s.nodeType&&s.nodeName.toLowerCase()===e){if(n)return s;i.push(s)}}if(!n)return i}function H(t,e){var n;if(null!==t&&""!==e)for(n=t.parentNode;1===n.nodeType;){if(n.tagName.toLowerCase()===e)return n;n=n.parentNode}}var V=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}var e,n,i;return e=t,(n=[{key:"setStart",value:function(t,e){this.startContainer=t,this.startOffset=e,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}},{key:"setEnd",value:function(t,e){this.endContainer=t,this.endOffset=e,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}},{key:"collapse",value:function(t){this.collapsed=!0,t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}},{key:"selectNode",value:function(t){var e=t.parentNode,n=Array.prototype.indexOf.call(e.childNodes,t);this.setStart(e,n),this.setEnd(e,n+1)}},{key:"selectNodeContents",value:function(t){t.childNodes[t.childNodes-1];var e=3===t.nodeType?t.textContent.length:parent.childNodes.length;this.setStart(t,0),this.setEnd(t,e)}},{key:"_commonAncestorContainer",value:function(t,e){var n=F(t||this.startContainer),i=F(e||this.endContainer);if(n[0]==i[0])for(var r=0;r<n.length;r++)if(n[r]!=i[r])return n[r-1]}},{key:"_checkCollapsed",value:function(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}},{key:"toString",value:function(){}}])&&r(e.prototype,n),i&&r(e,i),t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o}));var i="0.3",r=["keydown","keyup","keypressed","mouseup","mousedown","click","touchend","touchstart","touchmove"],o={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}}},function(t,e,n){"use strict";n(64),n(65),n(66),n(52),n(62),n(7),n(14),n(15),n(147),n(40),n(36),n(10),n(16),n(31),n(19),n(148),n(39),n(11),n(23);var i=n(0);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e,n,o){var s;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof t))return new t(e,n,o);if("string"==typeof n?this.base=this.parseComponent(n):"object"===r(n)&&n.steps&&(this.base=n),"string"===(s=this.checkType(e)))return this.str=e,Object(i.extend)(this,this.parse(e));if("range"===s)return Object(i.extend)(this,this.fromRange(e,this.base,o));if("node"===s)return Object(i.extend)(this,this.fromNode(e,this.base,o));if("EpubCFI"===s&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}var e,n,s;return e=t,(n=[{key:"checkType",value:function(e){return this.isCfiString(e)?"string":!e||"object"!==r(e)||"Range"!==Object(i.type)(e)&&void 0===e.startContainer?e&&"object"===r(e)&&void 0!==e.nodeType?"node":!!(e&&"object"===r(e)&&e instanceof t)&&"EpubCFI":"range"}},{key:"parse",value:function(t){var e,n,i,r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof t?{spinePos:-1}:(0===t.indexOf("epubcfi(")&&")"===t[t.length-1]&&(t=t.slice(8,t.length-1)),(e=this.getChapterComponent(t))?(r.base=this.parseComponent(e),n=this.getPathComponent(t),r.path=this.parseComponent(n),(i=this.getRange(t))&&(r.range=!0,r.start=this.parseComponent(i[0]),r.end=this.parseComponent(i[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}},{key:"parseComponent",value:function(t){var e,n={steps:[],terminal:{offset:null,assertion:null}},i=t.split(":"),r=i[0].split("/");return i.length>1&&(e=i[1],n.terminal=this.parseTerminal(e)),""===r[0]&&r.shift(),n.steps=r.map(function(t){return this.parseStep(t)}.bind(this)),n}},{key:"parseStep",value:function(t){var e,n,i,r,o;if((r=t.match(/\[(.*)\]/))&&r[1]&&(o=r[1]),n=parseInt(t),!isNaN(n))return n%2==0?(e="element",i=n/2-1):(e="text",i=(n-1)/2),{type:e,index:i,id:o||null}}},{key:"parseTerminal",value:function(t){var e,n,r=t.match(/\[(.*)\]/);return r&&r[1]?(e=parseInt(t.split("[")[0]),n=r[1]):e=parseInt(t),Object(i.isNumber)(e)||(e=null),{offset:e,assertion:n}}},{key:"getChapterComponent",value:function(t){return t.split("!")[0]}},{key:"getPathComponent",value:function(t){var e=t.split("!");if(e[1])return e[1].split(",")[0]}},{key:"getRange",value:function(t){var e=t.split(",");return 3===e.length&&[e[1],e[2]]}},{key:"getCharecterOffsetComponent",value:function(t){return t.split(":")[1]||""}},{key:"joinSteps",value:function(t){return t?t.map((function(t){var e="";return"element"===t.type&&(e+=2*(t.index+1)),"text"===t.type&&(e+=1+2*t.index),t.id&&(e+="["+t.id+"]"),e})).join("/"):""}},{key:"segmentString",value:function(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&null!=t.terminal.offset&&(e+=":"+t.terminal.offset),t.terminal&&null!=t.terminal.assertion&&(e+="["+t.terminal.assertion+"]"),e}},{key:"toString",value:function(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+=")"}},{key:"compare",value:function(e,n){var i,r,o,s;if("string"==typeof e&&(e=new t(e)),"string"==typeof n&&(n=new t(n)),e.spinePos>n.spinePos)return 1;if(e.spinePos<n.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),o=e.start.terminal):(i=e.path.steps,o=e.path.terminal),n.range?(r=n.path.steps.concat(n.start.steps),s=n.start.terminal):(r=n.path.steps,s=n.path.terminal);for(var a=0;a<i.length;a++){if(!i[a])return-1;if(!r[a])return 1;if(i[a].index>r[a].index)return 1;if(i[a].index<r[a].index)return-1}return i.length<r.length?-1:o.offset>s.offset?1:o.offset<s.offset?-1:0}},{key:"step",value:function(t){var e=3===t.nodeType?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}}},{key:"filteredStep",value:function(t,e){var n,i=this.filter(t,e);if(i)return n=3===i.nodeType?"text":"element",{id:i.id,tagName:i.tagName,type:n,index:this.filteredPosition(i,e)}}},{key:"pathTo",value:function(t,e,n){for(var i,r={steps:[],terminal:{offset:null,assertion:null}},o=t;o&&o.parentNode&&9!=o.parentNode.nodeType;)(i=n?this.filteredStep(o,n):this.step(o))&&r.steps.unshift(i),o=o.parentNode;return null!=e&&e>=0&&(r.terminal.offset=e,"text"!=r.steps[r.steps.length-1].type&&r.steps.push({type:"text",index:0})),r}},{key:"equalStep",value:function(t,e){return!(!t||!e)&&t.index===e.index&&t.id===e.id&&t.type===e.type}},{key:"fromRange",value:function(t,e,n){var i={range:!1,base:{},path:{},start:null,end:null},o=t.startContainer,s=t.endContainer,a=t.startOffset,u=t.endOffset,c=!1;if(n&&(c=null!=o.ownerDocument.querySelector("."+n)),"string"==typeof e?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):"object"===r(e)&&(i.base=e),t.collapsed)c&&(a=this.patchOffset(o,a,n)),i.path=this.pathTo(o,a,n);else{i.range=!0,c&&(a=this.patchOffset(o,a,n)),i.start=this.pathTo(o,a,n),c&&(u=this.patchOffset(s,u,n)),i.end=this.pathTo(s,u,n),i.path={steps:[],terminal:null};var h,l=i.start.steps.length;for(h=0;h<l&&this.equalStep(i.start.steps[h],i.end.steps[h]);h++)h===l-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[h]),i.range=!1):i.path.steps.push(i.start.steps[h]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}},{key:"fromNode",value:function(t,e,n){var i={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof e?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):"object"===r(e)&&(i.base=e),i.path=this.pathTo(t,null,n),i}},{key:"filter",value:function(t,e){var n,i,r,o,s,a=!1;return 3===t.nodeType?(a=!0,r=t.parentNode,n=t.parentNode.classList.contains(e)):(a=!1,n=t.classList.contains(e)),n&&a?(o=r.previousSibling,s=r.nextSibling,o&&3===o.nodeType?i=o:s&&3===s.nodeType&&(i=s),i||t):!(n&&!a)&&t}},{key:"patchOffset",value:function(t,e,n){if(3!=t.nodeType)throw new Error("Anchor must be a text node");var i=t,r=e;for(t.parentNode.classList.contains(n)&&(i=t.parentNode);i.previousSibling;){if(1===i.previousSibling.nodeType){if(!i.previousSibling.classList.contains(n))break;r+=i.previousSibling.textContent.length}else r+=i.previousSibling.textContent.length;i=i.previousSibling}return r}},{key:"normalizedMap",value:function(t,e,n){var i,r,o,s={},a=-1,u=t.length;for(i=0;i<u;i++)1===(r=t[i].nodeType)&&t[i].classList.contains(n)&&(r=3),i>0&&3===r&&3===o?s[i]=a:e===r&&(a+=1,s[i]=a),o=r;return s}},{key:"position",value:function(t){var e,n;return 1===t.nodeType?((e=t.parentNode.children)||(e=Object(i.findChildren)(t.parentNode)),n=Array.prototype.indexOf.call(e,t)):n=(e=this.textNodes(t.parentNode)).indexOf(t),n}},{key:"filteredPosition",value:function(t,e){var n,i;return 1===t.nodeType?(n=t.parentNode.children,i=this.normalizedMap(n,1,e)):(n=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(n=(t=t.parentNode).parentNode.childNodes),i=this.normalizedMap(n,3,e)),i[Array.prototype.indexOf.call(n,t)]}},{key:"stepsToXpath",value:function(t){var e=[".","*"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("*[position()="+n+" and @id='"+t.id+"']"):"text"===t.type?e.push("text()["+n+"]"):e.push("*["+n+"]")})),e.join("/")}},{key:"stepsToQuerySelector",value:function(t){var e=["html"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("#"+t.id):"text"===t.type||e.push("*:nth-child("+n+")")})),e.join(">")}},{key:"textNodes",value:function(t,e){return Array.prototype.slice.call(t.childNodes).filter((function(t){return 3===t.nodeType||!(!e||!t.classList.contains(e))}))}},{key:"walkToNode",value:function(t,e,n){var r,o,s=e||document,a=s.documentElement,u=t.length;for(o=0;o<u&&("element"===(r=t[o]).type?a=r.id?s.getElementById(r.id):(a.children||Object(i.findChildren)(a))[r.index]:"text"===r.type&&(a=this.textNodes(a,n)[r.index]),a);o++);return a}},{key:"findNode",value:function(t,e,n){var i,r,o=e||document;return n||void 0===o.evaluate?i=n?this.walkToNode(t,o,n):this.walkToNode(t,o):(r=this.stepsToXpath(t),i=o.evaluate(r,o,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),i}},{key:"fixMiss",value:function(t,e,n,i){var r,o,s=this.findNode(t.slice(0,-1),n,i),a=s.childNodes,u=this.normalizedMap(a,3,i),c=t[t.length-1].index;for(var h in u){if(!u.hasOwnProperty(h))return;if(u[h]===c){if(!(e>(o=(r=a[h]).textContent.length))){s=1===r.nodeType?r.childNodes[0]:r;break}e-=o}}return{container:s,offset:e}}},{key:"toRange",value:function(t,e){var n,r,o,s,a,u,c,h,l=t||document,f=!!e&&null!=l.querySelector("."+e);if(n=void 0!==l.createRange?l.createRange():new i.RangeObject,this.range?(r=this.start,u=this.path.steps.concat(r.steps),s=this.findNode(u,l,f?e:null),o=this.end,c=this.path.steps.concat(o.steps),a=this.findNode(c,l,f?e:null)):(r=this.path,u=this.path.steps,s=this.findNode(this.path.steps,l,f?e:null)),!s)return console.log("No startContainer found for",this.toString()),null;try{null!=r.terminal.offset?n.setStart(s,r.terminal.offset):n.setStart(s,0)}catch(t){h=this.fixMiss(u,r.terminal.offset,l,f?e:null),n.setStart(h.container,h.offset)}if(a)try{null!=o.terminal.offset?n.setEnd(a,o.terminal.offset):n.setEnd(a,0)}catch(t){h=this.fixMiss(c,this.end.terminal.offset,l,f?e:null),n.setEnd(h.container,h.offset)}return n}},{key:"isCfiString",value:function(t){return"string"==typeof t&&0===t.indexOf("epubcfi(")&&")"===t[t.length-1]}},{key:"generateChapterComponent",value:function(t,e,n){var i="/"+2*(t+1)+"/";return i+=2*(parseInt(e)+1),n&&(i+="["+n+"]"),i}},{key:"collapse",value:function(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}])&&o(e.prototype,n),s&&o(e,s),t}();e.a=s},function(t,e,n){var i=n(6),r=n(45).f,o=n(27),s=n(28),a=n(91),u=n(119),c=n(97);t.exports=function(t,e){var n,h,l,f,d,p=t.target,v=t.global,g=t.stat;if(n=v?i:g?i[p]||a(p,{}):(i[p]||{}).prototype)for(h in e){if(f=e[h],l=t.noTargetGet?(d=r(n,h))&&d.value:n[h],!c(v?h:p+(g?".":"#")+h,t.forced)&&void 0!==l){if(typeof f==typeof l)continue;u(f,l)}(t.sham||l&&l.sham)&&o(f,"sham",!0),s(n,h,f,t)}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var i=n(6),r=n(93),o=n(13),s=n(73),a=n(99),u=n(122),c=r("wks"),h=i.Symbol,l=u?h:h&&h.withoutSetter||s;t.exports=function(t){return o(c,t)||(a&&o(h,t)?c[t]=h[t]:c[t]=l("Symbol."+t)),c[t]}},function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n(70))},function(t,e,n){"use strict";var i=n(3),r=n(139);i({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(8);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,n){var i=n(104),r=n(28),o=n(166);i||r(Object.prototype,"toString",o,{unsafe:!0})},function(t,e,n){var i=n(6),r=n(138),o=n(139),s=n(27);for(var a in r){var u=i[a],c=u&&u.prototype;if(c&&c.forEach!==o)try{s(c,"forEach",o)}catch(t){c.forEach=o}}},function(t,e,n){"use strict";var i,r,o,s,a,u,c,h=n(174),l=n(188),f=Function.prototype.apply,d=Function.prototype.call,p=Object.create,v=Object.defineProperty,g=Object.defineProperties,y=Object.prototype.hasOwnProperty,m={configurable:!0,enumerable:!1,writable:!0};r=function(t,e){var n,r;return l(e),r=this,i.call(this,t,n=function(){o.call(r,t,n),f.call(e,this,arguments)}),n.__eeOnceListener__=e,this},a={on:i=function(t,e){var n;return l(e),y.call(this,"__ee__")?n=this.__ee__:(n=m.value=p(null),v(this,"__ee__",m),m.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},once:r,off:o=function(t,e){var n,i,r,o;if(l(e),!y.call(this,"__ee__"))return this;if(!(n=this.__ee__)[t])return this;if("object"==typeof(i=n[t]))for(o=0;r=i[o];++o)r!==e&&r.__eeOnceListener__!==e||(2===i.length?n[t]=i[o?0:1]:i.splice(o,1));else i!==e&&i.__eeOnceListener__!==e||delete n[t];return this},emit:s=function(t){var e,n,i,r,o;if(y.call(this,"__ee__")&&(r=this.__ee__[t]))if("object"==typeof r){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(r=r.slice(),e=0;i=r[e];++e)f.call(i,this,o)}else switch(arguments.length){case 1:d.call(r,this);break;case 2:d.call(r,this,arguments[1]);break;case 3:d.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];f.call(r,this,o)}}},u={on:h(i),once:h(r),off:h(o),emit:h(s)},c=g({},u),t.exports=e=function(t){return null==t?p(c):g(Object(t),u)},e.methods=a},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var i=n(3),r=n(94).indexOf,o=n(77),s=n(35),a=[].indexOf,u=!!a&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),h=s("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:u||!c||!h},{indexOf:function(t){return u?a.apply(this,arguments)||0:r(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";var i=n(32),r=n(78),o=n(58),s=n(34),a=n(126),u=s.set,c=s.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,e){u(this,{type:"Array Iterator",target:i(t),index:0,kind:e})}),(function(){var t=c(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var i=n(3),r=n(82);i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},function(t,e,n){"use strict";n(14),n(15),n(36),n(10),n(16),n(19),n(23),n(48);var i=n(26),r=n.n(i);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.indexOf("://")>-1&&(e=new URL(e).pathname),n=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=n.dir+"/",this.filename=n.base,this.extension=n.ext.slice(1)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){return r.a.parse(t)}},{key:"isAbsolute",value:function(t){return r.a.isAbsolute(t||this.path)}},{key:"isDirectory",value:function(t){return"/"===t.charAt(t.length-1)}},{key:"resolve",value:function(t){return r.a.resolve(this.directory,t)}},{key:"relative",value:function(t){return t&&t.indexOf("://")>-1?t:r.a.relative(this.directory,t)}},{key:"splitPath",value:function(t){return this.splitPathRe.exec(t).slice(1)}},{key:"toString",value:function(){return this.path}}])&&o(e.prototype,n),i&&o(e,i),t}();e.a=s},function(t,e,n){var i=n(4);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){"use strict";var i=n(107).charAt,r=n(34),o=n(126),s=r.set,a=r.getterFor("String Iterator");o(String,"String",(function(t){s(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=a(this),n=e.string,r=e.index;return r>=n.length?{value:void 0,done:!0}:(t=i(n,r),e.index+=t.length,{value:t,done:!1})}))},function(t,e,n){"use strict";n(14),n(15),n(10),n(16),n(19),n(196),n(23),n(48);var i=n(17),r=n(26),o=n.n(r);function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=e.indexOf("://")>-1,o=e;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=n,!r&&!1!==n&&"string"!=typeof n&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,o=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(t){this.Url=void 0,this.base&&(o=new i.a(this.base).resolve(o))}this.Path=new i.a(o),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}var e,n,r;return e=t,(n=[{key:"path",value:function(){return this.Path}},{key:"resolve",value:function(t){var e;return t.indexOf("://")>-1?t:(e=o.a.resolve(this.directory,t),this.origin+e)}},{key:"relative",value:function(t){return o.a.relative(t,this.directory)}},{key:"toString",value:function(){return this.href}}])&&s(e.prototype,n),r&&s(e,r),t}();e.a=a},function(t,e,n){var i=n(18),r=n(117),o=n(9),s=n(71),a=Object.defineProperty;e.f=i?a:function(t,e,n){if(o(t),e=s(e,!0),o(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(42),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(6),r=n(138),o=n(15),s=n(27),a=n(5),u=a("iterator"),c=a("toStringTag"),h=o.values;for(var l in r){var f=i[l],d=f&&f.prototype;if(d){if(d[u]!==h)try{s(d,u,h)}catch(t){d[u]=h}if(d[c]||s(d,c,l),r[l])for(var p in o)if(d[p]!==o[p])try{s(d,p,o[p])}catch(t){d[p]=o[p]}}}},function(t,e,n){"use strict";n(7),n(15),n(85),n(10),n(29),n(19),n(11),n(23);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e||this,this.hooks=[]}var e,n,r;return e=t,(n=[{key:"register",value:function(){for(var t=0;t<arguments.length;++t)if("function"==typeof arguments[t])this.hooks.push(arguments[t]);else for(var e=0;e<arguments[t].length;++e)this.hooks.push(arguments[t][e])}},{key:"deregister",value:function(t){for(var e=0;e<this.hooks.length;e++)if(this.hooks[e]===t){this.hooks.splice(e,1);break}}},{key:"trigger",value:function(){var t=arguments,e=this.context,n=[];return this.hooks.forEach((function(i){var r=i.apply(e,t);r&&"function"==typeof r.then&&n.push(r)})),Promise.all(n)}},{key:"list",value:function(){return this.hooks}},{key:"clear",value:function(){return this.hooks=[]}}])&&i(e.prototype,n),r&&i(e,r),t}();e.a=r},function(t,e,n){var i=n(33);t.exports=function(t){return Object(i(t))}},function(t,e,n){"use strict";if(!i)var i={cwd:function(){return"/"}};function r(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+t)}function o(t,e){for(var n,i="",r=-1,o=0,s=0;s<=t.length;++s){if(s<t.length)n=t.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(r===s-1||1===o);else if(r!==s-1&&2===o){if(i.length<2||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){for(var a=i.length-1,u=a;u>=0&&47!==i.charCodeAt(u);--u);if(u!==a){i=-1===u?"":i.slice(0,u),r=s,o=0;continue}}else if(2===i.length||1===i.length){i="",r=s,o=0;continue}e&&(i.length>0?i+="/..":i="..")}else i.length>0?i+="/"+t.slice(r+1,s):i=t.slice(r+1,s);r=s,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var s={resolve:function(){for(var t,e="",n=!1,s=arguments.length-1;s>=-1&&!n;s--){var a;s>=0?a=arguments[s]:(void 0===t&&(t=i.cwd()),a=t),r(a),0!==a.length&&(e=a+"/"+e,n=47===a.charCodeAt(0))}return e=o(e,!n),n?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(t){if(r(t),0===t.length)return".";var e=47===t.charCodeAt(0),n=47===t.charCodeAt(t.length-1);return 0!==(t=o(t,!e)).length||e||(t="."),t.length>0&&n&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return r(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var n=arguments[e];r(n),n.length>0&&(void 0===t?t=n:t+="/"+n)}return void 0===t?".":s.normalize(t)},relative:function(t,e){if(r(t),r(e),t===e)return"";if((t=s.resolve(t))===(e=s.resolve(e)))return"";for(var n=1;n<t.length&&47===t.charCodeAt(n);++n);for(var i=t.length,o=i-n,a=1;a<e.length&&47===e.charCodeAt(a);++a);for(var u=e.length-a,c=o<u?o:u,h=-1,l=0;l<=c;++l){if(l===c){if(u>c){if(47===e.charCodeAt(a+l))return e.slice(a+l+1);if(0===l)return e.slice(a+l)}else o>c&&(47===t.charCodeAt(n+l)?h=l:0===l&&(h=0));break}var f=t.charCodeAt(n+l);if(f!==e.charCodeAt(a+l))break;47===f&&(h=l)}var d="";for(l=n+h+1;l<=i;++l)l!==i&&47!==t.charCodeAt(l)||(0===d.length?d+="..":d+="/..");return d.length>0?d+e.slice(a+h):(a+=h,47===e.charCodeAt(a)&&++a,e.slice(a))},_makeLong:function(t){return t},dirname:function(t){if(r(t),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,i=-1,o=!0,s=t.length-1;s>=1;--s)if(47===(e=t.charCodeAt(s))){if(!o){i=s;break}}else o=!1;return-1===i?n?"/":".":n&&1===i?"//":t.slice(0,i)},basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');r(t);var n,i=0,o=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,u=-1;for(n=t.length-1;n>=0;--n){var c=t.charCodeAt(n);if(47===c){if(!s){i=n+1;break}}else-1===u&&(s=!1,u=n+1),a>=0&&(c===e.charCodeAt(a)?-1==--a&&(o=n):(a=-1,o=u))}return i===o?o=u:-1===o&&(o=t.length),t.slice(i,o)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!s){i=n+1;break}}else-1===o&&(s=!1,o=n+1);return-1===o?"":t.slice(i,o)},extname:function(t){r(t);for(var e=-1,n=0,i=-1,o=!0,s=0,a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(47!==u)-1===i&&(o=!1,i=a+1),46===u?-1===e?e=a:1!==s&&(s=1):-1!==e&&(s=-1);else if(!o){n=a+1;break}}return-1===e||-1===i||0===s||1===s&&e===i-1&&e===n+1?"":t.slice(e,i)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof t);return function(t,e){var n=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+i:n+t+i:i}("/",t)},parse:function(t){r(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var n,i=t.charCodeAt(0),o=47===i;o?(e.root="/",n=1):n=0;for(var s=-1,a=0,u=-1,c=!0,h=t.length-1,l=0;h>=n;--h)if(47!==(i=t.charCodeAt(h)))-1===u&&(c=!1,u=h+1),46===i?-1===s?s=h:1!==l&&(l=1):-1!==s&&(l=-1);else if(!c){a=h+1;break}return-1===s||-1===u||0===l||1===l&&s===u-1&&s===a+1?-1!==u&&(e.base=e.name=0===a&&o?t.slice(1,u):t.slice(a,u)):(0===a&&o?(e.name=t.slice(1,s),e.base=t.slice(1,u)):(e.name=t.slice(a,s),e.base=t.slice(a,u)),e.ext=t.slice(s,u)),a>0?e.dir=t.slice(0,a-1):o&&(e.dir="/"),e},sep:"/",delimiter:":",posix:null};t.exports=s},function(t,e,n){var i=n(18),r=n(21),o=n(46);t.exports=i?function(t,e,n){return r.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(6),r=n(27),o=n(13),s=n(91),a=n(92),u=n(34),c=u.get,h=u.enforce,l=String(String).split("String");(t.exports=function(t,e,n,a){var u=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,f=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||r(n,"name",e),h(n).source=l.join("string"==typeof e?e:"")),t!==i?(u?!f&&t[e]&&(c=!0):delete t[e],c?t[e]=n:r(t,e,n)):c?t[e]=n:s(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},function(t,e,n){"use strict";var i,r,o,s,a=n(3),u=n(47),c=n(6),h=n(38),l=n(167),f=n(28),d=n(102),p=n(43),v=n(103),g=n(8),y=n(44),m=n(80),b=n(37),w=n(92),k=n(168),x=n(169),E=n(133),S=n(134).set,O=n(170),_=n(171),C=n(172),T=n(136),R=n(173),j=n(34),I=n(97),L=n(5),A=n(100),N=L("species"),P="Promise",D=j.get,z=j.set,B=j.getterFor(P),M=l,q=c.TypeError,U=c.document,F=c.process,W=h("fetch"),H=T.f,V=H,X="process"==b(F),G=!!(U&&U.createEvent&&c.dispatchEvent),Y=I(P,(function(){if(!(w(M)!==String(M))){if(66===A)return!0;if(!X&&"function"!=typeof PromiseRejectionEvent)return!0}if(u&&!M.prototype.finally)return!0;if(A>=51&&/native code/.test(M))return!1;var t=M.resolve(1),e=function(t){t((function(){}),(function(){}))};return(t.constructor={})[N]=e,!(t.then((function(){}))instanceof e)})),K=Y||!x((function(t){M.all(t).catch((function(){}))})),$=function(t){var e;return!(!g(t)||"function"!=typeof(e=t.then))&&e},Z=function(t,e,n){if(!e.notified){e.notified=!0;var i=e.reactions;O((function(){for(var r=e.value,o=1==e.state,s=0;i.length>s;){var a,u,c,h=i[s++],l=o?h.ok:h.fail,f=h.resolve,d=h.reject,p=h.domain;try{l?(o||(2===e.rejection&&et(t,e),e.rejection=1),!0===l?a=r:(p&&p.enter(),a=l(r),p&&(p.exit(),c=!0)),a===h.promise?d(q("Promise-chain cycle")):(u=$(a))?u.call(a,f,d):f(a)):d(r)}catch(t){p&&!c&&p.exit(),d(t)}}e.reactions=[],e.notified=!1,n&&!e.rejection&&Q(t,e)}))}},J=function(t,e,n){var i,r;G?((i=U.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),c.dispatchEvent(i)):i={promise:e,reason:n},(r=c["on"+t])?r(i):"unhandledrejection"===t&&C("Unhandled promise rejection",n)},Q=function(t,e){S.call(c,(function(){var n,i=e.value;if(tt(e)&&(n=R((function(){X?F.emit("unhandledRejection",i,t):J("unhandledrejection",t,i)})),e.rejection=X||tt(e)?2:1,n.error))throw n.value}))},tt=function(t){return 1!==t.rejection&&!t.parent},et=function(t,e){S.call(c,(function(){X?F.emit("rejectionHandled",t):J("rejectionhandled",t,e.value)}))},nt=function(t,e,n,i){return function(r){t(e,n,r,i)}},it=function(t,e,n,i){e.done||(e.done=!0,i&&(e=i),e.value=n,e.state=2,Z(t,e,!0))},rt=function(t,e,n,i){if(!e.done){e.done=!0,i&&(e=i);try{if(t===n)throw q("Promise can't be resolved itself");var r=$(n);r?O((function(){var i={done:!1};try{r.call(n,nt(rt,t,i,e),nt(it,t,i,e))}catch(n){it(t,i,n,e)}})):(e.value=n,e.state=1,Z(t,e,!1))}catch(n){it(t,{done:!1},n,e)}}};Y&&(M=function(t){m(this,M,P),y(t),i.call(this);var e=D(this);try{t(nt(rt,this,e),nt(it,this,e))}catch(t){it(this,e,t)}},(i=function(t){z(this,{type:P,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=d(M.prototype,{then:function(t,e){var n=B(this),i=H(E(this,M));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=X?F.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&Z(this,n,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new i,e=D(t);this.promise=t,this.resolve=nt(rt,t,e),this.reject=nt(it,t,e)},T.f=H=function(t){return t===M||t===o?new r(t):V(t)},u||"function"!=typeof l||(s=l.prototype.then,f(l.prototype,"then",(function(t,e){var n=this;return new M((function(t,e){s.call(n,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof W&&a({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return _(M,W.apply(c,arguments))}}))),a({global:!0,wrap:!0,forced:Y},{Promise:M}),p(M,P,!1,!0),v(P),o=h(P),a({target:P,stat:!0,forced:Y},{reject:function(t){var e=H(this);return e.reject.call(void 0,t),e.promise}}),a({target:P,stat:!0,forced:u||Y},{resolve:function(t){return _(u&&this===o?M:this,t)}}),a({target:P,stat:!0,forced:K},{all:function(t){var e=this,n=H(e),i=n.resolve,r=n.reject,o=R((function(){var n=y(e.resolve),o=[],s=0,a=1;k(t,(function(t){var u=s++,c=!1;o.push(void 0),a++,n.call(e,t).then((function(t){c||(c=!0,o[u]=t,--a||i(o))}),r)})),--a||i(o)}));return o.error&&r(o.value),n.promise},race:function(t){var e=this,n=H(e),i=n.reject,r=R((function(){var r=y(e.resolve);k(t,(function(t){r.call(e,t).then(n.resolve,i)}))}));return r.error&&i(r.value),n.promise}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return u})),n.d(e,"e",(function(){return c}));n(7),n(14),n(200),n(16),n(31),n(61),n(11);var i=n(0),r=n(20);n(17);function o(t,e){var n,r,o=e.url,s=o.indexOf("://")>-1;t&&(r=Object(i.qs)(t,"head"),(n=Object(i.qs)(r,"base"))||(n=t.createElement("base"),r.insertBefore(n,r.firstChild)),!s&&window&&window.location&&(o=window.location.origin+o),n.setAttribute("href",o))}function s(t,e){var n,r,o=e.canonical;t&&(n=Object(i.qs)(t,"head"),(r=Object(i.qs)(n,"link[rel='canonical']"))?r.setAttribute("href",o):((r=t.createElement("link")).setAttribute("rel","canonical"),r.setAttribute("href",o),n.appendChild(r)))}function a(t,e){var n,r,o=e.idref;t&&(n=Object(i.qs)(t,"head"),(r=Object(i.qs)(n,"link[property='dc.identifier']"))?r.setAttribute("content",o):((r=t.createElement("meta")).setAttribute("name","dc.identifier"),r.setAttribute("content",o),n.appendChild(r)))}function u(t,e){var n=t.querySelectorAll("a[href]");if(n.length)for(var o=Object(i.qs)(t.ownerDocument,"base"),s=o?o.getAttribute("href"):void 0,a=function(t){var n=t.getAttribute("href");if(0!==n.indexOf("mailto:"))if(n.indexOf("://")>-1)t.setAttribute("target","_blank");else{var i;try{i=new r.a(n,s)}catch(t){}t.onclick=function(){return i&&i.hash?e(i.Path.path+i.hash):e(i?i.Path.path:n),!1}}}.bind(this),u=0;u<n.length;u++)a(n[u])}function c(t,e,n){return e.forEach((function(e,i){e&&n[i]&&(e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),t=t.replace(new RegExp(e,"g"),n[i]))})),t}},function(t,e,n){"use strict";var i=n(28),r=n(9),o=n(4),s=n(106),a=RegExp.prototype,u=a.toString,c=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),h="toString"!=u.name;(c||h)&&i(RegExp.prototype,"toString",(function(){var t=r(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in a)?s.call(t):n)}),{unsafe:!0})},function(t,e,n){var i=n(53),r=n(33);t.exports=function(t){return i(r(t))}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,n){var i,r,o,s=n(158),a=n(6),u=n(8),c=n(27),h=n(13),l=n(72),f=n(54),d=a.WeakMap;if(s){var p=new d,v=p.get,g=p.has,y=p.set;i=function(t,e){return y.call(p,t,e),e},r=function(t){return v.call(p,t)||{}},o=function(t){return g.call(p,t)}}else{var m=l("state");f[m]=!0,i=function(t,e){return c(t,m,e),e},r=function(t){return h(t,m)?t[m]:{}},o=function(t){return h(t,m)}}t.exports={set:i,get:r,has:o,enforce:function(t){return o(t)?r(t):i(t,{})},getterFor:function(t){return function(e){var n;if(!u(e)||(n=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var i=n(18),r=n(4),o=n(13),s=Object.defineProperty,a={},u=function(t){throw t};t.exports=function(t,e){if(o(a,t))return a[t];e||(e={});var n=[][t],c=!!o(e,"ACCESSORS")&&e.ACCESSORS,h=o(e,0)?e[0]:u,l=o(e,1)?e[1]:void 0;return a[t]=!!n&&!r((function(){if(c&&!i)return!0;var t={length:-1};c?s(t,1,{enumerable:!0,get:u}):t[1]=1,n.call(t,h,l)}))}},function(t,e,n){"use strict";var i=n(3),r=n(8),o=n(75),s=n(74),a=n(22),u=n(32),c=n(76),h=n(5),l=n(56),f=n(35),d=l("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),v=h("species"),g=[].slice,y=Math.max;i({target:"Array",proto:!0,forced:!d||!p},{slice:function(t,e){var n,i,h,l=u(this),f=a(l.length),d=s(t,f),p=s(void 0===e?f:e,f);if(o(l)&&("function"!=typeof(n=l.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[v])&&(n=void 0):n=void 0,n===Array||void 0===n))return g.call(l,d,p);for(i=new(void 0===n?Array:n)(y(p-d,0)),h=0;d<p;d++,h++)d in l&&c(i,h,l[d]);return i.length=h,i}})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(120),r=n(6),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(i[t])||o(r[t]):i[t]&&i[t][e]||r[t]&&r[t][e]}},function(t,e,n){"use strict";var i=n(83),r=n(110),o=n(9),s=n(33),a=n(133),u=n(108),c=n(22),h=n(84),l=n(82),f=n(4),d=[].push,p=Math.min,v=!f((function(){return!RegExp(4294967295,"y")}));i("split",2,(function(t,e,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var i=String(s(this)),o=void 0===n?4294967295:n>>>0;if(0===o)return[];if(void 0===t)return[i];if(!r(t))return e.call(i,t,o);for(var a,u,c,h=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,v=new RegExp(t.source,f+"g");(a=l.call(v,i))&&!((u=v.lastIndex)>p&&(h.push(i.slice(p,a.index)),a.length>1&&a.index<i.length&&d.apply(h,a.slice(1)),c=a[0].length,p=u,h.length>=o));)v.lastIndex===a.index&&v.lastIndex++;return p===i.length?!c&&v.test("")||h.push(""):h.push(i.slice(p)),h.length>o?h.slice(0,o):h}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var r=s(this),o=null==e?void 0:e[t];return void 0!==o?o.call(e,r,n):i.call(String(r),e,n)},function(t,r){var s=n(i,t,this,r,i!==e);if(s.done)return s.value;var l=o(t),f=String(this),d=a(l,RegExp),g=l.unicode,y=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(v?"y":"g"),m=new d(v?l:"^(?:"+l.source+")",y),b=void 0===r?4294967295:r>>>0;if(0===b)return[];if(0===f.length)return null===h(m,f)?[f]:[];for(var w=0,k=0,x=[];k<f.length;){m.lastIndex=v?k:0;var E,S=h(m,v?f:f.slice(k));if(null===S||(E=p(c(m.lastIndex+(v?0:k)),f.length))===w)k=u(f,k,g);else{if(x.push(f.slice(w,k)),x.length===b)return x;for(var O=1;O<=S.length-1;O++)if(x.push(S[O]),x.length===b)return x;k=w=E}}return x.push(f.slice(w)),x}]}),!v)},function(t,e,n){"use strict";var i=n(3),r=n(63).map,o=n(56),s=n(35),a=o("map"),u=s("map");i({target:"Array",proto:!0,forced:!a||!u},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(18),r=n(21).f,o=Function.prototype,s=o.toString,a=/^\s*function ([^ (]*)/;i&&!("name"in o)&&r(o,"name",{configurable:!0,get:function(){try{return s.call(this).match(a)[1]}catch(t){return""}}})},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(21).f,r=n(13),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,n){var i=n(18),r=n(89),o=n(46),s=n(32),a=n(71),u=n(13),c=n(117),h=Object.getOwnPropertyDescriptor;e.f=i?h:function(t,e){if(t=s(t),e=a(e,!0),c)try{return h(t,e)}catch(t){}if(u(t,e))return o(!r.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports=!1},function(t,e,n){"use strict";n(19);var i,r=n(3),o=n(18),s=n(143),a=n(6),u=n(124),c=n(28),h=n(80),l=n(13),f=n(144),d=n(192),p=n(107).codeAt,v=n(193),g=n(43),y=n(194),m=n(34),b=a.URL,w=y.URLSearchParams,k=y.getState,x=m.set,E=m.getterFor("URL"),S=Math.floor,O=Math.pow,_=/[A-Za-z]/,C=/[\d+-.A-Za-z]/,T=/\d/,R=/^(0x|0X)/,j=/^[0-7]+$/,I=/^\d+$/,L=/^[\dA-Fa-f]+$/,A=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,N=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,P=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,D=/[\u0009\u000A\u000D]/g,z=function(t,e){var n,i,r;if("["==e.charAt(0)){if("]"!=e.charAt(e.length-1))return"Invalid host";if(!(n=M(e.slice(1,-1))))return"Invalid host";t.host=n}else if(G(t)){if(e=v(e),A.test(e))return"Invalid host";if(null===(n=B(e)))return"Invalid host";t.host=n}else{if(N.test(e))return"Invalid host";for(n="",i=d(e),r=0;r<i.length;r++)n+=V(i[r],U);t.host=n}},B=function(t){var e,n,i,r,o,s,a,u=t.split(".");if(u.length&&""==u[u.length-1]&&u.pop(),(e=u.length)>4)return t;for(n=[],i=0;i<e;i++){if(""==(r=u[i]))return t;if(o=10,r.length>1&&"0"==r.charAt(0)&&(o=R.test(r)?16:8,r=r.slice(8==o?1:2)),""===r)s=0;else{if(!(10==o?I:8==o?j:L).test(r))return t;s=parseInt(r,o)}n.push(s)}for(i=0;i<e;i++)if(s=n[i],i==e-1){if(s>=O(256,5-e))return null}else if(s>255)return null;for(a=n.pop(),i=0;i<n.length;i++)a+=n[i]*O(256,3-i);return a},M=function(t){var e,n,i,r,o,s,a,u=[0,0,0,0,0,0,0,0],c=0,h=null,l=0,f=function(){return t.charAt(l)};if(":"==f()){if(":"!=t.charAt(1))return;l+=2,h=++c}for(;f();){if(8==c)return;if(":"!=f()){for(e=n=0;n<4&&L.test(f());)e=16*e+parseInt(f(),16),l++,n++;if("."==f()){if(0==n)return;if(l-=n,c>6)return;for(i=0;f();){if(r=null,i>0){if(!("."==f()&&i<4))return;l++}if(!T.test(f()))return;for(;T.test(f());){if(o=parseInt(f(),10),null===r)r=o;else{if(0==r)return;r=10*r+o}if(r>255)return;l++}u[c]=256*u[c]+r,2!=++i&&4!=i||c++}if(4!=i)return;break}if(":"==f()){if(l++,!f())return}else if(f())return;u[c++]=e}else{if(null!==h)return;l++,h=++c}}if(null!==h)for(s=c-h,c=7;0!=c&&s>0;)a=u[c],u[c--]=u[h+s-1],u[h+--s]=a;else if(8!=c)return;return u},q=function(t){var e,n,i,r;if("number"==typeof t){for(e=[],n=0;n<4;n++)e.unshift(t%256),t=S(t/256);return e.join(".")}if("object"==typeof t){for(e="",i=function(t){for(var e=null,n=1,i=null,r=0,o=0;o<8;o++)0!==t[o]?(r>n&&(e=i,n=r),i=null,r=0):(null===i&&(i=o),++r);return r>n&&(e=i,n=r),e}(t),n=0;n<8;n++)r&&0===t[n]||(r&&(r=!1),i===n?(e+=n?":":"::",r=!0):(e+=t[n].toString(16),n<7&&(e+=":")));return"["+e+"]"}return t},U={},F=f({},U,{" ":1,'"':1,"<":1,">":1,"`":1}),W=f({},F,{"#":1,"?":1,"{":1,"}":1}),H=f({},W,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),V=function(t,e){var n=p(t,0);return n>32&&n<127&&!l(e,t)?t:encodeURIComponent(t)},X={ftp:21,file:null,http:80,https:443,ws:80,wss:443},G=function(t){return l(X,t.scheme)},Y=function(t){return""!=t.username||""!=t.password},K=function(t){return!t.host||t.cannotBeABaseURL||"file"==t.scheme},$=function(t,e){var n;return 2==t.length&&_.test(t.charAt(0))&&(":"==(n=t.charAt(1))||!e&&"|"==n)},Z=function(t){var e;return t.length>1&&$(t.slice(0,2))&&(2==t.length||"/"===(e=t.charAt(2))||"\\"===e||"?"===e||"#"===e)},J=function(t){var e=t.path,n=e.length;!n||"file"==t.scheme&&1==n&&$(e[0],!0)||e.pop()},Q=function(t){return"."===t||"%2e"===t.toLowerCase()},tt={},et={},nt={},it={},rt={},ot={},st={},at={},ut={},ct={},ht={},lt={},ft={},dt={},pt={},vt={},gt={},yt={},mt={},bt={},wt={},kt=function(t,e,n,r){var o,s,a,u,c,h=n||tt,f=0,p="",v=!1,g=!1,y=!1;for(n||(t.scheme="",t.username="",t.password="",t.host=null,t.port=null,t.path=[],t.query=null,t.fragment=null,t.cannotBeABaseURL=!1,e=e.replace(P,"")),e=e.replace(D,""),o=d(e);f<=o.length;){switch(s=o[f],h){case tt:if(!s||!_.test(s)){if(n)return"Invalid scheme";h=nt;continue}p+=s.toLowerCase(),h=et;break;case et:if(s&&(C.test(s)||"+"==s||"-"==s||"."==s))p+=s.toLowerCase();else{if(":"!=s){if(n)return"Invalid scheme";p="",h=nt,f=0;continue}if(n&&(G(t)!=l(X,p)||"file"==p&&(Y(t)||null!==t.port)||"file"==t.scheme&&!t.host))return;if(t.scheme=p,n)return void(G(t)&&X[t.scheme]==t.port&&(t.port=null));p="","file"==t.scheme?h=dt:G(t)&&r&&r.scheme==t.scheme?h=it:G(t)?h=at:"/"==o[f+1]?(h=rt,f++):(t.cannotBeABaseURL=!0,t.path.push(""),h=mt)}break;case nt:if(!r||r.cannotBeABaseURL&&"#"!=s)return"Invalid scheme";if(r.cannotBeABaseURL&&"#"==s){t.scheme=r.scheme,t.path=r.path.slice(),t.query=r.query,t.fragment="",t.cannotBeABaseURL=!0,h=wt;break}h="file"==r.scheme?dt:ot;continue;case it:if("/"!=s||"/"!=o[f+1]){h=ot;continue}h=ut,f++;break;case rt:if("/"==s){h=ct;break}h=yt;continue;case ot:if(t.scheme=r.scheme,s==i)t.username=r.username,t.password=r.password,t.host=r.host,t.port=r.port,t.path=r.path.slice(),t.query=r.query;else if("/"==s||"\\"==s&&G(t))h=st;else if("?"==s)t.username=r.username,t.password=r.password,t.host=r.host,t.port=r.port,t.path=r.path.slice(),t.query="",h=bt;else{if("#"!=s){t.username=r.username,t.password=r.password,t.host=r.host,t.port=r.port,t.path=r.path.slice(),t.path.pop(),h=yt;continue}t.username=r.username,t.password=r.password,t.host=r.host,t.port=r.port,t.path=r.path.slice(),t.query=r.query,t.fragment="",h=wt}break;case st:if(!G(t)||"/"!=s&&"\\"!=s){if("/"!=s){t.username=r.username,t.password=r.password,t.host=r.host,t.port=r.port,h=yt;continue}h=ct}else h=ut;break;case at:if(h=ut,"/"!=s||"/"!=p.charAt(f+1))continue;f++;break;case ut:if("/"!=s&&"\\"!=s){h=ct;continue}break;case ct:if("@"==s){v&&(p="%40"+p),v=!0,a=d(p);for(var m=0;m<a.length;m++){var b=a[m];if(":"!=b||y){var w=V(b,H);y?t.password+=w:t.username+=w}else y=!0}p=""}else if(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&G(t)){if(v&&""==p)return"Invalid authority";f-=d(p).length+1,p="",h=ht}else p+=s;break;case ht:case lt:if(n&&"file"==t.scheme){h=vt;continue}if(":"!=s||g){if(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&G(t)){if(G(t)&&""==p)return"Invalid host";if(n&&""==p&&(Y(t)||null!==t.port))return;if(u=z(t,p))return u;if(p="",h=gt,n)return;continue}"["==s?g=!0:"]"==s&&(g=!1),p+=s}else{if(""==p)return"Invalid host";if(u=z(t,p))return u;if(p="",h=ft,n==lt)return}break;case ft:if(!T.test(s)){if(s==i||"/"==s||"?"==s||"#"==s||"\\"==s&&G(t)||n){if(""!=p){var k=parseInt(p,10);if(k>65535)return"Invalid port";t.port=G(t)&&k===X[t.scheme]?null:k,p=""}if(n)return;h=gt;continue}return"Invalid port"}p+=s;break;case dt:if(t.scheme="file","/"==s||"\\"==s)h=pt;else{if(!r||"file"!=r.scheme){h=yt;continue}if(s==i)t.host=r.host,t.path=r.path.slice(),t.query=r.query;else if("?"==s)t.host=r.host,t.path=r.path.slice(),t.query="",h=bt;else{if("#"!=s){Z(o.slice(f).join(""))||(t.host=r.host,t.path=r.path.slice(),J(t)),h=yt;continue}t.host=r.host,t.path=r.path.slice(),t.query=r.query,t.fragment="",h=wt}}break;case pt:if("/"==s||"\\"==s){h=vt;break}r&&"file"==r.scheme&&!Z(o.slice(f).join(""))&&($(r.path[0],!0)?t.path.push(r.path[0]):t.host=r.host),h=yt;continue;case vt:if(s==i||"/"==s||"\\"==s||"?"==s||"#"==s){if(!n&&$(p))h=yt;else if(""==p){if(t.host="",n)return;h=gt}else{if(u=z(t,p))return u;if("localhost"==t.host&&(t.host=""),n)return;p="",h=gt}continue}p+=s;break;case gt:if(G(t)){if(h=yt,"/"!=s&&"\\"!=s)continue}else if(n||"?"!=s)if(n||"#"!=s){if(s!=i&&(h=yt,"/"!=s))continue}else t.fragment="",h=wt;else t.query="",h=bt;break;case yt:if(s==i||"/"==s||"\\"==s&&G(t)||!n&&("?"==s||"#"==s)){if(".."===(c=(c=p).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(J(t),"/"==s||"\\"==s&&G(t)||t.path.push("")):Q(p)?"/"==s||"\\"==s&&G(t)||t.path.push(""):("file"==t.scheme&&!t.path.length&&$(p)&&(t.host&&(t.host=""),p=p.charAt(0)+":"),t.path.push(p)),p="","file"==t.scheme&&(s==i||"?"==s||"#"==s))for(;t.path.length>1&&""===t.path[0];)t.path.shift();"?"==s?(t.query="",h=bt):"#"==s&&(t.fragment="",h=wt)}else p+=V(s,W);break;case mt:"?"==s?(t.query="",h=bt):"#"==s?(t.fragment="",h=wt):s!=i&&(t.path[0]+=V(s,U));break;case bt:n||"#"!=s?s!=i&&("'"==s&&G(t)?t.query+="%27":t.query+="#"==s?"%23":V(s,U)):(t.fragment="",h=wt);break;case wt:s!=i&&(t.fragment+=V(s,F))}f++}},xt=function(t){var e,n,i=h(this,xt,"URL"),r=arguments.length>1?arguments[1]:void 0,s=String(t),a=x(i,{type:"URL"});if(void 0!==r)if(r instanceof xt)e=E(r);else if(n=kt(e={},String(r)))throw TypeError(n);if(n=kt(a,s,null,e))throw TypeError(n);var u=a.searchParams=new w,c=k(u);c.updateSearchParams(a.query),c.updateURL=function(){a.query=String(u)||null},o||(i.href=St.call(i),i.origin=Ot.call(i),i.protocol=_t.call(i),i.username=Ct.call(i),i.password=Tt.call(i),i.host=Rt.call(i),i.hostname=jt.call(i),i.port=It.call(i),i.pathname=Lt.call(i),i.search=At.call(i),i.searchParams=Nt.call(i),i.hash=Pt.call(i))},Et=xt.prototype,St=function(){var t=E(this),e=t.scheme,n=t.username,i=t.password,r=t.host,o=t.port,s=t.path,a=t.query,u=t.fragment,c=e+":";return null!==r?(c+="//",Y(t)&&(c+=n+(i?":"+i:"")+"@"),c+=q(r),null!==o&&(c+=":"+o)):"file"==e&&(c+="//"),c+=t.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==a&&(c+="?"+a),null!==u&&(c+="#"+u),c},Ot=function(){var t=E(this),e=t.scheme,n=t.port;if("blob"==e)try{return new URL(e.path[0]).origin}catch(t){return"null"}return"file"!=e&&G(t)?e+"://"+q(t.host)+(null!==n?":"+n:""):"null"},_t=function(){return E(this).scheme+":"},Ct=function(){return E(this).username},Tt=function(){return E(this).password},Rt=function(){var t=E(this),e=t.host,n=t.port;return null===e?"":null===n?q(e):q(e)+":"+n},jt=function(){var t=E(this).host;return null===t?"":q(t)},It=function(){var t=E(this).port;return null===t?"":String(t)},Lt=function(){var t=E(this),e=t.path;return t.cannotBeABaseURL?e[0]:e.length?"/"+e.join("/"):""},At=function(){var t=E(this).query;return t?"?"+t:""},Nt=function(){return E(this).searchParams},Pt=function(){var t=E(this).fragment;return t?"#"+t:""},Dt=function(t,e){return{get:t,set:e,configurable:!0,enumerable:!0}};if(o&&u(Et,{href:Dt(St,(function(t){var e=E(this),n=String(t),i=kt(e,n);if(i)throw TypeError(i);k(e.searchParams).updateSearchParams(e.query)})),origin:Dt(Ot),protocol:Dt(_t,(function(t){var e=E(this);kt(e,String(t)+":",tt)})),username:Dt(Ct,(function(t){var e=E(this),n=d(String(t));if(!K(e)){e.username="";for(var i=0;i<n.length;i++)e.username+=V(n[i],H)}})),password:Dt(Tt,(function(t){var e=E(this),n=d(String(t));if(!K(e)){e.password="";for(var i=0;i<n.length;i++)e.password+=V(n[i],H)}})),host:Dt(Rt,(function(t){var e=E(this);e.cannotBeABaseURL||kt(e,String(t),ht)})),hostname:Dt(jt,(function(t){var e=E(this);e.cannotBeABaseURL||kt(e,String(t),lt)})),port:Dt(It,(function(t){var e=E(this);K(e)||(""==(t=String(t))?e.port=null:kt(e,t,ft))})),pathname:Dt(Lt,(function(t){var e=E(this);e.cannotBeABaseURL||(e.path=[],kt(e,t+"",gt))})),search:Dt(At,(function(t){var e=E(this);""==(t=String(t))?e.query=null:("?"==t.charAt(0)&&(t=t.slice(1)),e.query="",kt(e,t,bt)),k(e.searchParams).updateSearchParams(e.query)})),searchParams:Dt(Nt),hash:Dt(Pt,(function(t){var e=E(this);""!=(t=String(t))?("#"==t.charAt(0)&&(t=t.slice(1)),e.fragment="",kt(e,t,wt)):e.fragment=null}))}),c(Et,"toJSON",(function(){return St.call(this)}),{enumerable:!0}),c(Et,"toString",(function(){return St.call(this)}),{enumerable:!0}),b){var zt=b.createObjectURL,Bt=b.revokeObjectURL;zt&&c(xt,"createObjectURL",(function(t){return zt.apply(b,arguments)})),Bt&&c(xt,"revokeObjectURL",(function(t){return Bt.apply(b,arguments)}))}g(xt,"URL"),r({global:!0,forced:!s,sham:!o},{URL:xt})},function(t,e,n){"use strict";n(10),n(29);var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e){r(this,t),this._q=[],this.context=e,this.tick=i.requestAnimationFrame,this.running=!1,this.paused=!1}var e,n,s;return e=t,(n=[{key:"enqueue",value:function(){var t,e,n=[].shift.call(arguments),r=arguments;if(!n)throw new Error("No Task Provided");return e="function"==typeof n?{task:n,args:r,deferred:t=new i.defer,promise:t.promise}:{promise:n},this._q.push(e),0!=this.paused||this.running||this.run(),e.promise}},{key:"dequeue",value:function(){var t,e,n;return!this._q.length||this.paused?((t=new i.defer).deferred.resolve(),t.promise):(e=(t=this._q.shift()).task)?(n=e.apply(this.context,t.args))&&"function"==typeof n.then?n.then(function(){t.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){t.deferred.reject.apply(this.context,arguments)}.bind(this)):(t.deferred.resolve.apply(this.context,n),t.promise):t.promise?t.promise:void 0}},{key:"dump",value:function(){for(;this._q.length;)this.dequeue()}},{key:"run",value:function(){var t=this;return this.running||(this.running=!0,this.defered=new i.defer),this.tick.call(window,(function(){t._q.length?t.dequeue().then(function(){this.run()}.bind(t)):(t.defered.resolve(),t.running=void 0)})),1==this.paused&&(this.paused=!1),this.defered.promise}},{key:"flush",value:function(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}},{key:"clear",value:function(){this._q=[]}},{key:"length",value:function(){return this._q.length}},{key:"pause",value:function(){this.paused=!0}},{key:"stop",value:function(){this._q=[],this.running=!1,this.paused=!0}}])&&o(e.prototype,n),s&&o(e,s),t}();e.a=s},function(t,e,n){"use strict";n(64),n(65),n(66),n(149),n(7),n(151),n(15),n(40),n(41),n(10),n(152),n(19),n(11),n(23);var i=n(12),r=n.n(i),o=n(0);function s(){var t="reverse",e=function(){var t=document.createElement("div");t.dir="rtl",t.style.position="fixed",t.style.width="1px",t.style.height="1px",t.style.top="0px",t.style.left="0px",t.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var n=document.createElement("span");n.style.width="1px",n.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(n),e.appendChild(i),t.appendChild(e),t}();return document.body.appendChild(e),e.scrollLeft>0?t="default":"undefined"!=typeof Element&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(t="negative")):(e.scrollLeft=1,0===e.scrollLeft&&(t="negative")),document.body.removeChild(e),t}var a=n(51),u=n(49),c=n(155),h=n.n(c);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e||{},this.id="epubjs-container-"+Object(o.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}var e,n,i;return e=t,(n=[{key:"create",value:function(t){var e=t.height,n=t.width,i=t.overflow||!1,r=t.axis||"vertical",s=t.direction;Object(o.extend)(this.settings,t),t.height&&Object(o.isNumber)(t.height)&&(e=t.height+"px"),t.width&&Object(o.isNumber)(t.width)&&(n=t.width+"px");var a=document.createElement("div");return a.id=this.id,a.classList.add("epub-container"),a.style.wordSpacing="0",a.style.lineHeight="0",a.style.verticalAlign="top",a.style.position="relative","horizontal"===r&&(a.style.display="flex",a.style.flexDirection="row",a.style.flexWrap="nowrap"),n&&(a.style.width=n),e&&(a.style.height=e),i&&("scroll"===i&&"vertical"===r?(a.style["overflow-y"]=i,a.style["overflow-x"]="hidden"):"scroll"===i&&"horizontal"===r?(a.style["overflow-y"]="hidden",a.style["overflow-x"]=i):a.style.overflow=i),s&&(a.dir=s,a.style.direction=s),s&&this.settings.fullsize&&(document.body.style.direction=s),a}},{key:"wrap",value:function(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e}},{key:"getElement",value:function(t){var e;if(Object(o.isElement)(t)?e=t:"string"==typeof t&&(e=document.getElementById(t)),!e)throw new Error("Not an Element");return e}},{key:"attachTo",value:function(t){var e,n=this.getElement(t);if(n)return e=this.settings.hidden?this.wrapper:this.container,n.appendChild(e),this.element=n,n}},{key:"getContainer",value:function(){return this.container}},{key:"onResize",value:function(t){Object(o.isNumber)(this.settings.width)&&Object(o.isNumber)(this.settings.height)||(this.resizeFunc=h()(t,50),window.addEventListener("resize",this.resizeFunc,!1))}},{key:"onOrientationChange",value:function(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}},{key:"size",value:function(t,e){var n,i=t||this.settings.width,r=e||this.settings.height;null===t?(n=this.element.getBoundingClientRect()).width&&(t=Math.floor(n.width),this.container.style.width=t+"px"):Object(o.isNumber)(t)?this.container.style.width=t+"px":this.container.style.width=t,null===e?(n=n||this.element.getBoundingClientRect()).height&&(e=n.height,this.container.style.height=e+"px"):Object(o.isNumber)(e)?this.container.style.height=e+"px":this.container.style.height=e,Object(o.isNumber)(t)||(t=this.container.clientWidth),Object(o.isNumber)(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};var s=Object(o.windowBounds)(),a=window.getComputedStyle(document.body),u=parseFloat(a["padding-left"])||0,c=parseFloat(a["padding-right"])||0,h=parseFloat(a["padding-top"])||0,l=parseFloat(a["padding-bottom"])||0;return i||(t=s.width-u-c),(this.settings.fullsize&&!r||!r)&&(e=s.height-h-l),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}}},{key:"bounds",value:function(){var t;return"visible"!==this.container.style.overflow&&(t=this.container&&this.container.getBoundingClientRect()),t&&t.width&&t.height?t:Object(o.windowBounds)()}},{key:"getSheet",value:function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}},{key:"addStyleRules",value:function(t,e){var n="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),e.forEach((function(t){for(var e in t)t.hasOwnProperty(e)&&(i+=e+":"+t[e]+";")})),this.sheet.insertRule(n+t+" {"+i+"}",0)}},{key:"axis",value:function(t){"horizontal"===t?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}},{key:"direction",value:function(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}},{key:"overflow",value:function(t){this.container&&("scroll"===t&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):"scroll"===t&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}},{key:"destroy",value:function(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}])&&l(e.prototype,n),i&&l(e,i),t}();n(14),n(36),n(85);function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this._views=[],this.length=0,this.hidden=!1}var e,n,i;return e=t,(n=[{key:"all",value:function(){return this._views}},{key:"first",value:function(){return this._views[0]}},{key:"last",value:function(){return this._views[this._views.length-1]}},{key:"indexOf",value:function(t){return this._views.indexOf(t)}},{key:"slice",value:function(){return this._views.slice.apply(this._views,arguments)}},{key:"get",value:function(t){return this._views[t]}},{key:"append",value:function(t){return this._views.push(t),this.container&&this.container.appendChild(t.element),this.length++,t}},{key:"prepend",value:function(t){return this._views.unshift(t),this.container&&this.container.insertBefore(t.element,this.container.firstChild),this.length++,t}},{key:"insert",value:function(t,e){return this._views.splice(e,0,t),this.container&&(e<this.container.children.length?this.container.insertBefore(t.element,this.container.children[e]):this.container.appendChild(t.element)),this.length++,t}},{key:"remove",value:function(t){var e=this._views.indexOf(t);e>-1&&this._views.splice(e,1),this.destroy(t),this.length--}},{key:"destroy",value:function(t){t.displayed&&t.destroy(),this.container&&this.container.removeChild(t.element),t=null}},{key:"forEach",value:function(){return this._views.forEach.apply(this._views,arguments)}},{key:"clear",value:function(){var t,e=this.length;if(this.length){for(var n=0;n<e;n++)t=this._views[n],this.destroy(t);this._views=[],this.length=0}}},{key:"find",value:function(t){for(var e,n=this.length,i=0;i<n;i++)if((e=this._views[i]).displayed&&e.section.index==t.index)return e}},{key:"displayed",value:function(){for(var t,e=[],n=this.length,i=0;i<n;i++)(t=this._views[i]).displayed&&e.push(t);return e}},{key:"show",value:function(){for(var t,e=this.length,n=0;n<e;n++)(t=this._views[n]).displayed&&t.show();this.hidden=!1}},{key:"hide",value:function(){for(var t,e=this.length,n=0;n<e;n++)(t=this._views[n]).displayed&&t.hide();this.hidden=!0}}])&&d(e.prototype,n),i&&d(e,i),t}(),v=n(1);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new u.a(this),this.settings=Object(o.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0}),Object(o.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0},this.rendered=!1}var e,n,i;return e=t,(n=[{key:"render",value:function(t,e){var n=t.tagName;void 0!==this.settings.fullsize||!n||"body"!=n.toLowerCase()&&"html"!=n.toLowerCase()||(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=e,this.settings.rtlScrollType=s(),this.stage=new f({width:e.width,height:e.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(t),this.container=this.stage.getContainer(),this.views=new p(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}},{key:"addEventListeners",value:function(){var t;window.addEventListener("unload",function(t){this.destroy()}.bind(this)),t=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll)}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"destroy",value:function(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}},{key:"onOrientationChange",value:function(t){var e=window.orientation;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(v.c.MANAGERS.ORIENTATION_CHANGE,e)}.bind(this),500)}},{key:"onResized",value:function(t){this.resize()}},{key:"resize",value:function(t,e,n){var i=this.stage.size(t,e);this.winBounds=Object(o.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height?this._stageSize=void 0:this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(v.c.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},n))}},{key:"createView",value:function(t,e){return new this.View(t,Object(o.extend)(this.viewSettings,{forceRight:e}))}},{key:"handleNextPrePaginated",value:function(t,e,n){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1){if(t||0===e.index)return;if((i=e.next())&&!i.properties.includes("page-spread-left"))return n.call(this,i)}}},{key:"display",value:function(t,e){var n=new o.defer,i=n.promise;(e===t.href||Object(o.isNumber)(e))&&(e=void 0);var r=this.views.find(t);if(r&&t&&"pre-paginated"!==this.layout.name){var s=r.offset();if("ltr"===this.settings.direction)this.scrollTo(s.left,s.top,!0);else{var a=r.width();this.scrollTo(s.left+a,s.top,!0)}if(e){var u=r.locationOf(e);this.moveTo(u)}return n.resolve(),i}this.clear();var c=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(c=!0),this.add(t,c).then(function(t){if(e){var n=t.locationOf(e);this.moveTo(n)}}.bind(this),(function(t){n.reject(t)})).then(function(){return this.handleNextPrePaginated(c,t,this.add)}.bind(this)).then(function(){this.views.show(),n.resolve()}.bind(this)),i}},{key:"afterDisplayed",value:function(t){this.emit(v.c.MANAGERS.ADDED,t)}},{key:"afterResized",value:function(t){this.emit(v.c.MANAGERS.RESIZE,t.section)}},{key:"moveTo",value:function(t){var e=0,n=0;this.isPaginated?(e=Math.floor(t.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(e=this.container.scrollWidth-this.layout.delta):n=t.top,this.scrollTo(e,n,!0)}},{key:"add",value:function(t,e){var n=this,i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(v.c.VIEWS.AXIS,(function(t){n.updateAxis(t)})),i.on(v.c.VIEWS.WRITING_MODE,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"append",value:function(t,e){var n=this,i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(v.c.VIEWS.AXIS,(function(t){n.updateAxis(t)})),i.on(v.c.VIEWS.WRITING_MODE,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"prepend",value:function(t,e){var n=this,i=this.createView(t,e);return i.on(v.c.VIEWS.RESIZED,(function(t){n.counter(t)})),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(v.c.VIEWS.AXIS,(function(t){n.updateAxis(t)})),i.on(v.c.VIEWS.WRITING_MODE,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"counter",value:function(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}},{key:"next",value:function(){var t,e=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||e&&"ltr"!==e?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===e?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next():this.container.scrollLeft+-1*this.layout.delta>-1*this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()),t)){this.clear();var n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(n=!0),this.append(t,n).then(function(){return this.handleNextPrePaginated(n,t,this.append)}.bind(this),(function(t){return t})).then(function(){this.isPaginated||"horizontal"!==this.settings.axis||"rtl"!==this.settings.direction||"default"!==this.settings.rtlScrollType||this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}},{key:"prev",value:function(){var t,e=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||e&&"ltr"!==e?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===e?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft+this.container.offsetWidth<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev():this.container.scrollLeft<0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()),t)){this.clear();var n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&"object"!==g(t.prev())&&(n=!0),this.prepend(t,n).then(function(){var e;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(e=t.prev()))return this.prepend(e)}.bind(this),(function(t){return t})).then(function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?"default"===this.settings.rtlScrollType?this.scrollTo(0,0,!0):this.scrollTo(-1*this.container.scrollWidth+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}},{key:"current",value:function(){var t=this.visible();return t.length?t[t.length-1]:null}},{key:"clear",value:function(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}},{key:"currentLocation",value:function(){return this.isPaginated&&"horizontal"===this.settings.axis?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}},{key:"scrolledLocation",value:function(){var t=this,e=this.visible(),n=this.container.getBoundingClientRect(),i=n.height<window.innerHeight?n.height:window.innerHeight,r=n.width<window.innerWidth?n.width:window.innerWidth,o="vertical"===this.settings.axis,s=(this.settings.direction,0);return this.settings.fullsize&&(s=o?window.scrollY:window.scrollX),e.map((function(e){var a,u,c,h,l=e.section,f=l.index,d=l.href,p=e.position(),v=e.width(),g=e.height();o?(u=(a=s+n.top-p.top+0)+i-0,h=t.layout.count(g,i).pages,c=i):(u=(a=s+n.left-p.left+0)+r-0,h=t.layout.count(v,r).pages,c=r);var y=Math.ceil(a/c),m=[],b=Math.ceil(u/c);if("rtl"===t.settings.direction&&!o){var w=y;y=h-b,b=h-w}m=[];for(var k=y;k<=b;k++){var x=k+1;m.push(x)}return{index:f,href:d,pages:m,totalPages:h,mapping:t.mapping.page(e.contents,e.section.cfiBase,a,u)}}))}},{key:"paginatedLocation",value:function(){var t=this,e=this.visible(),n=this.container.getBoundingClientRect(),i=0,r=0;return this.settings.fullsize&&(i=window.scrollX),e.map((function(e){var o,s,a,u,c=e.section,h=c.index,l=c.href,f=e.position(),d=e.width();"rtl"===t.settings.direction?(o=n.right-i,u=Math.min(Math.abs(o-f.left),t.layout.width)-r,s=(a=f.width-(f.right-o)-r)-u):(o=n.left+i,u=Math.min(f.right-o,t.layout.width)-r,a=(s=o-f.left+r)+u),r+=u;var p=t.mapping.page(e.contents,e.section.cfiBase,s,a),v=t.layout.count(d).pages,g=Math.floor(s/t.layout.pageWidth),y=[],m=Math.floor(a/t.layout.pageWidth);if(g<0&&(g=0,m+=1),"rtl"===t.settings.direction){var b=g;g=v-m,m=v-b}for(var w=g+1;w<=m;w++){var k=w;y.push(k)}return{index:h,href:l,pages:y,totalPages:v,mapping:p}}))}},{key:"isVisible",value:function(t,e,n,i){var r=t.position(),o=i||this.bounds();return"horizontal"===this.settings.axis&&r.right>o.left-e&&r.left<o.right+n||"vertical"===this.settings.axis&&r.bottom>o.top-e&&r.top<o.bottom+n}},{key:"visible",value:function(){for(var t,e=this.bounds(),n=this.views.displayed(),i=n.length,r=[],o=0;o<i;o++)t=n[o],!0===this.isVisible(t,0,0,e)&&r.push(t);return r}},{key:"scrollBy",value:function(t,e,n){var i="rtl"===this.settings.direction?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*i,e*i):(t&&(this.container.scrollLeft+=t*i),e&&(this.container.scrollTop+=e)),this.scrolled=!0}},{key:"scrollTo",value:function(t,e,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,e):(this.container.scrollLeft=t,this.container.scrollTop=e),this.scrolled=!0}},{key:"onScroll",value:function(){var t,e;this.settings.fullsize?(t=window.scrollY,e=window.scrollX):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:(this.emit(v.c.MANAGERS.SCROLL,{top:t,left:e}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(v.c.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}},{key:"bounds",value:function(){var t;return t=this.stage.bounds(),t}},{key:"applyLayout",value:function(t){this.layout=t,this.updateLayout(),this.views&&this.views.length>0&&"pre-paginated"===this.layout.name&&this.display(this.views.first().section)}},{key:"updateLayout",value:function(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}},{key:"setLayout",value:function(t){this.viewSettings.layout=t,this.mapping=new a.a(t.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach((function(e){e&&e.setLayout(t)}))}},{key:"updateWritingMode",value:function(t){this.writingMode=t}},{key:"updateAxis",value:function(t,e){(e||t!==this.settings.axis)&&(this.settings.axis=t,this.stage&&this.stage.axis(t),this.viewSettings.axis=t,this.mapping&&(this.mapping=new a.a(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===t?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}},{key:"updateFlow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n="paginated"===t||"auto"===t;this.isPaginated=n,"scrolled-doc"===t||"scrolled-continuous"===t||"scrolled"===t?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=t,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?"hidden":e,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}},{key:"getContents",value:function(){var t=[];return this.views?(this.views.forEach((function(e){var n=e&&e.contents;n&&t.push(n)})),t):t}},{key:"direction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ltr";this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout()}},{key:"isRendered",value:function(){return this.rendered}}])&&y(e.prototype,n),i&&y(e,i),t}();r()(m.prototype);e.a=m},function(t,e,n){"use strict";n(14),n(10),n(31),n(86);var i=n(2),r=n(0);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o(this,t),this.layout=e,this.horizontal="horizontal"===i,this.direction=n||"ltr",this._dev=r}var e,n,a;return e=t,(n=[{key:"section",value:function(t){var e=this.findRanges(t);return this.rangeListToCfiList(t.section.cfiBase,e)}},{key:"page",value:function(t,e,n,r){var o,s=!(!t||!t.document)&&t.document.body;if(s){if(o=this.rangePairToCfiPair(e,{start:this.findStart(s,n,r),end:this.findEnd(s,n,r)}),!0===this._dev){var a=t.document,u=new i.a(o.start).toRange(a),c=new i.a(o.end).toRange(a),h=a.defaultView.getSelection(),l=a.createRange();h.removeAllRanges(),l.setStart(u.startContainer,u.startOffset),l.setEnd(c.endContainer,c.endOffset),h.addRange(l)}return o}}},{key:"walk",value:function(t,e){if(!t||t.nodeType!==Node.TEXT_NODE){var n=function(t){return t.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},i=n;i.acceptNode=n;for(var r,o,s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,i,!1);(r=s.nextNode())&&!(o=e(r)););return o}}},{key:"findRanges",value:function(t){for(var e,n,i=[],r=t.contents.scrollWidth(),o=Math.ceil(r/this.layout.spreadWidth)*this.layout.divisor,s=this.layout.columnWidth,a=this.layout.gap,u=0;u<o.pages;u++)e=(s+a)*u,n=s*(u+1)+a*u,i.push({start:this.findStart(t.document.body,e,n),end:this.findEnd(t.document.body,e,n)});return i}},{key:"findStart",value:function(t,e,n){for(var i,o,s=this,a=[t],u=t;a.length;)if(i=a.shift(),o=this.walk(i,(function(t){var i,o,c,h,l;if(l=Object(r.nodeBounds)(t),s.horizontal&&"ltr"===s.direction){if(i=s.horizontal?l.left:l.top,o=s.horizontal?l.right:l.bottom,i>=e&&i<=n)return t;if(o>e)return t;u=t,a.push(t)}else if(s.horizontal&&"rtl"===s.direction){if(i=l.left,(o=l.right)<=n&&o>=e)return t;if(i<n)return t;u=t,a.push(t)}else{if(c=l.top,h=l.bottom,c>=e&&c<=n)return t;if(h>e)return t;u=t,a.push(t)}})))return this.findTextStartRange(o,e,n);return this.findTextStartRange(u,e,n)}},{key:"findEnd",value:function(t,e,n){for(var i,o,s=this,a=[t],u=t;a.length;)if(i=a.shift(),o=this.walk(i,(function(t){var i,o,c,h,l;if(l=Object(r.nodeBounds)(t),s.horizontal&&"ltr"===s.direction){if(i=Math.round(l.left),o=Math.round(l.right),i>n&&u)return u;if(o>n)return t;u=t,a.push(t)}else if(s.horizontal&&"rtl"===s.direction){if(i=Math.round(s.horizontal?l.left:l.top),(o=Math.round(s.horizontal?l.right:l.bottom))<e&&u)return u;if(i<e)return t;u=t,a.push(t)}else{if(c=Math.round(l.top),h=Math.round(l.bottom),c>n&&u)return u;if(h>n)return t;u=t,a.push(t)}})))return this.findTextEndRange(o,e,n);return this.findTextEndRange(u,e,n)}},{key:"findTextStartRange",value:function(t,e,n){for(var i,r,o=this.splitTextNodeIntoRanges(t),s=0;s<o.length;s++)if(r=(i=o[s]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(r.left>=e)return i}else if(this.horizontal&&"rtl"===this.direction){if(r.right<=n)return i}else if(r.top>=e)return i;return o[0]}},{key:"findTextEndRange",value:function(t,e,n){for(var i,r,o,s,a,u,c,h=this.splitTextNodeIntoRanges(t),l=0;l<h.length;l++){if(o=(r=h[l]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(s=o.left,a=o.right,s>n&&i)return i;if(a>n)return r}else if(this.horizontal&&"rtl"===this.direction){if(s=o.left,(a=o.right)<e&&i)return i;if(s<e)return r}else{if(u=o.top,c=o.bottom,u>n&&i)return i;if(c>n)return r}i=r}return h[h.length-1]}},{key:"splitTextNodeIntoRanges",value:function(t,e){var n,i=[],r=(t.textContent||"").trim(),o=t.ownerDocument,s=e||" ",a=r.indexOf(s);if(-1===a||t.nodeType!=Node.TEXT_NODE)return(n=o.createRange()).selectNodeContents(t),[n];for((n=o.createRange()).setStart(t,0),n.setEnd(t,a),i.push(n),n=!1;-1!=a;)(a=r.indexOf(s,a+1))>0&&(n&&(n.setEnd(t,a),i.push(n)),(n=o.createRange()).setStart(t,a+1));return n&&(n.setEnd(t,r.length),i.push(n)),i}},{key:"rangePairToCfiPair",value:function(t,e){var n=e.start,r=e.end;return n.collapse(!0),r.collapse(!1),{start:new i.a(n,t).toString(),end:new i.a(r,t).toString()}}},{key:"rangeListToCfiList",value:function(t,e){for(var n,i=[],r=0;r<e.length;r++)n=this.rangePairToCfiPair(t,e[r]),i.push(n);return i}},{key:"axis",value:function(t){return t&&(this.horizontal="horizontal"===t),this.horizontal}}])&&s(e.prototype,n),a&&s(e,a),t}();e.a=a},function(t,e,n){"use strict";var i=n(3),r=n(4),o=n(75),s=n(8),a=n(25),u=n(22),c=n(76),h=n(98),l=n(56),f=n(5),d=n(100),p=f("isConcatSpreadable"),v=d>=51||!r((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),g=l("concat"),y=function(t){if(!s(t))return!1;var e=t[p];return void 0!==e?!!e:o(t)};i({target:"Array",proto:!0,forced:!v||!g},{concat:function(t){var e,n,i,r,o,s=a(this),l=h(s,0),f=0;for(e=-1,i=arguments.length;e<i;e++)if(y(o=-1===e?s:arguments[e])){if(f+(r=u(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<r;n++,f++)n in o&&c(l,f,o[n])}else{if(f>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(l,f++,o)}return l.length=f,l}})},function(t,e,n){var i=n(4),r=n(37),o="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?o.call(t,""):Object(t)}:Object},function(t,e){t.exports={}},function(t,e,n){var i=n(121),r=n(95).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(4),r=n(5),o=n(100),s=r("species");t.exports=function(t){return o>=51||!i((function(){var e=[];return(e.constructor={})[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,n){var i,r=n(9),o=n(124),s=n(95),a=n(54),u=n(125),c=n(90),h=n(72),l=h("IE_PROTO"),f=function(){},d=function(t){return"<script>"+t+"<\/script>"},p=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;p=i?function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e}(i):((e=c("iframe")).style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var n=s.length;n--;)delete p.prototype[s[n]];return p()};a[l]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(f.prototype=r(t),n=new f,f.prototype=null,n[l]=t):n=p(),void 0===e?n:o(n,e)}},function(t,e){t.exports={}},function(t,e,n){var i=n(13),r=n(25),o=n(72),s=n(129),a=o("IE_PROTO"),u=Object.prototype;t.exports=s?Object.getPrototypeOf:function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){var i=n(44);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){"use strict";var i=n(83),r=n(9),o=n(25),s=n(22),a=n(42),u=n(33),c=n(108),h=n(84),l=Math.max,f=Math.min,d=Math.floor,p=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g;i("replace",2,(function(t,e,n,i){var g=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=i.REPLACE_KEEPS_$0,m=g?"$":"$0";return[function(n,i){var r=u(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,r,i):e.call(String(r),n,i)},function(t,i){if(!g&&y||"string"==typeof i&&-1===i.indexOf(m)){var o=n(e,t,this,i);if(o.done)return o.value}var u=r(t),d=String(this),p="function"==typeof i;p||(i=String(i));var v=u.global;if(v){var w=u.unicode;u.lastIndex=0}for(var k=[];;){var x=h(u,d);if(null===x)break;if(k.push(x),!v)break;""===String(x[0])&&(u.lastIndex=c(d,s(u.lastIndex),w))}for(var E,S="",O=0,_=0;_<k.length;_++){x=k[_];for(var C=String(x[0]),T=l(f(a(x.index),d.length),0),R=[],j=1;j<x.length;j++)R.push(void 0===(E=x[j])?E:String(E));var I=x.groups;if(p){var L=[C].concat(R,T,d);void 0!==I&&L.push(I);var A=String(i.apply(void 0,L))}else A=b(C,d,T,R,I,i);T>=O&&(S+=d.slice(O,T)+A,O=T+C.length)}return S+d.slice(O)}];function b(t,n,i,r,s,a){var u=i+t.length,c=r.length,h=v;return void 0!==s&&(s=o(s),h=p),e.call(a,h,(function(e,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,i);case"'":return n.slice(u);case"<":a=s[o.slice(1,-1)];break;default:var h=+o;if(0===h)return e;if(h>c){var l=d(h/10);return 0===l?e:l<=c?void 0===r[l-1]?o.charAt(1):r[l-1]+o.charAt(1):e}a=r[h-1]}return void 0===a?"":a}))}}))},function(t,e,n){"use strict";var i=n(3),r=n(63).filter,o=n(56),s=n(35),a=o("filter"),u=s("filter");i({target:"Array",proto:!0,forced:!a||!u},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(60),r=n(53),o=n(25),s=n(22),a=n(98),u=[].push,c=function(t){var e=1==t,n=2==t,c=3==t,h=4==t,l=6==t,f=5==t||l;return function(d,p,v,g){for(var y,m,b=o(d),w=r(b),k=i(p,v,3),x=s(w.length),E=0,S=g||a,O=e?S(d,x):n?S(d,0):void 0;x>E;E++)if((f||E in w)&&(m=k(y=w[E],E,b),t))if(e)O[E]=m;else if(m)switch(t){case 3:return!0;case 5:return y;case 6:return E;case 2:u.call(O,y)}else if(h)return!1;return l?-1:c||h?h:O}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(t,e,n){"use strict";var i=n(3),r=n(6),o=n(38),s=n(47),a=n(18),u=n(99),c=n(122),h=n(4),l=n(13),f=n(75),d=n(8),p=n(9),v=n(25),g=n(32),y=n(71),m=n(46),b=n(57),w=n(79),k=n(55),x=n(142),E=n(96),S=n(45),O=n(21),_=n(89),C=n(27),T=n(28),R=n(93),j=n(72),I=n(54),L=n(73),A=n(5),N=n(145),P=n(146),D=n(43),z=n(34),B=n(63).forEach,M=j("hidden"),q=A("toPrimitive"),U=z.set,F=z.getterFor("Symbol"),W=Object.prototype,H=r.Symbol,V=o("JSON","stringify"),X=S.f,G=O.f,Y=x.f,K=_.f,$=R("symbols"),Z=R("op-symbols"),J=R("string-to-symbol-registry"),Q=R("symbol-to-string-registry"),tt=R("wks"),et=r.QObject,nt=!et||!et.prototype||!et.prototype.findChild,it=a&&h((function(){return 7!=b(G({},"a",{get:function(){return G(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=X(W,e);i&&delete W[e],G(t,e,n),i&&t!==W&&G(W,e,i)}:G,rt=function(t,e){var n=$[t]=b(H.prototype);return U(n,{type:"Symbol",tag:t,description:e}),a||(n.description=e),n},ot=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof H},st=function(t,e,n){t===W&&st(Z,e,n),p(t);var i=y(e,!0);return p(n),l($,i)?(n.enumerable?(l(t,M)&&t[M][i]&&(t[M][i]=!1),n=b(n,{enumerable:m(0,!1)})):(l(t,M)||G(t,M,m(1,{})),t[M][i]=!0),it(t,i,n)):G(t,i,n)},at=function(t,e){p(t);var n=g(e),i=w(n).concat(lt(n));return B(i,(function(e){a&&!ut.call(n,e)||st(t,e,n[e])})),t},ut=function(t){var e=y(t,!0),n=K.call(this,e);return!(this===W&&l($,e)&&!l(Z,e))&&(!(n||!l(this,e)||!l($,e)||l(this,M)&&this[M][e])||n)},ct=function(t,e){var n=g(t),i=y(e,!0);if(n!==W||!l($,i)||l(Z,i)){var r=X(n,i);return!r||!l($,i)||l(n,M)&&n[M][i]||(r.enumerable=!0),r}},ht=function(t){var e=Y(g(t)),n=[];return B(e,(function(t){l($,t)||l(I,t)||n.push(t)})),n},lt=function(t){var e=t===W,n=Y(e?Z:g(t)),i=[];return B(n,(function(t){!l($,t)||e&&!l(W,t)||i.push($[t])})),i};(u||(T((H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=L(t),n=function(t){this===W&&n.call(Z,t),l(this,M)&&l(this[M],e)&&(this[M][e]=!1),it(this,e,m(1,t))};return a&&nt&&it(W,e,{configurable:!0,set:n}),rt(e,t)}).prototype,"toString",(function(){return F(this).tag})),T(H,"withoutSetter",(function(t){return rt(L(t),t)})),_.f=ut,O.f=st,S.f=ct,k.f=x.f=ht,E.f=lt,N.f=function(t){return rt(A(t),t)},a&&(G(H.prototype,"description",{configurable:!0,get:function(){return F(this).description}}),s||T(W,"propertyIsEnumerable",ut,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:H}),B(w(tt),(function(t){P(t)})),i({target:"Symbol",stat:!0,forced:!u},{for:function(t){var e=String(t);if(l(J,e))return J[e];var n=H(e);return J[e]=n,Q[n]=e,n},keyFor:function(t){if(!ot(t))throw TypeError(t+" is not a symbol");if(l(Q,t))return Q[t]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),i({target:"Object",stat:!0,forced:!u,sham:!a},{create:function(t,e){return void 0===e?b(t):at(b(t),e)},defineProperty:st,defineProperties:at,getOwnPropertyDescriptor:ct}),i({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:ht,getOwnPropertySymbols:lt}),i({target:"Object",stat:!0,forced:h((function(){E.f(1)}))},{getOwnPropertySymbols:function(t){return E.f(v(t))}}),V)&&i({target:"JSON",stat:!0,forced:!u||h((function(){var t=H();return"[null]"!=V([t])||"{}"!=V({a:t})||"{}"!=V(Object(t))}))},{stringify:function(t,e,n){for(var i,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);if(i=e,(d(e)||void 0!==t)&&!ot(t))return f(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!ot(e))return e}),r[1]=e,V.apply(null,r)}});H.prototype[q]||C(H.prototype,q,H.prototype.valueOf),D(H,"Symbol"),I[M]=!0},function(t,e,n){"use strict";var i=n(3),r=n(18),o=n(6),s=n(13),a=n(8),u=n(21).f,c=n(119),h=o.Symbol;if(r&&"function"==typeof h&&(!("description"in h.prototype)||void 0!==h().description)){var l={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new h(t):void 0===t?h():h(t);return""===t&&(l[e]=!0),e};c(f,h);var d=f.prototype=h.prototype;d.constructor=f;var p=d.toString,v="Symbol(test)"==String(h("test")),g=/^Symbol\((.*)\)[^)]+$/;u(d,"description",{configurable:!0,get:function(){var t=a(this)?this.valueOf():this,e=p.call(t);if(s(l,t))return"";var n=v?e.slice(7,-1):e.replace(g,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:f})}},function(t,e,n){n(146)("iterator")},function(t,e,n){var i=n(3),r=n(25),o=n(79);i({target:"Object",stat:!0,forced:n(4)((function(){o(1)}))},{keys:function(t){return o(r(t))}})},function(t,e,n){"use strict";n(52),n(7),n(151),n(14),n(147),n(40),n(67),n(10),n(29),n(16),n(31),n(152),n(148),n(11);var i=n(12),r=n.n(i),o=n(0),s=n(2),a=n(51),u=n(30),c=n(1);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l="undefined"!=typeof navigator,f=l&&/Chrome/.test(navigator.userAgent),d=l&&!f&&/AppleWebKit/.test(navigator.userAgent),p=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.epubcfi=new s.a,this.document=e,this.documentElement=this.document.documentElement,this.content=n||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=r||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",c.b),this.called=0,this.active=!0,this.listeners()}var e,n,i;return e=t,i=[{key:"listenedEvents",get:function(){return c.a}}],(n=[{key:"width",value:function(t){var e=this.content;return t&&Object(o.isNumber)(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}},{key:"height",value:function(t){var e=this.content;return t&&Object(o.isNumber)(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}},{key:"contentWidth",value:function(t){var e=this.content||this.document.body;return t&&Object(o.isNumber)(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}},{key:"contentHeight",value:function(t){var e=this.content||this.document.body;return t&&Object(o.isNumber)(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}},{key:"textWidth",value:function(){var t,e=this.document.createRange(),n=this.content||this.document.body,i=Object(o.borders)(n);return e.selectNodeContents(n),t=e.getBoundingClientRect().width,i&&i.width&&(t+=i.width),Math.round(t)}},{key:"textHeight",value:function(){var t,e=this.document.createRange(),n=this.content||this.document.body;return e.selectNodeContents(n),t=e.getBoundingClientRect().bottom,Math.round(t)}},{key:"scrollWidth",value:function(){return this.documentElement.scrollWidth}},{key:"scrollHeight",value:function(){return this.documentElement.scrollHeight}},{key:"overflow",value:function(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow}},{key:"overflowX",value:function(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX}},{key:"overflowY",value:function(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY}},{key:"css",value:function(t,e,n){var i=this.content||this.document.body;return e?i.style.setProperty(t,e,n?"important":""):i.style.removeProperty(t),this.window.getComputedStyle(i)[t]}},{key:"viewport",value:function(t){var e,n=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},r=[];if(n&&n.hasAttribute("content")){var s=n.getAttribute("content"),a=s.match(/width\s*=\s*([^,]*)/),u=s.match(/height\s*=\s*([^,]*)/),c=s.match(/initial-scale\s*=\s*([^,]*)/),h=s.match(/minimum-scale\s*=\s*([^,]*)/),l=s.match(/maximum-scale\s*=\s*([^,]*)/),f=s.match(/user-scalable\s*=\s*([^,]*)/);a&&a.length&&void 0!==a[1]&&(i.width=a[1]),u&&u.length&&void 0!==u[1]&&(i.height=u[1]),c&&c.length&&void 0!==c[1]&&(i.scale=c[1]),h&&h.length&&void 0!==h[1]&&(i.minimum=h[1]),l&&l.length&&void 0!==l[1]&&(i.maximum=l[1]),f&&f.length&&void 0!==f[1]&&(i.scalable=f[1])}return e=Object(o.defaults)(t||{},i),t&&(e.width&&r.push("width="+e.width),e.height&&r.push("height="+e.height),e.scale&&r.push("initial-scale="+e.scale),"no"===e.scalable?(r.push("minimum-scale="+e.scale),r.push("maximum-scale="+e.scale),r.push("user-scalable="+e.scalable)):(e.scalable&&r.push("user-scalable="+e.scalable),e.minimum&&r.push("minimum-scale="+e.minimum),e.maximum&&r.push("minimum-scale="+e.maximum)),n||((n=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(n)),n.setAttribute("content",r.join(", ")),this.window.scrollTo(0,0)),e}},{key:"expand",value:function(){this.emit(c.c.CONTENTS.EXPAND)}},{key:"listeners",value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),"undefined"==typeof ResizeObserver?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}},{key:"removeListeners",value:function(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}},{key:"resizeCheck",value:function(){var t=this.textWidth(),e=this.textHeight();t==this._size.width&&e==this._size.height||(this._size={width:t,height:e},this.onResize&&this.onResize(this._size),this.emit(c.c.CONTENTS.RESIZE,this._size))}},{key:"resizeListeners",value:function(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:"visibilityListeners",value:function(){var t=this;document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&!1===t.active?(t.active=!0,t.resizeListeners()):(t.active=!1,clearTimeout(t.expanding))}))}},{key:"transitionListeners",value:function(){var t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}},{key:"mediaQueryListeners",value:function(){for(var t=this.document.styleSheets,e=function(t){t.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),n=0;n<t.length;n+=1){var i;try{i=t[n].cssRules}catch(t){return}if(!i)return;for(var r=0;r<i.length;r+=1)i[r].media&&this.window.matchMedia(i[r].media.mediaText).addListener(e)}}},{key:"resizeObservers",value:function(){var t=this;this.observer=new ResizeObserver((function(e){requestAnimationFrame(t.resizeCheck.bind(t))})),this.observer.observe(this.document.documentElement)}},{key:"mutationObservers",value:function(){var t=this;this.observer=new MutationObserver((function(e){t.resizeCheck()})),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}},{key:"imageLoadListeners",value:function(){for(var t,e=this.document.querySelectorAll("img"),n=0;n<e.length;n++)void 0!==(t=e[n]).naturalWidth&&0===t.naturalWidth&&(t.onload=this.expand.bind(this))}},{key:"fontLoadListeners",value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}},{key:"root",value:function(){return this.document?this.document.documentElement:null}},{key:"locationOf",value:function(t,e){var n,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(t)){var r=new s.a(t).toRange(this.document,e);if(r){try{if(!r.endContainer||r.startContainer==r.endContainer&&r.startOffset==r.endOffset){var o=r.startContainer.textContent.indexOf(" ",r.startOffset);-1==o&&(o=r.startContainer.textContent.length),r.setEnd(r.startContainer,o)}}catch(t){console.error("setting end offset to start container length failed",t)}if(r.startContainer.nodeType===Node.ELEMENT_NODE)n=r.startContainer.getBoundingClientRect(),i.left=n.left,i.top=n.top;else if(d){var a=r.startContainer,u=new Range;try{1===a.nodeType?n=a.getBoundingClientRect():r.startOffset+2<a.length?(u.setStart(a,r.startOffset),u.setEnd(a,r.startOffset+2),n=u.getBoundingClientRect()):r.startOffset-2>0?(u.setStart(a,r.startOffset-2),u.setEnd(a,r.startOffset),n=u.getBoundingClientRect()):n=a.parentNode.getBoundingClientRect()}catch(t){console.error(t,t.stack)}}else n=r.getBoundingClientRect()}}else if("string"==typeof t&&t.indexOf("#")>-1){var c=t.substring(t.indexOf("#")+1),h=this.document.getElementById(c);if(h)if(d){var l=new Range;l.selectNode(h),n=l.getBoundingClientRect()}else n=h.getBoundingClientRect()}return n&&(i.left=n.left,i.top=n.top),i}},{key:"addStylesheet",value:function(t){return new Promise(function(e,n){var i,r=!1;this.document?(i=this.document.querySelector("link[href='"+t+"']"))?e(!0):((i=this.document.createElement("link")).type="text/css",i.rel="stylesheet",i.href=t,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout((function(){e(!0)}),1))},this.document.head.appendChild(i)):e(!1)}.bind(this))}},{key:"_getStylesheetNode",value:function(t){var e;return t="epubjs-inserted-css-"+(t||""),!!this.document&&((e=this.document.getElementById(t))||((e=this.document.createElement("style")).id=t,this.document.head.appendChild(e)),e)}},{key:"addStylesheetCss",value:function(t,e){return!(!this.document||!t||(this._getStylesheetNode(e).innerHTML=t,0))}},{key:"addStylesheetRules",value:function(t,e){var n;if(this.document&&t&&0!==t.length)if(n=this._getStylesheetNode(e).sheet,"[object Array]"===Object.prototype.toString.call(t))for(var i=0,r=t.length;i<r;i++){var o=1,s=t[i],a=t[i][0],u="";"[object Array]"===Object.prototype.toString.call(s[1][0])&&(s=s[1],o=0);for(var c=s.length;o<c;o++){var h=s[o];u+=h[0]+":"+h[1]+(h[2]?" !important":"")+";\n"}n.insertRule(a+"{"+u+"}",n.cssRules.length)}else Object.keys(t).forEach((function(e){var i=t[e];if(Array.isArray(i))i.forEach((function(t){var i=Object.keys(t).map((function(e){return"".concat(e,":").concat(t[e])})).join(";");n.insertRule("".concat(e,"{").concat(i,"}"),n.cssRules.length)}));else{var r=Object.keys(i).map((function(t){return"".concat(t,":").concat(i[t])})).join(";");n.insertRule("".concat(e,"{").concat(r,"}"),n.cssRules.length)}}))}},{key:"addScript",value:function(t){return new Promise(function(e,n){var i,r=!1;this.document?((i=this.document.createElement("script")).type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout((function(){e(!0)}),1))},this.document.head.appendChild(i)):e(!1)}.bind(this))}},{key:"addClass",value:function(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.add(t)}},{key:"removeClass",value:function(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.remove(t)}},{key:"addEventListeners",value:function(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),c.a.forEach((function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0})}),this))}},{key:"removeEventListeners",value:function(){this.document&&(c.a.forEach((function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0})}),this),this._triggerEvent=void 0)}},{key:"triggerEvent",value:function(t){this.emit(t.type,t)}},{key:"addSelectionListeners",value:function(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}},{key:"removeSelectionListeners",value:function(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}},{key:"onSelectionChange",value:function(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}},{key:"triggerSelectedEvent",value:function(t){var e,n;t&&t.rangeCount>0&&((e=t.getRangeAt(0)).collapsed||(n=new s.a(e,this.cfiBase).toString(),this.emit(c.c.CONTENTS.SELECTED,n),this.emit(c.c.CONTENTS.SELECTED_RANGE,e)))}},{key:"range",value:function(t,e){return new s.a(t).toRange(this.document,e)}},{key:"cfiFromRange",value:function(t,e){return new s.a(t,this.cfiBase,e).toString()}},{key:"cfiFromNode",value:function(t,e){return new s.a(t,this.cfiBase,e).toString()}},{key:"map",value:function(t){var e=new a.a(t);return e.section()}},{key:"size",value:function(t,e){var n={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),n.width=t,this.css("padding","0 "+t/12+"px")),e>=0&&(this.height(e),n.height=e),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(n)}},{key:"columns",value:function(t,e,n,i,r){var s=Object(o.prefixed)("column-axis"),a=Object(o.prefixed)("column-gap"),u=Object(o.prefixed)("column-width"),c=Object(o.prefixed)("column-fill"),h=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===r&&"horizontal"===h&&this.direction(r),this.width(t),this.height(e),this.viewport({width:t,height:e,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===h?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(s,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(s,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(c,"auto"),this.css(a,i+"px"),this.css(u,n+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}},{key:"scaler",value:function(t,e,n){var i="scale("+t+")",r="";this.css("transform-origin","top left"),(e>=0||n>=0)&&(r=" translate("+(e||0)+"px, "+(n||0)+"px )"),this.css("transform",i+r)}},{key:"fit",value:function(t,e,n){var i=this.viewport(),r=parseInt(i.width),o=parseInt(i.height),s=t/r,a=e/o,u=s<a?s:a;if(this.layoutStyle("paginated"),this.width(r),this.height(o),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",r*u+"px "+o*u+"px"),this.css("background-color","transparent"),n&&n.properties.includes("page-spread-left")){var c=t-r*u;this.css("margin-left",c+"px")}}},{key:"direction",value:function(t){this.documentElement&&(this.documentElement.style.direction=t)}},{key:"mapPage",value:function(t,e,n,i,r){return new a.a(e,r).page(this,t,n,i)}},{key:"linksHandler",value:function(){var t=this;Object(u.c)(this.content,(function(e){t.emit(c.c.CONTENTS.LINK_CLICKED,e)}))}},{key:"writingMode",value:function(t){var e=Object(o.prefixed)("writing-mode");return t&&this.documentElement&&(this.documentElement.style[e]=t),this.window.getComputedStyle(this.documentElement)[e]||""}},{key:"layoutStyle",value:function(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}},{key:"epubReadingSystem",value:function(t,e){return navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(t){switch(t){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;case"spine-scripting":default:return!1}}},navigator.epubReadingSystem}},{key:"destroy",value:function(){this.removeListeners()}}])&&h(e.prototype,n),i&&h(e,i),t}();r()(p.prototype),e.a=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Underline=e.Highlight=e.Mark=e.Pane=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=s(n(207)),o=s(n(208));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.Pane=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;c(this,t),this.target=e,this.element=r.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),o.default.proxyMouse(this.target,this.marks),this.container=n,this.container.appendChild(this.element),this.render()}return i(t,[{key:"addMark",value:function(t){var e=r.default.createElement("g");return this.element.appendChild(e),t.bind(e,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var e=this.marks.indexOf(t);if(-1!==e){var n=t.unbind();this.element.removeChild(n),this.marks.splice(e,1)}}},{key:"render",value:function(){var t,e,n,i;!function(t,e){t.style.setProperty("top",e.top+"px","important"),t.style.setProperty("left",e.left+"px","important"),t.style.setProperty("height",e.height+"px","important"),t.style.setProperty("width",e.width+"px","important")}(this.element,(t=this.target,e=this.container,n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),{top:i.top-n.top,left:i.left-n.left,height:t.scrollHeight,width:t.scrollWidth}));var r=!0,o=!1,s=void 0;try{for(var a,u=this.marks[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){a.value.render()}}catch(t){o=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw s}}}}]),t}();var h=e.Mark=function(){function t(){c(this,t),this.element=null}return i(t,[{key:"bind",value:function(t,e){this.element=t,this.container=e}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],e=this.element.firstChild;e;)t.push(e.getBoundingClientRect()),e=e.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter((function(e){for(var n=0;n<t.length;n++){if(t[n]===e)return!0;if(i=t[n],(r=e).right<=i.right&&r.left>=i.left&&r.top>=i.top&&r.bottom<=i.bottom)return!1}var i,r;return!0}))}}]),t}(),l=e.Highlight=function(t){function e(t,n,i,r){c(this,e);var o=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.range=t,o.className=n,o.data=i||{},o.attributes=r||{},o}return u(e,t),i(e,[{key:"bind",value:function(t,n){for(var i in function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,t,n),this.data)this.data.hasOwnProperty(i)&&(this.element.dataset[i]=this.data[i]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&this.element.setAttribute(i,this.attributes[i]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),e=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),o=0,s=e.length;o<s;o++){var a=e[o],u=r.default.createElement("rect");u.setAttribute("x",a.left-n.left+i.left),u.setAttribute("y",a.top-n.top+i.top),u.setAttribute("height",a.height),u.setAttribute("width",a.width),t.appendChild(u)}this.element.appendChild(t)}}]),e}(h);e.Underline=function(t){function e(t,n,i,r){return c(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i,r))}return u(e,t),i(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),e=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),o=0,s=e.length;o<s;o++){var a=e[o],u=r.default.createElement("rect");u.setAttribute("x",a.left-n.left+i.left),u.setAttribute("y",a.top-n.top+i.top),u.setAttribute("height",a.height),u.setAttribute("width",a.width),u.setAttribute("fill","none");var c=r.default.createElement("line");c.setAttribute("x1",a.left-n.left+i.left),c.setAttribute("x2",a.left-n.left+i.left+a.width),c.setAttribute("y1",a.top-n.top+i.top+a.height-1),c.setAttribute("y2",a.top-n.top+i.top+a.height-1),c.setAttribute("stroke-width",1),c.setAttribute("stroke","black"),c.setAttribute("stroke-linecap","square"),t.appendChild(u),t.appendChild(c)}this.element.appendChild(t)}}]),e}(l)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(8);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(93),r=n(73),o=i("keys");t.exports=function(t){return o[t]||(o[t]=r(t))}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+i).toString(36)}},function(t,e,n){var i=n(42),r=Math.max,o=Math.min;t.exports=function(t,e){var n=i(t);return n<0?r(n+e,0):o(n,e)}},function(t,e,n){var i=n(37);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){"use strict";var i=n(71),r=n(21),o=n(46);t.exports=function(t,e,n){var s=i(e);s in t?r.f(t,s,o(0,n)):t[s]=n}},function(t,e,n){"use strict";var i=n(4);t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},function(t,e,n){var i=n(5),r=n(57),o=n(21),s=i("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:r(null)}),t.exports=function(t){a[s][t]=!0}},function(t,e,n){var i=n(121),r=n(95);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},function(t,e,n){var i=n(105),r=n(58),o=n(5)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||r[i(t)]}},function(t,e,n){"use strict";var i,r,o=n(106),s=n(137),a=RegExp.prototype.exec,u=String.prototype.replace,c=a,h=(i=/a/,r=/b*/g,a.call(i,"a"),a.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),l=s.UNSUPPORTED_Y||s.BROKEN_CARET,f=void 0!==/()??/.exec("")[1];(h||f||l)&&(c=function(t){var e,n,i,r,s=this,c=l&&s.sticky,d=o.call(s),p=s.source,v=0,g=t;return c&&(-1===(d=d.replace("y","")).indexOf("g")&&(d+="g"),g=String(t).slice(s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\n"!==t[s.lastIndex-1])&&(p="(?: "+p+")",g=" "+g,v++),n=new RegExp("^(?:"+p+")",d)),f&&(n=new RegExp("^"+p+"$(?!\\s)",d)),h&&(e=s.lastIndex),i=a.call(c?n:s,g),c?i?(i.input=i.input.slice(v),i[0]=i[0].slice(v),i.index=s.lastIndex,s.lastIndex+=i[0].length):s.lastIndex=0:h&&i&&(s.lastIndex=s.global?i.index+i[0].length:e),f&&i&&i.length>1&&u.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),t.exports=c},function(t,e,n){"use strict";n(16);var i=n(28),r=n(4),o=n(5),s=n(82),a=n(27),u=o("species"),c=!r((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),h="$0"==="a".replace(/./,"$0"),l=o("replace"),f=!!/./[l]&&""===/./[l]("a","$0"),d=!r((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,l){var p=o(t),v=!r((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),g=v&&!r((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[u]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!v||!g||"replace"===t&&(!c||!h||f)||"split"===t&&!d){var y=/./[p],m=n(p,""[t],(function(t,e,n,i,r){return e.exec===s?v&&!r?{done:!0,value:y.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),{REPLACE_KEEPS_$0:h,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),b=m[0],w=m[1];i(String.prototype,t,b),i(RegExp.prototype,p,2==e?function(t,e){return w.call(t,this,e)}:function(t){return w.call(t,this)})}l&&a(RegExp.prototype[p],"sham",!0)}},function(t,e,n){var i=n(37),r=n(82);t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},function(t,e,n){"use strict";var i=n(3),r=n(74),o=n(42),s=n(22),a=n(25),u=n(98),c=n(76),h=n(56),l=n(35),f=h("splice"),d=l("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,v=Math.min;i({target:"Array",proto:!0,forced:!f||!d},{splice:function(t,e){var n,i,h,l,f,d,g=a(this),y=s(g.length),m=r(t,y),b=arguments.length;if(0===b?n=i=0:1===b?(n=0,i=y-m):(n=b-2,i=v(p(o(e),0),y-m)),y+n-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(h=u(g,i),l=0;l<i;l++)(f=m+l)in g&&c(h,l,g[f]);if(h.length=i,n<i){for(l=m;l<y-i;l++)d=l+n,(f=l+i)in g?g[d]=g[f]:delete g[d];for(l=y;l>y-i+n;l--)delete g[l-1]}else if(n>i)for(l=y-i;l>m;l--)d=l+n-1,(f=l+i-1)in g?g[d]=g[f]:delete g[d];for(l=0;l<n;l++)g[l+m]=arguments[l+2];return g.length=y-i+n,h}})},function(t,e,n){"use strict";var i=n(3),r=n(202).trim;i({target:"String",proto:!0,forced:n(203)("trim")},{trim:function(){return r(this)}})},function(e,n){e.exports=t},function(t,e,n){"use strict";n(64),n(65),n(66),n(62),n(7),n(15),n(41),n(10),n(29),n(19),n(11),n(23);var i=n(12),r=n.n(i),o=n(0),s=n(24),a=n(2),u=n(49),c=(n(67),n(1));function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.name=e.layout||"reflowable",this._spread="none"!==e.spread,this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,"scrolled"===e.flow||"scrolled-continuous"===e.flow||"scrolled-doc"===e.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}var e,n,i;return e=t,(n=[{key:"flow",value:function(t){return void 0!==t&&(this._flow="scrolled"===t||"scrolled-continuous"===t||"scrolled-doc"===t?"scrolled":"paginated",this.update({flow:this._flow})),this._flow}},{key:"spread",value:function(t,e){return t&&(this._spread="none"!==t,this.update({spread:this._spread})),e>=0&&(this._minSpreadWidth=e),this._spread}},{key:"calculate",value:function(t,e,n){var i,r,o,s,a=1,u=n||0,c=t,h=e,l=Math.floor(c/12);a=this._spread&&c>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||n>=0||(u=l%2==0?l:l-1),"pre-paginated"===this.name&&(u=0),a>1?o=(i=c/a-u)+u:(i=c,o=c),"pre-paginated"===this.name&&a>1&&(c=i),r=i*a+u,s=c,this.width=c,this.height=h,this.spreadWidth=r,this.pageWidth=o,this.delta=s,this.columnWidth=i,this.gap=u,this.divisor=a,this.update({width:c,height:h,spreadWidth:r,pageWidth:o,delta:s,columnWidth:i,gap:u,divisor:a})}},{key:"format",value:function(t,e,n){return"pre-paginated"===this.name?t.fit(this.columnWidth,this.height,e):"paginated"===this._flow?t.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&"horizontal"===n?t.size(null,this.height):t.size(this.width,null)}},{key:"count",value:function(t,e){var n,i;return"pre-paginated"===this.name?(n=1,i=1):"paginated"===this._flow?(e=e||this.delta,i=(n=Math.ceil(t/e))*this.divisor):(e=e||this.height,i=n=Math.ceil(t/e)),{spreads:n,pages:i}}},{key:"update",value:function(t){var e=this;if(Object.keys(t).forEach((function(n){e.props[n]===t[n]&&delete t[n]})),Object.keys(t).length>0){var n=Object(o.extend)(this.props,t);this.emit(c.c.LAYOUT.UPDATED,n,t)}}}])&&h(e.prototype,n),i&&h(e,i),t}();r()(l.prototype);var f=l,d=(n(14),n(31),n(20));function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}var e,n,i;return e=t,(n=[{key:"register",value:function(){if(0!==arguments.length)return 1===arguments.length&&"object"===p(arguments[0])?this.registerThemes(arguments[0]):1===arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2===arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2===arguments.length&&"object"===p(arguments[1])?this.registerRules(arguments[0],arguments[1]):void 0}},{key:"default",value:function(t){if(t)return"string"==typeof t?this.registerUrl("default",t):"object"===p(t)?this.registerRules("default",t):void 0}},{key:"registerThemes",value:function(t){for(var e in t)t.hasOwnProperty(e)&&("string"==typeof t[e]?this.registerUrl(e,t[e]):this.registerRules(e,t[e]))}},{key:"registerCss",value:function(t,e){this._themes[t]={serialized:e},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"registerUrl",value:function(t,e){var n=new d.a(e);this._themes[t]={url:n.toString()},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"registerRules",value:function(t,e){this._themes[t]={rules:e},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"select",value:function(t){var e=this._current;this._current=t,this.update(t),this.rendition.getContents().forEach((function(n){n.removeClass(e),n.addClass(t)}))}},{key:"update",value:function(t){var e=this;this.rendition.getContents().forEach((function(n){e.add(t,n)}))}},{key:"inject",value:function(t){var e,n=[],i=this._themes;for(var r in i)!i.hasOwnProperty(r)||r!==this._current&&"default"!==r||(((e=i[r]).rules&&Object.keys(e.rules).length>0||e.url&&-1===n.indexOf(e.url))&&this.add(r,t),this._injected.push(r));"default"!=this._current&&t.addClass(this._current)}},{key:"add",value:function(t,e){var n=this._themes[t];n&&e&&(n.url?e.addStylesheet(n.url):n.serialized?(e.addStylesheetCss(n.serialized,t),n.injected=!0):n.rules&&(e.addStylesheetRules(n.rules,t),n.injected=!0))}},{key:"override",value:function(t,e,n){var i=this,r=this.rendition.getContents();this._overrides[t]={value:e,priority:!0===n},r.forEach((function(e){e.css(t,i._overrides[t].value,i._overrides[t].priority)}))}},{key:"removeOverride",value:function(t){var e=this.rendition.getContents();delete this._overrides[t],e.forEach((function(e){e.css(t)}))}},{key:"overrides",value:function(t){var e=this._overrides;for(var n in e)e.hasOwnProperty(n)&&t.css(n,e[n].value,e[n].priority)}},{key:"fontSize",value:function(t){this.override("font-size",t)}},{key:"font",value:function(t){this.override("font-family",t,!0)}},{key:"destroy",value:function(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}])&&v(e.prototype,n),i&&v(e,i),t}();n(68);function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}var w=function(){function t(e){y(this,t),this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}return b(t,[{key:"add",value:function(t,e,n,i,r,o){var s=encodeURI(e+t),u=new a.a(e).spinePos,c=new k({type:t,cfiRange:e,data:n,sectionIndex:u,cb:i,className:r,styles:o});return this._annotations[s]=c,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(s):this._annotationsBySectionIndex[u]=[s],this.rendition.views().forEach((function(t){c.sectionIndex===t.index&&c.attach(t)})),c}},{key:"remove",value:function(t,e){var n=this,i=encodeURI(t+e);if(i in this._annotations){var r=this._annotations[i];if(e&&r.type!==e)return;this.rendition.views().forEach((function(t){n._removeFromAnnotationBySectionIndex(r.sectionIndex,i),r.sectionIndex===t.index&&r.detach(t)})),delete this._annotations[i]}}},{key:"_removeFromAnnotationBySectionIndex",value:function(t,e){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter((function(t){return t!==e}))}},{key:"_annotationsAt",value:function(t){return this._annotationsBySectionIndex[t]}},{key:"highlight",value:function(t,e,n,i,r){return this.add("highlight",t,e,n,i,r)}},{key:"underline",value:function(t,e,n,i,r){return this.add("underline",t,e,n,i,r)}},{key:"mark",value:function(t,e,n){return this.add("mark",t,e,n)}},{key:"each",value:function(){return this._annotations.forEach.apply(this._annotations,arguments)}},{key:"inject",value:function(t){var e=this,n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach((function(n){e._annotations[n].attach(t)}))}},{key:"clear",value:function(t){var e=this,n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach((function(n){e._annotations[n].detach(t)}))}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),t}(),k=function(){function t(e){var n=e.type,i=e.cfiRange,r=e.data,o=e.sectionIndex,s=e.cb,a=e.className,u=e.styles;y(this,t),this.type=n,this.cfiRange=i,this.data=r,this.sectionIndex=o,this.mark=void 0,this.cb=s,this.className=a,this.styles=u}return b(t,[{key:"update",value:function(t){this.data=t}},{key:"attach",value:function(t){var e,n=this.cfiRange,i=this.data,r=this.type,o=(this.mark,this.cb),s=this.className,a=this.styles;return"highlight"===r?e=t.highlight(n,i,o,s,a):"underline"===r?e=t.underline(n,i,o,s,a):"mark"===r&&(e=t.mark(n,i,o)),this.mark=e,this.emit(c.c.ANNOTATION.ATTACH,e),e}},{key:"detach",value:function(t){var e,n=this.cfiRange,i=this.type;return t&&("highlight"===i?e=t.unhighlight(n):"underline"===i?e=t.ununderline(n):"mark"===i&&(e=t.unmark(n))),this.mark=void 0,this.emit(c.c.ANNOTATION.DETACH,e),e}},{key:"text",value:function(){}}]),t}();r()(k.prototype);var x=w,E=n(112),S=n(50),O=n(114);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var T=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=Object(o.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr"}),Object(o.extend)(this.settings,n),"object"===_(this.settings.manager)&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new s.a(this),this.hooks.serialize=new s.a(this),this.hooks.content=new s.a(this),this.hooks.unloaded=new s.a(this),this.hooks.layout=new s.a(this),this.hooks.render=new s.a(this),this.hooks.show=new s.a(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new g(this),this.annotations=new x(this),this.epubcfi=new a.a,this.q=new u.a(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new o.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}var e,n,i;return e=t,(n=[{key:"setManager",value:function(t){this.manager=t}},{key:"requireManager",value:function(t){return"string"==typeof t&&"default"===t?S.a:"string"==typeof t&&"continuous"===t?O.a:t}},{key:"requireView",value:function(t){return"string"==typeof t&&"iframe"===t?E.a:t}},{key:"start",value:function(){switch(this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(c.c.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(c.c.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(c.c.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(c.c.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(c.c.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(c.c.RENDITION.STARTED),this.starting.resolve()}},{key:"attachTo",value:function(t){return this.q.enqueue(function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(c.c.RENDITION.ATTACHED)}.bind(this))}},{key:"display",value:function(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t)}},{key:"_display",value:function(t){var e=this;if(this.book){this.epubcfi.isCfiString(t);var n,i=new o.defer,r=i.promise;return this.displaying=i,this.book.locations.length()&&Object(o.isFloat)(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),(n=this.book.spine.get(t))?(this.manager.display(n,t).then((function(){i.resolve(n),e.displaying=void 0,e.emit(c.c.RENDITION.DISPLAYED,n),e.reportLocation()}),(function(t){e.emit(c.c.RENDITION.DISPLAY_ERROR,t)})),r):(i.reject(new Error("No Section Found")),r)}}},{key:"afterDisplayed",value:function(t){var e=this;t.on(c.c.VIEWS.MARK_CLICKED,(function(n,i){return e.triggerMarkEvent(n,i,t.contents)})),this.hooks.render.trigger(t,this).then((function(){t.contents?e.hooks.content.trigger(t.contents,e).then((function(){e.emit(c.c.RENDITION.RENDERED,t.section,t)})):e.emit(c.c.RENDITION.RENDERED,t.section,t)}))}},{key:"afterRemoved",value:function(t){var e=this;this.hooks.unloaded.trigger(t,this).then((function(){e.emit(c.c.RENDITION.REMOVED,t.section,t)}))}},{key:"onResized",value:function(t,e){this.emit(c.c.RENDITION.RESIZED,{width:t.width,height:t.height},e),this.location&&this.location.start&&this.display(e||this.location.start.cfi)}},{key:"onOrientationChange",value:function(t){this.emit(c.c.RENDITION.ORIENTATION_CHANGE,t)}},{key:"moveTo",value:function(t){this.manager.moveTo(t)}},{key:"resize",value:function(t,e,n){t&&(this.settings.width=t),e&&(this.settings.height=e),this.manager.resize(t,e,n)}},{key:"clear",value:function(){this.manager.clear()}},{key:"next",value:function(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"prev",value:function(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"determineLayoutProperties",value:function(t){var e=this.settings.layout||t.layout||"reflowable",n=this.settings.spread||t.spread||"auto",i=this.settings.orientation||t.orientation||"auto",r=this.settings.flow||t.flow||"auto",o=t.viewport||"",s=this.settings.minSpreadWidth||t.minSpreadWidth||800,a=this.settings.direction||t.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:e,spread:n,orientation:i,flow:r,viewport:o,minSpreadWidth:s,direction:a}}},{key:"flow",value:function(t){var e=t;"scrolled"!==t&&"scrolled-doc"!==t&&"scrolled-continuous"!==t||(e="scrolled"),"auto"!==t&&"paginated"!==t||(e="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(e),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(e),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"layout",value:function(t){var e=this;return t&&(this._layout=new f(t),this._layout.spread(t.spread,this.settings.minSpreadWidth),this._layout.on(c.c.LAYOUT.UPDATED,(function(t,n){e.emit(c.c.RENDITION.LAYOUT,t,n)}))),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}},{key:"spread",value:function(t,e){this.settings.spread=t,e&&(this.settings.minSpreadWidth=e),this._layout&&this._layout.spread(t,e),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}},{key:"direction",value:function(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"reportLocation",value:function(){return this.q.enqueue(function(){requestAnimationFrame(function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){var e=this.located(t);e&&e.start&&e.end&&(this.location=e,this.emit(c.c.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(c.c.RENDITION.RELOCATED,this.location))}.bind(this));else if(t){var e=this.located(t);if(!e||!e.start||!e.end)return;this.location=e,this.emit(c.c.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(c.c.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}},{key:"currentLocation",value:function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){return this.located(t)}.bind(this));else if(t)return this.located(t)}},{key:"located",value:function(t){if(!t.length)return{};var e=t[0],n=t[t.length-1],i={start:{index:e.index,href:e.href,cfi:e.mapping.start,displayed:{page:e.pages[0]||1,total:e.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},r=this.book.locations.locationFromCfi(e.mapping.start),o=this.book.locations.locationFromCfi(n.mapping.end);null!=r&&(i.start.location=r,i.start.percentage=this.book.locations.percentageFromLocation(r)),null!=o&&(i.end.location=o,i.end.percentage=this.book.locations.percentageFromLocation(o));var s=this.book.pageList.pageFromCfi(e.mapping.start),a=this.book.pageList.pageFromCfi(n.mapping.end);return-1!=s&&(i.start.page=s),-1!=a&&(i.end.page=a),n.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),e.index===this.book.spine.first().index&&1===i.start.displayed.page&&(i.atStart=!0),i}},{key:"destroy",value:function(){this.manager&&this.manager.destroy(),this.book=void 0}},{key:"passEvents",value:function(t){var e=this;c.a.forEach((function(n){t.on(n,(function(n){return e.triggerViewEvent(n,t)}))})),t.on(c.c.CONTENTS.SELECTED,(function(n){return e.triggerSelectedEvent(n,t)}))}},{key:"triggerViewEvent",value:function(t,e){this.emit(t.type,t,e)}},{key:"triggerSelectedEvent",value:function(t,e){this.emit(c.c.RENDITION.SELECTED,t,e)}},{key:"triggerMarkEvent",value:function(t,e,n){this.emit(c.c.RENDITION.MARK_CLICKED,t,e,n)}},{key:"getRange",value:function(t,e){var n=new a.a(t),i=this.manager.visible().filter((function(t){if(n.spinePos===t.index)return!0}));if(i.length)return i[0].contents.range(n,e)}},{key:"adjustImages",value:function(t){if("pre-paginated"===this._layout.name)return new Promise((function(t){t()}));var e=t.window.getComputedStyle(t.content,null),n=.95*(t.content.offsetHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom))),i=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise((function(t,e){setTimeout((function(){t()}),1)}))}},{key:"getContents",value:function(){return this.manager?this.manager.getContents():[]}},{key:"views",value:function(){var t=this.manager?this.manager.views:void 0;return t||[]}},{key:"handleLinks",value:function(t){var e=this;t&&t.on(c.c.CONTENTS.LINK_CLICKED,(function(t){var n=e.book.path.relative(t);e.display(n)}))}},{key:"injectStylesheet",value:function(t,e){var n=t.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(n)}},{key:"injectScript",value:function(t,e){var n=t.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.settings.script),n.textContent=" ",t.getElementsByTagName("head")[0].appendChild(n)}},{key:"injectIdentifier",value:function(t,e){var n=this.book.packaging.metadata.identifier,i=t.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),n&&i.setAttribute("content",n),t.getElementsByTagName("head")[0].appendChild(i)}}])&&C(e.prototype,n),i&&C(e,i),t}();r()(T.prototype);e.a=T},function(t,e,n){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!i.call({1:2},1);e.f=o?function(t){var e=r(this,t);return!!e&&e.enumerable}:i},function(t,e,n){var i=n(6),r=n(8),o=i.document,s=r(o)&&r(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},function(t,e,n){var i=n(6),r=n(27);t.exports=function(t,e){try{r(i,t,e)}catch(n){i[t]=e}return e}},function(t,e,n){var i=n(118),r=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(t){return r.call(t)}),t.exports=i.inspectSource},function(t,e,n){var i=n(47),r=n(118);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:i?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var i=n(32),r=n(22),o=n(74),s=function(t){return function(e,n,s){var a,u=i(e),c=r(u.length),h=o(s,c);if(t&&n!=n){for(;c>h;)if((a=u[h++])!=a)return!0}else for(;c>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(4),r=/#|\.prototype\./,o=function(t,e){var n=a[s(t)];return n==c||n!=u&&("function"==typeof e?i(e):!!e)},s=o.normalize=function(t){return String(t).replace(r,".").toLowerCase()},a=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},function(t,e,n){var i=n(8),r=n(75),o=n(5)("species");t.exports=function(t,e){var n;return r(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!r(n.prototype)?i(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},function(t,e,n){var i=n(4);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},function(t,e,n){var i,r,o=n(6),s=n(123),a=o.process,u=a&&a.versions,c=u&&u.v8;c?r=(i=c.split("."))[0]+i[1]:s&&(!(i=s.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=s.match(/Chrome\/(\d+)/))&&(r=i[1]),t.exports=r&&+r},function(t,e,n){var i=n(9),r=n(160);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return i(n),r(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},function(t,e,n){var i=n(28);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e,n){"use strict";var i=n(38),r=n(21),o=n(5),s=n(18),a=o("species");t.exports=function(t){var e=i(t),n=r.f;s&&e&&!e[a]&&n(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){var i={};i[n(5)("toStringTag")]="z",t.exports="[object z]"===String(i)},function(t,e,n){var i=n(104),r=n(37),o=n(5)("toStringTag"),s="Arguments"==r(function(){return arguments}());t.exports=i?r:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?n:s?r(e):"Object"==(i=r(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,n){"use strict";var i=n(9);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var i=n(42),r=n(33),o=function(t){return function(e,n){var o,s,a=String(r(e)),u=i(n),c=a.length;return u<0||u>=c?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},function(t,e,n){"use strict";var i=n(107).charAt;t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){"use strict";var i=n(181)();t.exports=function(t){return t!==i&&null!==t}},function(t,e,n){var i=n(8),r=n(37),o=n(5)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){"use strict";n(7),n(14),n(41),n(206),n(67),n(10),n(29),n(11);var i=n(12),r=n.n(i),o=n(0),s=n(2),a=n(68),u=n(1),c=n(69);function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=Object(o.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1},n||{}),this.id="epubjs-view-"+Object(o.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new s.a,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}var e,n,i;return e=t,(n=[{key:"container",value:function(t){var e=document.createElement("div");return e.classList.add("epub-view"),e.style.height="0px",e.style.width="0px",e.style.overflow="hidden",e.style.position="relative",e.style.display="block",e.style.flex=t&&"horizontal"==t?"none":"initial",e}},{key:"create",value:function(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Object(o.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe}},{key:"render",value:function(t,e){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then(function(t){return this.load(t)}.bind(this)).then(function(){var t,e=this,n=this.contents.writingMode();return t="scrolled"===this.settings.flow?0===n.indexOf("vertical")?"horizontal":"vertical":0===n.indexOf("vertical")?"vertical":"horizontal",0===n.indexOf("vertical")&&"paginated"===this.settings.flow&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(u.c.VIEWS.AXIS,t),this.setWritingMode(n),this.emit(u.c.VIEWS.WRITING_MODE,n),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((function(t,n){e.expand(),e.settings.forceRight&&(e.element.style.marginLeft=e.width()+"px"),t()}))}.bind(this),function(t){return this.emit(u.c.VIEWS.LOAD_ERROR,t),new Promise((function(e,n){n(t)}))}.bind(this)).then(function(){this.emit(u.c.VIEWS.RENDERED,this.section)}.bind(this))}},{key:"reset",value:function(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}},{key:"size",value:function(t,e){var n=t||this.settings.width,i=e||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",n,i):"horizontal"===this.settings.axis?this.lock("height",n,i):this.lock("width",n,i),this.settings.width=n,this.settings.height=i}},{key:"lock",value:function(t,e,n){var i,r=Object(o.borders)(this.element);i=this.iframe?Object(o.borders)(this.iframe):{width:0,height:0},"width"==t&&Object(o.isNumber)(e)&&(this.lockedWidth=e-r.width-i.width),"height"==t&&Object(o.isNumber)(n)&&(this.lockedHeight=n-r.height-i.height),"both"===t&&Object(o.isNumber)(e)&&Object(o.isNumber)(n)&&(this.lockedWidth=e-r.width-i.width,this.lockedHeight=n-r.height-i.height),this.displayed&&this.iframe&&this.expand()}},{key:"expand",value:function(t){var e,n=this.lockedWidth,i=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(n=this.layout.columnWidth,i=this.layout.height):"horizontal"===this.settings.axis?((n=this.contents.textWidth())%this.layout.pageWidth>0&&(n=Math.ceil(n/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(e=n/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&e%2>0&&(n+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(i=this.contents.textHeight(),"paginated"===this.settings.flow&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||n!=this._width||i!=this._height)&&this.reframe(n,i),this._expanding=!1)}},{key:"reframe",value:function(t,e){var n,i=this;Object(o.isNumber)(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),Object(o.isNumber)(e)&&(this.element.style.height=e+"px",this.iframe.style.height=e+"px",this._height=e),n={width:t,height:e,widthDelta:this.prevBounds?t-this.prevBounds.width:t,heightDelta:this.prevBounds?e-this.prevBounds.height:e},this.pane&&this.pane.render(),requestAnimationFrame((function(){var t;for(var e in i.marks)i.marks.hasOwnProperty(e)&&(t=i.marks[e],i.placeMark(t.element,t.range))})),this.onResize(this,n),this.emit(u.c.VIEWS.RESIZED,n),this.prevBounds=n,this.elementBounds=Object(o.bounds)(this.element)}},{key:"load",value:function(t){var e=new o.defer,n=e.promise;if(!this.iframe)return e.reject(new Error("No Iframe Available")),n;if(this.iframe.onload=function(t){this.onLoad(t,e)}.bind(this),"blobUrl"===this.settings.method)this.blobUrl=Object(o.createBlobUrl)(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return e.reject(new Error("No Document Available")),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction((function(){i.iframe.contentDocument.write(t)}))}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close()}return n}},{key:"onLoad",value:function(t,e){var n=this;this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new a.a(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):((i=this.document.createElement("link")).setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(u.c.CONTENTS.EXPAND,(function(){n.displayed&&n.iframe&&(n.expand(),n.contents&&n.layout.format(n.contents))})),this.contents.on(u.c.CONTENTS.RESIZE,(function(t){n.displayed&&n.iframe&&(n.expand(),n.contents&&n.layout.format(n.contents))})),e.resolve(this.contents)}},{key:"setLayout",value:function(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand())}},{key:"setAxis",value:function(t){this.settings.axis=t,this.element.style.flex="horizontal"==t?"none":"initial",this.size()}},{key:"setWritingMode",value:function(t){this.writingMode=t}},{key:"addListeners",value:function(){}},{key:"removeListeners",value:function(t){}},{key:"display",value:function(t){var e=new o.defer;return this.displayed?e.resolve(this):this.render(t).then(function(){this.emit(u.c.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,e.resolve(this)}.bind(this),(function(t){e.reject(t,this)})),e.promise}},{key:"show",value:function(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(u.c.VIEWS.SHOWN,this)}},{key:"hide",value:function(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(u.c.VIEWS.HIDDEN,this)}},{key:"offset",value:function(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"position",value:function(){return this.element.getBoundingClientRect()}},{key:"locationOf",value:function(t){this.iframe.getBoundingClientRect();var e=this.contents.locationOf(t,this.settings.ignoreClass);return{left:e.left,top:e.top}}},{key:"onDisplayed",value:function(t){}},{key:"onResize",value:function(t,e){}},{key:"bounds",value:function(t){return!t&&this.elementBounds||(this.elementBounds=Object(o.bounds)(this.element)),this.elementBounds}},{key:"highlight",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-hl",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},o),a=this.contents.range(t),h=function(){e.emit(u.c.VIEWS.MARK_CLICKED,t,n)};n.epubcfi=t,this.pane||(this.pane=new c.Pane(this.iframe,this.element));var l=new c.Highlight(a,r,n,s),f=this.pane.addMark(l);return this.highlights[t]={mark:f,element:f.element,listeners:[h,i]},f.element.setAttribute("ref",r),f.element.addEventListener("click",h),f.element.addEventListener("touchstart",h),i&&(f.element.addEventListener("click",i),f.element.addEventListener("touchstart",i)),f}}},{key:"underline",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-ul",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},o),a=this.contents.range(t),h=function(){e.emit(u.c.VIEWS.MARK_CLICKED,t,n)};n.epubcfi=t,this.pane||(this.pane=new c.Pane(this.iframe,this.element));var l=new c.Underline(a,r,n,s),f=this.pane.addMark(l);return this.underlines[t]={mark:f,element:f.element,listeners:[h,i]},f.element.setAttribute("ref",r),f.element.addEventListener("click",h),f.element.addEventListener("touchstart",h),i&&(f.element.addEventListener("click",i),f.element.addEventListener("touchstart",i)),f}}},{key:"mark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(this.contents){if(t in this.marks){var r=this.marks[t];return r}var o=this.contents.range(t);if(o){var s=o.commonAncestorContainer,a=1===s.nodeType?s:s.parentNode,c=function(i){e.emit(u.c.VIEWS.MARK_CLICKED,t,n)};o.collapsed&&1===s.nodeType?(o=new Range).selectNodeContents(s):o.collapsed&&(o=new Range).selectNodeContents(a);var h=this.document.createElement("a");return h.setAttribute("ref","epubjs-mk"),h.style.position="absolute",h.dataset.epubcfi=t,n&&Object.keys(n).forEach((function(t){h.dataset[t]=n[t]})),i&&(h.addEventListener("click",i),h.addEventListener("touchstart",i)),h.addEventListener("click",c),h.addEventListener("touchstart",c),this.placeMark(h,o),this.element.appendChild(h),this.marks[t]={element:h,range:o,listeners:[c,i]},a}}}},{key:"placeMark",value:function(t,e){var n,i,r;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){var o=e.getBoundingClientRect();n=o.top,i=o.right}else for(var s,a=e.getClientRects(),u=0;u!=a.length;u++)s=a[u],(!r||s.left<r)&&(r=s.left,i=Math.ceil(r/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=s.top);t.style.top="".concat(n,"px"),t.style.left="".concat(i,"px")}},{key:"unhighlight",value:function(t){var e;t in this.highlights&&(e=this.highlights[t],this.pane.removeMark(e.mark),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.highlights[t])}},{key:"ununderline",value:function(t){var e;t in this.underlines&&(e=this.underlines[t],this.pane.removeMark(e.mark),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.underlines[t])}},{key:"unmark",value:function(t){var e;t in this.marks&&(e=this.marks[t],this.element.removeChild(e.element),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.marks[t])}},{key:"destroy",value:function(){for(var t in this.highlights)this.unhighlight(t);for(var e in this.underlines)this.ununderline(e);for(var n in this.marks)this.unmark(n);this.blobUrl&&Object(o.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}])&&h(e.prototype,n),i&&h(e,i),t}();r()(l.prototype),e.a=l},function(t,e,n){var i=n(111),r=n(209),o=n(211),s=Math.max,a=Math.min;t.exports=function(t,e,n){var u,c,h,l,f,d,p=0,v=!1,g=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function m(e){var n=u,i=c;return u=c=void 0,p=e,l=t.apply(i,n)}function b(t){return p=t,f=setTimeout(k,e),v?m(t):l}function w(t){var n=t-d;return void 0===d||n>=e||n<0||g&&t-p>=h}function k(){var t=r();if(w(t))return x(t);f=setTimeout(k,function(t){var n=e-(t-d);return g?a(n,h-(t-p)):n}(t))}function x(t){return f=void 0,y&&u?m(t):(u=c=void 0,l)}function E(){var t=r(),n=w(t);if(u=arguments,c=this,d=t,n){if(void 0===f)return b(d);if(g)return clearTimeout(f),f=setTimeout(k,e),m(d)}return void 0===f&&(f=setTimeout(k,e)),l}return e=o(e)||0,i(n)&&(v=!!n.leading,h=(g="maxWait"in n)?s(o(n.maxWait)||0,e):h,y="trailing"in n?!!n.trailing:y),E.cancel=function(){void 0!==f&&clearTimeout(f),p=0,u=d=c=f=void 0},E.flush=function(){return void 0===f?l:x(r())},E}},function(t,e,n){"use strict";n(64),n(65),n(66),n(217),n(14),n(15),n(40),n(36),n(41),n(141),n(218),n(10),n(29),n(219),n(221),n(31),n(19),n(86),n(23);var i=n(0),r=n(50),o=(n(7),n(1)),s=n(12),a=n.n(s);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var c=Math.PI/2,h={easeOutSine:function(t){return Math.sin(t*c)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInCubic:function(t){return Math.pow(t,3)}},l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=Object(i.extend)({duration:80,minVelocity:.2,minDistance:10,easing:h.easeInCubic},n||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}var e,n,r;return e=t,(n=[{key:"setup",value:function(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}},{key:"supportsTouch",value:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}},{key:"disableScroll",value:function(){this.element.style.overflow="hidden"}},{key:"enableScroll",value:function(){this.element.style.overflow=""}},{key:"addListeners",value:function(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(o.c.MANAGERS.ADDED,this._afterDisplayed)}},{key:"removeListeners",value:function(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(o.c.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}},{key:"afterDisplayed",value:function(t){var e=this,n=t.contents;["touchstart","touchmove","touchend"].forEach((function(t){n.on(t,(function(t){return e.triggerViewEvent(t,n)}))}))}},{key:"triggerViewEvent",value:function(t,e){this.emit(t.type,t,e)}},{key:"onScroll",value:function(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}},{key:"onResize",value:function(t){this.resizeCanceler=!0}},{key:"onTouchStart",value:function(t){var e=t.touches[0],n=e.screenX,i=e.screenY;this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=n,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=n,this.endTouchY=i,this.endTime=this.now()}},{key:"onTouchMove",value:function(t){var e=t.touches[0],n=e.screenX,i=e.screenY,r=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&r<10&&(this.element.scrollLeft-=n-this.endTouchX),this.endTouchX=n,this.endTouchY=i,this.endTime=this.now()}},{key:"onTouchEnd",value:function(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;var e=this.wasSwiped();0!==e?this.snap(e):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}},{key:"wasSwiped",value:function(){var t=this.layout.pageWidth*this.layout.divisor,e=this.endTouchX-this.startTouchX,n=Math.abs(e),i=e/(this.endTime-this.startTime),r=this.settings.minVelocity;return n<=this.settings.minDistance||n>=t?0:i>r?-1:i<-r?1:void 0}},{key:"needsSnap",value:function(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0}},{key:"snap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,i=Math.round(e/n)*n;return t&&(i+=t*n),this.smoothScrollTo(i)}},{key:"smoothScrollTo",value:function(t){var e=new i.defer,n=this.scrollLeft,r=this.now(),o=this.settings.duration,s=this.settings.easing;return this.snapping=!0,function i(){var a=this.now(),u=Math.min(1,(a-r)/o);if(s(u),this.touchCanceler||this.resizeCanceler)return this.resizeCanceler=!1,this.snapping=!1,void e.resolve();u<1?(window.requestAnimationFrame(i.bind(this)),this.scrollTo(n+(t-n)*u,0)):(this.scrollTo(t,0),this.snapping=!1,e.resolve())}.call(this),e.promise}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fullsize?window.scroll(t,e):(this.scroller.scrollLeft=t,this.scroller.scrollTop=e)}},{key:"now",value:function(){return"now"in window.performance?performance.now():(new Date).getTime()}},{key:"destroy",value:function(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}])&&u(e.prototype,n),r&&u(e,r),t}();a()(l.prototype);var f=l,d=n(113),p=n.n(d);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function y(t,e,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=k(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);if(e){var r=k(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w(this,n)}}function w(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(u,t);var e,n,s,a=b(u);function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this,t)).name="continuous",e.settings=Object(i.extend)(e.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10}),Object(i.extend)(e.settings,t.settings||{}),"undefined"!=t.settings.gap&&0===t.settings.gap&&(e.settings.gap=t.settings.gap),e.viewSettings={ignoreClass:e.settings.ignoreClass,axis:e.settings.axis,flow:e.settings.flow,layout:e.layout,width:0,height:0,forceEvenPages:!1},e.scrollTop=0,e.scrollLeft=0,e}return e=u,(n=[{key:"display",value:function(t,e){return r.a.prototype.display.call(this,t,e).then(function(){return this.fill()}.bind(this))}},{key:"fill",value:function(t){var e=this,n=t||new i.defer;return this.q.enqueue((function(){return e.check()})).then((function(t){t?e.fill(n):n.resolve()})),n.promise}},{key:"moveTo",value:function(t){var e=0,n=0;this.isPaginated?(e=Math.floor(t.left/this.layout.delta)*this.layout.delta,this.settings.offsetDelta):(n=t.top,t.top,this.settings.offsetDelta),(e>0||n>0)&&this.scrollBy(e,n,!0)}},{key:"afterResized",value:function(t){this.emit(o.c.MANAGERS.RESIZE,t.section)}},{key:"removeShownListeners",value:function(t){t.onDisplayed=function(){}}},{key:"add",value:function(t){var e=this,n=this.createView(t);return this.views.append(n),n.on(o.c.VIEWS.RESIZED,(function(t){n.expanded=!0})),n.on(o.c.VIEWS.AXIS,(function(t){e.updateAxis(t)})),n.on(o.c.VIEWS.WRITING_MODE,(function(t){e.updateWritingMode(t)})),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.display(this.request)}},{key:"append",value:function(t){var e=this,n=this.createView(t);return n.on(o.c.VIEWS.RESIZED,(function(t){n.expanded=!0})),n.on(o.c.VIEWS.AXIS,(function(t){e.updateAxis(t)})),n.on(o.c.VIEWS.WRITING_MODE,(function(t){e.updateWritingMode(t)})),this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n}},{key:"prepend",value:function(t){var e=this,n=this.createView(t);return n.on(o.c.VIEWS.RESIZED,(function(t){e.counter(t),n.expanded=!0})),n.on(o.c.VIEWS.AXIS,(function(t){e.updateAxis(t)})),n.on(o.c.VIEWS.WRITING_MODE,(function(t){e.updateWritingMode(t)})),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n}},{key:"counter",value:function(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}},{key:"update",value:function(t){for(var e,n=this.bounds(),r=this.views.all(),o=r.length,s=[],a=void 0!==t?t:this.settings.offset||0,u=new i.defer,c=[],h=0;h<o;h++)if(e=r[h],!0===this.isVisible(e,a,a,n)){if(e.displayed)e.show();else{var l=e.display(this.request).then((function(t){t.show()}),(function(t){e.hide()}));c.push(l)}s.push(e)}else this.q.enqueue(e.destroy.bind(e)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return c.length?Promise.all(c).catch((function(t){u.reject(t)})):(u.resolve(),u.promise)}},{key:"check",value:function(t,e){var n=this,r=new i.defer,o=[],s="horizontal"===this.settings.axis,a=this.settings.offset||0;t&&s&&(a=t),e&&!s&&(a=e);var u=this._bounds,c=s?this.scrollLeft:this.scrollTop,h=s?Math.floor(u.width):u.height,l=s?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&0===this.writingMode.indexOf("vertical")?"vertical":"horizontal",d=this.settings.rtlScrollType,p="rtl"===this.settings.direction;this.settings.fullsize?(s&&p&&"negative"===d||!s&&p&&"default"===d)&&(c*=-1):(p&&"default"===d&&"horizontal"===f&&(c=l-h-c),p&&"negative"===d&&"horizontal"===f&&(c*=-1));var v,g,y,m,b=c-a;c+h+a>=l&&(v=n.views.last(),(g=v&&v.section.next())&&o.push(n.append(g))),b<0&&(y=n.views.first(),(m=y&&y.section.prev())&&o.push(n.prepend(m)));var w=o.map((function(t){return t.display(n.request)}));return o.length?Promise.all(w).then((function(){return n.check()})).then((function(){return n.update(a)}),(function(t){return t})):(this.q.enqueue(function(){this.update()}.bind(this)),r.resolve(!1),r.promise)}},{key:"trim",value:function(){for(var t=new i.defer,e=this.views.displayed(),n=e[0],r=e[e.length-1],o=this.views.indexOf(n),s=this.views.indexOf(r),a=this.views.slice(0,o),u=this.views.slice(s+1),c=0;c<a.length-1;c++)this.erase(a[c],a);for(var h=1;h<u.length;h++)this.erase(u[h]);return t.resolve(),t.promise}},{key:"erase",value:function(t,e){var n,i;this.settings.fullsize?(n=window.scrollY,i=window.scrollX):(n=this.container.scrollTop,i=this.container.scrollLeft);var r=t.bounds();this.views.remove(t),e&&("vertical"===this.settings.axis?this.scrollTo(0,n-r.height,!0):"rtl"===this.settings.direction?this.settings.fullsize?this.scrollTo(i+Math.floor(r.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(r.width),0,!0))}},{key:"addEventListeners",value:function(t){window.addEventListener("unload",function(t){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new f(this,this.settings.snap&&"object"===v(this.settings.snap)&&this.settings.snap))}},{key:"addScrollListeners",value:function(){var t;this.tick=i.requestAnimationFrame;var e="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(t=window,this.scrollTop=window.scrollY*e,this.scrollLeft=window.scrollX*e):(t=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll),this._scrolled=p()(this.scrolled.bind(this),30),this.didScroll=!1}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"onScroll",value:function(){var t,e,n="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.settings.fullsize?(t=window.scrollY*n,e=window.scrollX*n):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(e-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=e,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}},{key:"scrolled",value:function(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(o.c.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(o.c.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}},{key:"next",value:function(){var t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(t,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}},{key:"prev",value:function(){var t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-t,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}},{key:"updateFlow",value:function(t){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),y(k(u.prototype),"updateFlow",this).call(this,t,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new f(this,this.settings.snap&&"object"===v(this.settings.snap)&&this.settings.snap))}},{key:"destroy",value:function(){y(k(u.prototype),"destroy",this).call(this),this.snapper&&this.snapper.destroy()}}])&&g(e.prototype,n),s&&g(e,s),u}(r.a);e.a=x},function(t,e,n){(function(e){t.exports=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,(function(t){var n=e[s][1][t];return r(n||t)}),c,c.exports,t,e,n,i)}return n[s].exports}for(var o=!1,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,n,i){(function(t){"use strict";var e,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var o=0,s=new r(h),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),e=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)e="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var u=new t.MessageChannel;u.port1.onmessage=h,e=function(){u.port2.postMessage(0)}}var c=[];function h(){var t,e;i=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}i=!1}n.exports=function(t){1!==c.push(t)||i||e()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var i=t(1);function r(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==r&&d(this,t)}function h(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(t,e,n){i((function(){var i;try{i=e(n)}catch(e){return o.reject(t,e)}i===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,i)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var n=!1;function i(e){n||(n=!0,o.reject(t,e))}function r(e){n||(n=!0,o.resolve(t,e))}var s=p((function(){e(r,i)}));"error"===s.status&&i(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=c,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var n=new this.constructor(r);return this.state!==u?l(n,this.state===a?t:e,this.outcome):this.queue.push(new h(n,t,e)),n},h.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){o.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return o.reject(t,n.value);var i=n.value;if(i)d(t,i);else{t.state=a,t.outcome=e;for(var r=-1,s=t.queue.length;++r<s;)t.queue[r].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(r),t)},c.reject=function(t){var e=new this(r);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,c=new this(r);++u<n;)h(t[u],u);return c;function h(t,r){e.resolve(t).then((function(t){s[r]=t,++a!==n||i||(i=!0,o.resolve(c,s))}),(function(t){i||(i=!0,o.reject(c,t))}))}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var s,a=-1,u=new this(r);++a<n;)s=t[a],e.resolve(s).then((function(t){i||(i=!0,o.resolve(u,t))}),(function(t){i||(i=!0,o.reject(u,t))}));return u}},{1:1}],3:[function(t,n,i){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var s=Promise;function a(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function c(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l=void 0,f={},d=Object.prototype.toString;function p(t){return"boolean"==typeof l?s.resolve(l):function(t){return new s((function(e){var n=t.transaction("local-forage-detect-blob-support","readwrite"),i=o([""]);n.objectStore("local-forage-detect-blob-support").put(i,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))}(t).then((function(t){return l=t}))}function v(t){var e=f[t.name],n={};n.promise=new s((function(t,e){n.resolve=t,n.reject=e})),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then((function(){return n.promise})):e.dbReady=n.promise}function g(t){var e=f[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function y(t,e){var n=f[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function m(t,e){return new s((function(n,i){if(f[t.name]=f[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);v(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var s=r.open.apply(r,o);e&&(s.onupgradeneeded=function(e){var n=s.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore("local-forage-detect-blob-support")}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),s.onerror=function(t){t.preventDefault(),i(s.error)},s.onsuccess=function(){n(s.result),g(t)}}))}function b(t){return m(t,!1)}function w(t){return m(t,!0)}function k(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,r=t.version>t.db.version;if(i&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function x(t){return o([function(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t.charCodeAt(r);return n}(atob(t.data))],{type:t.type})}function E(t){return t&&t.__local_forage_encoded_blob}function S(t){var e=this,n=e._initReady().then((function(){var t=f[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return u(n,t,t),n}function O(t,e,n,i){void 0===i&&(i=1);try{var r=t.db.transaction(t.storeName,e);n(null,r)}catch(r){if(i>0&&(!t.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return s.resolve().then((function(){if(!t.db||"NotFoundError"===r.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),w(t)})).then((function(){return function(t){v(t);for(var e=f[t.name],n=e.forages,i=0;i<n.length;i++){var r=n[i];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,b(t).then((function(e){return t.db=e,k(t)?w(t):e})).then((function(i){t.db=e.db=i;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=i})).catch((function(e){throw y(t,e),e}))}(t).then((function(){O(t,e,n,i-1)}))})).catch(n);n(r)}}var _={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]=t[i];var r=f[n.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=r),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=S);var o=[];function a(){return s.resolve()}for(var u=0;u<r.forages.length;u++){var c=r.forages[u];c!==e&&o.push(c._initReady().catch(a))}var h=r.forages.slice(0);return s.all(o).then((function(){return n.db=r.db,b(n)})).then((function(t){return n.db=t,k(n,e._defaultConfig.version)?w(n):t})).then((function(t){n.db=r.db=t,e._dbInfo=n;for(var i=0;i<h.length;i++){var o=h[i];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))},_support:function(){try{if(!r)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,"readonly",(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var i=n.value;E(i)&&(i=x(i));var r=t(i,n.key,a++);void 0!==r?e(r):n.continue()}else e()},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},getItem:function(t,e){var n=this;t=c(t);var i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,"readonly",(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),E(t)&&(t=x(t)),e(t)},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},setItem:function(t,e,n){var i=this;t=c(t);var r=new s((function(n,r){var o;i.ready().then((function(){return o=i._dbInfo,"[object Blob]"===d.call(e)?p(o.db).then((function(t){return t?e:(n=e,new s((function(t,e){var i=new FileReader;i.onerror=e,i.onloadend=function(e){var i=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:i,type:n.type})},i.readAsBinaryString(n)})));var n})):e})).then((function(e){O(i._dbInfo,"readwrite",(function(o,s){if(o)return r(o);try{var a=s.objectStore(i._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);s.oncomplete=function(){void 0===e&&(e=null),n(e)},s.onabort=s.onerror=function(){var t=u.error?u.error:u.transaction.error;r(t)}}catch(t){r(t)}}))})).catch(r)}));return a(r,n),r},removeItem:function(t,e){var n=this;t=c(t);var i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,"readwrite",(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){i(s.error)},o.onabort=function(){var t=s.error?s.error:s.transaction.error;i(t)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},clear:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,"readwrite",(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).clear();r.oncomplete=function(){t()},r.onabort=r.onerror=function(){var t=o.error?o.error:o.transaction.error;n(t)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},length:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,"readonly",(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},key:function(t,e){var n=this,i=new s((function(e,i){t<0?e(null):n.ready().then((function(){O(n._dbInfo,"readonly",(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,u=s.openCursor();u.onsuccess=function(){var n=u.result;n?0===t||a?e(n.key):(a=!0,n.advance(t)):e(null)},u.onerror=function(){i(u.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},keys:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,"readonly",(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).openCursor(),s=[];o.onsuccess=function(){var e=o.result;e?(s.push(e.key),e.continue()):t(s)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,o=this;if(t.name){var u=t.name===n.name&&o._dbInfo.db,c=u?s.resolve(o._dbInfo.db):b(t).then((function(e){var n=f[t.name],i=n.forages;n.db=e;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=e;return e}));i=t.storeName?c.then((function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;v(t);var i=f[t.name],o=i.forages;e.close();for(var a=0;a<o.length;a++){var u=o[a];u._dbInfo.db=null,u._dbInfo.version=n}return new s((function(e,i){var o=r.open(t.name,n);o.onerror=function(t){o.result.close(),i(t)},o.onupgradeneeded=function(){o.result.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}})).then((function(t){i.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,g(n._dbInfo)}})).catch((function(e){throw(y(t,e)||s.resolve()).catch((function(){})),e}))}})):c.then((function(e){v(t);var n=f[t.name],i=n.forages;e.close();for(var o=0;o<i.length;o++)i[o]._dbInfo.db=null;return new s((function(e,n){var i=r.deleteDatabase(t.name);i.onerror=i.onblocked=function(t){var e=i.result;e&&e.close(),n(t)},i.onsuccess=function(){var t=i.result;t&&t.close(),e(t)}})).then((function(t){n.db=t;for(var e=0;e<i.length;e++)g(i[e]._dbInfo)})).catch((function(e){throw(y(t,e)||s.resolve()).catch((function(){})),e}))}))}else i=s.reject("Invalid arguments");return a(i,e),i}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=/^~~local_forage_type~([^~]+)~/,R="__lfsc__:".length,j=R+"arbf".length,I=Object.prototype.toString;function L(t){var e,n,i,r,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var c=new ArrayBuffer(s),h=new Uint8Array(c);for(e=0;e<a;e+=4)n=C.indexOf(t[e]),i=C.indexOf(t[e+1]),r=C.indexOf(t[e+2]),o=C.indexOf(t[e+3]),h[u++]=n<<2|i>>4,h[u++]=(15&i)<<4|r>>2,h[u++]=(3&r)<<6|63&o;return c}function A(t){var e,n=new Uint8Array(t),i="";for(e=0;e<n.length;e+=3)i+=C[n[e]>>2],i+=C[(3&n[e])<<4|n[e+1]>>4],i+=C[(15&n[e+1])<<2|n[e+2]>>6],i+=C[63&n[e+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var N={serialize:function(t,e){var n="";if(t&&(n=I.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===I.call(t.buffer))){var i,r="__lfsc__:";t instanceof ArrayBuffer?(i=t,r+="arbf"):(i=t.buffer,"[object Int8Array]"===n?r+="si08":"[object Uint8Array]"===n?r+="ui08":"[object Uint8ClampedArray]"===n?r+="uic8":"[object Int16Array]"===n?r+="si16":"[object Uint16Array]"===n?r+="ur16":"[object Int32Array]"===n?r+="si32":"[object Uint32Array]"===n?r+="ui32":"[object Float32Array]"===n?r+="fl32":"[object Float64Array]"===n?r+="fl64":e(new Error("Failed to get type for BinaryArray"))),e(r+A(i))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+t.type+"~"+A(this.result);e("__lfsc__:blob"+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if("__lfsc__:"!==t.substring(0,R))return JSON.parse(t);var e,n=t.substring(j),i=t.substring(R,j);if("blob"===i&&T.test(n)){var r=n.match(T);e=r[1],n=n.substring(r[0].length)}var s=L(n);switch(i){case"arbf":return s;case"blob":return o([s],{type:e});case"si08":return new Int8Array(s);case"ui08":return new Uint8Array(s);case"uic8":return new Uint8ClampedArray(s);case"si16":return new Int16Array(s);case"ur16":return new Uint16Array(s);case"si32":return new Int32Array(s);case"ui32":return new Uint32Array(s);case"fl32":return new Float32Array(s);case"fl64":return new Float64Array(s);default:throw new Error("Unkown type: "+i)}},stringToBuffer:L,bufferToString:A};function P(t,e,n,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function D(t,e,n,i,r,o){t.executeSql(n,i,r,(function(t,s){s.code===s.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,a){a.rows.length?o(t,s):P(t,e,(function(){t.executeSql(n,i,r,o)}),o)}),o):o(t,s)}),o)}function z(t,e,n,i){var r=this;t=c(t);var o=new s((function(o,s){r.ready().then((function(){void 0===e&&(e=null);var a=e,u=r._dbInfo;u.serializer.serialize(e,(function(e,c){c?s(c):u.db.transaction((function(n){D(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){o(a)}),(function(t,e){s(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(i>0)return void o(z.apply(r,[t,a,n,i-1]));s(e)}}))}))})).catch(s)}));return a(o,n),o}function B(t){return new s((function(e,n){t.transaction((function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,i){for(var r=[],o=0;o<i.rows.length;o++)r.push(i.rows.item(o).name);e({db:t,storeNames:r})}),(function(t,e){n(e)}))}),(function(t){n(t)}))}))}var M={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]="string"!=typeof t[i]?t[i].toString():t[i];var r=new s((function(t,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return i(t)}n.db.transaction((function(r){P(r,n,(function(){e._dbInfo=n,t()}),(function(t,e){i(e)}))}),i)}));return n.serializer=N,r},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){D(n,r,"SELECT * FROM "+r.storeName,[],(function(n,i){for(var o=i.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),c=u.value;if(c&&(c=r.serializer.deserialize(c)),void 0!==(c=t(c,u.key,a+1)))return void e(c)}e()}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},getItem:function(t,e){var n=this;t=c(t);var i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){D(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=r.serializer.deserialize(i)),e(i)}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},setItem:function(t,e,n){return z.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=c(t);var i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){D(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},clear:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){D(e,i,"DELETE FROM "+i.storeName,[],(function(){t()}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},length:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){D(e,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],(function(e,n){var i=n.rows.item(0).c;t(i)}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},key:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){D(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,n){var i=n.rows.length?n.rows.item(0).key:null;e(i)}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},keys:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){D(e,i,"SELECT key FROM "+i.storeName,[],(function(e,n){for(var i=[],r=0;r<n.rows.length;r++)i.push(n.rows.item(r).key);t(i)}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,r=this;return a(i=t.name?new s((function(e){var i;i=t.name===n.name?r._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:i,storeNames:[t.storeName]}):e(B(i))})).then((function(t){return new s((function(e,n){t.db.transaction((function(i){function r(t){return new s((function(e,n){i.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){n(e)}))}))}for(var o=[],a=0,u=t.storeNames.length;a<u;a++)o.push(r(t.storeNames[a]));s.all(o).then((function(){e()})).catch((function(t){n(t)}))}),(function(t){n(t)}))}))})):s.reject("Invalid arguments"),e),i}};function q(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function U(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var F={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=q(t,this._defaultConfig),U()?(this._dbInfo=e,e.serializer=N,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=n.ready().then((function(){for(var e=n._dbInfo,i=e.keyPrefix,r=i.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(i)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),void 0!==(c=t(c,u.substring(r),s++)))return c}}}));return a(i,e),i},getItem:function(t,e){var n=this;t=c(t);var i=n.ready().then((function(){var e=n._dbInfo,i=localStorage.getItem(e.keyPrefix+t);return i&&(i=e.serializer.deserialize(i)),i}));return a(i,e),i},setItem:function(t,e,n){var i=this;t=c(t);var r=i.ready().then((function(){void 0===e&&(e=null);var n=e;return new s((function(r,o){var s=i._dbInfo;s.serializer.serialize(e,(function(e,i){if(i)o(i);else try{localStorage.setItem(s.keyPrefix+t,e),r(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}}))}))}));return a(r,n),r},removeItem:function(t,e){var n=this;t=c(t);var i=n.ready().then((function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return a(i,e),i},clear:function(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(t)&&localStorage.removeItem(i)}}));return a(n,t),n},length:function(t){var e=this.keys().then((function(t){return t.length}));return a(e,t),e},key:function(t,e){var n=this,i=n.ready().then((function(){var e,i=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e}));return a(i,e),i},keys:function(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo,n=localStorage.length,i=[],r=0;r<n;r++){var o=localStorage.key(r);0===o.indexOf(t.keyPrefix)&&i.push(o.substring(t.keyPrefix.length))}return i}));return a(n,t),n},dropInstance:function(t,e){if(e=h.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var i,r=this;return a(i=t.name?new s((function(e){t.storeName?e(q(t,r._defaultConfig)):e(t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),e),i}},W=function(t,e){for(var n,i,r=t.length,o=0;o<r;){if((n=t[o])===(i=e)||"number"==typeof n&&"number"==typeof i&&isNaN(n)&&isNaN(i))return!0;o++}return!1},H=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},V={},X={},G={INDEXEDDB:_,WEBSQL:M,LOCALSTORAGE:F},Y=[G.INDEXEDDB._driver,G.WEBSQL._driver,G.LOCALSTORAGE._driver],K=["dropInstance"],$=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(K),Z={description:"",driver:Y.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function J(t,e){t[e]=function(){var n=arguments;return t.ready().then((function(){return t[e].apply(t,n)}))}}function Q(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(H(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var tt=new(function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),G)if(G.hasOwnProperty(n)){var i=G[n],r=i._driver;this[n]=r,V[r]||this.defineDriver(i)}this._defaultConfig=Q({},Z),this._config=Q({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":i(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var i=new s((function(e,n){try{var i=t._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(r);for(var o=$.concat("_initStorage"),u=0,c=o.length;u<c;u++){var h=o[u];if((!W(K,h)||t[h])&&"function"!=typeof t[h])return void n(r)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=s.reject(e);return a(n,arguments[arguments.length-1]),n}},n=0,i=K.length;n<i;n++){var r=K[n];t[r]||(t[r]=e(r))}}();var l=function(n){V[i]&&console.info("Redefining LocalForage driver: "+i),V[i]=t,X[i]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(l,n):l(!!t._support):l(!0)}catch(t){n(t)}}));return u(i,e,n),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var i=V[t]?s.resolve(V[t]):s.reject(new Error("Driver not found."));return u(i,e,n),i},t.prototype.getSerializer=function(t){var e=s.resolve(N);return u(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return u(n,t,t),n},t.prototype.setDriver=function(t,e,n){var i=this;H(t)||(t=[t]);var r=this._getSupportedDrivers(t);function o(){i._config.driver=i.driver()}function a(t){return i._extend(t),o(),i._ready=i._initStorage(i._config),i._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=c.then((function(){var t=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then((function(t){i._driver=t._driver,o(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var r=t[e];return e++,i._dbInfo=null,i._ready=null,i.getDriver(r).then(a).catch(n)}o();var u=new Error("No available storage method found.");return i._driverSet=s.reject(u),i._driverSet}()}}(r)}))})).catch((function(){o();var t=new Error("No available storage method found.");return i._driverSet=s.reject(t),i._driverSet})),u(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!X[t]},t.prototype._extend=function(t){Q(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];this.supports(r)&&e.push(r)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=$.length;t<e;t++)J(this,$[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=tt},{3:3}]},{},[4])(4)}).call(this,n(70))},function(t,e,n){"use strict";n(52),n(14),n(15),n(161),n(10),n(29),n(16),n(31),n(19),n(61),n(23);var i=n(12),r=n.n(i),o=n(0),s=n(20),a=n(17),u=(n(7),n(85),n(39),n(11),n(2)),c=n(24),h=(n(149),n(198),n(36),n(30));n(48);var l=function(t,e,n,i){var r,s="undefined"!=typeof window&&window.URL,u=s?"blob":"arraybuffer",c=new o.defer,h=new XMLHttpRequest,l=XMLHttpRequest.prototype;for(r in"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),n&&(h.withCredentials=!0),h.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var t=!1;if(""!==this.responseType&&"document"!==this.responseType||(t=this.responseXML),200===this.status||0===this.status||t){var n;if(!this.response&&!t)return c.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),c.promise;if(403===this.status)return c.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),c.promise;n=t?this.responseXML:Object(o.isXml)(e)?Object(o.parse)(this.response,"text/xml"):"xhtml"==e?Object(o.parse)(this.response,"application/xhtml+xml"):"html"==e||"htm"==e?Object(o.parse)(this.response,"text/html"):"json"==e?JSON.parse(this.response):"blob"==e?s?this.response:new Blob([this.response]):this.response,c.resolve(n)}else c.reject({status:this.status,message:this.response,stack:(new Error).stack})}},h.onerror=function(t){c.reject(t)},h.open("GET",t,!0),i)h.setRequestHeader(r,i[r]);return"json"==e&&h.setRequestHeader("Accept","application/json"),e||(e=new a.a(t).extension),"blob"==e&&(h.responseType=u),Object(o.isXml)(e)&&h.overrideMimeType("text/xml"),"binary"==e&&(h.responseType="arraybuffer"),h.send(),c.promise},f=n(87);function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var p=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,n?this.hooks=n:(this.hooks={},this.hooks.serialize=new c.a(this),this.hooks.content=new c.a(this)),this.document=void 0,this.contents=void 0,this.output=void 0}var e,n,i;return e=t,(n=[{key:"load",value:function(t){var e=t||this.request||l,n=new o.defer,i=n.promise;return this.contents?n.resolve(this.contents):e(this.url).then(function(t){return this.document=t,this.contents=t.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch((function(t){n.reject(t)})),i}},{key:"base",value:function(){return Object(h.a)(this.document,this)}},{key:"render",value:function(t){var e=new o.defer,n=e.promise;return this.output,this.load(t).then(function(t){var e=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0,n=new("undefined"==typeof XMLSerializer||e?f.XMLDOMParser:XMLSerializer);return this.output=n.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){e.resolve(this.output)}.bind(this)).catch((function(t){e.reject(t)})),n}},{key:"find",value:function(t){var e=this,n=[],i=t.toLowerCase(),r=function(t){for(var r,o,s,a=t.textContent.toLowerCase(),u=e.document.createRange(),c=-1;-1!=o;)-1!=(o=a.indexOf(i,c+1))&&((u=e.document.createRange()).setStart(t,o),u.setEnd(t,o+i.length),r=e.cfiFromRange(u),s=t.textContent.length<150?t.textContent:"..."+(s=t.textContent.substring(o-75,o+75))+"...",n.push({cfi:r,excerpt:s})),c=o};return Object(o.sprint)(e.document,(function(t){r(t)})),n}},{key:"search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(void 0===document.createTreeWalker)return this.find(t);for(var n,i=[],r=150,o=this,s=t.toLowerCase(),a=function(t){var e=t.reduce((function(t,e){return t+e.textContent}),"").toLowerCase().indexOf(s);if(-1!=e){var n=e+s.length,a=0,u=0;if(e<t[0].length){for(var c;a<t.length-1&&!(n<=(u+=t[a].length));)a+=1;var h=t[0],l=t[a],f=o.document.createRange();f.setStart(h,e);var d=t.slice(0,a).reduce((function(t,e){return t+e.textContent.length}),0);f.setEnd(l,d>n?n:n-d),c=o.cfiFromRange(f);var p=t.slice(0,a+1).reduce((function(t,e){return t+e.textContent}),"");p.length>r&&(p="..."+(p=p.substring(e-r/2,e+r/2))+"..."),i.push({cfi:c,excerpt:p})}}},u=document.createTreeWalker(o.document,NodeFilter.SHOW_TEXT,null,!1),c=[];n=u.nextNode();)c.push(n),c.length==e&&(a(c.slice(0,e)),c=c.slice(1,e));return c.length>0&&a(c),i}},{key:"reconcileLayoutSettings",value:function(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach((function(t){var n,i,r=t.replace("rendition:",""),o=r.indexOf("-");-1!=o&&(n=r.slice(0,o),i=r.slice(o+1),e[n]=i)})),e}},{key:"cfiFromRange",value:function(t){return new u.a(t,this.cfiBase).toString()}},{key:"cfiFromElement",value:function(t){return new u.a(t,this.cfiBase).toString()}},{key:"unload",value:function(){this.document=void 0,this.contents=void 0,this.output=void 0}},{key:"destroy",value:function(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}])&&d(e.prototype,n),i&&d(e,i),t}();function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new c.a,this.hooks.content=new c.a,this.hooks.content.register(h.a),this.hooks.content.register(h.b),this.hooks.content.register(h.d),this.epubcfi=new u.a,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}var e,n,i;return e=t,(n=[{key:"unpack",value:function(t,e,n){var i=this;this.items=t.spine,this.manifest=t.manifest,this.spineNodeIndex=t.spineNodeIndex,this.baseUrl=t.baseUrl||t.basePath||"",this.length=this.items.length,this.items.forEach((function(t,r){var o,s=i.manifest[t.idref];t.index=r,t.cfiBase=i.epubcfi.generateChapterComponent(i.spineNodeIndex,t.index,t.idref),t.href&&(t.url=e(t.href,!0),t.canonical=n(t.href)),s&&(t.href=s.href,t.url=e(t.href,!0),t.canonical=n(t.href),s.properties.length&&t.properties.push.apply(t.properties,s.properties)),"yes"===t.linear?(t.prev=function(){for(var e=t.index;e>0;){var n=this.get(e-1);if(n&&n.linear)return n;e-=1}}.bind(i),t.next=function(){for(var e=t.index;e<this.spineItems.length-1;){var n=this.get(e+1);if(n&&n.linear)return n;e+=1}}.bind(i)):(t.prev=function(){},t.next=function(){}),o=new p(t,i.hooks),i.append(o)})),this.loaded=!0}},{key:"get",value:function(t){var e=0;if(void 0===t)for(;e<this.spineItems.length;){var n=this.spineItems[e];if(n&&n.linear)break;e+=1}else this.epubcfi.isCfiString(t)?e=new u.a(t).spinePos:"number"==typeof t||!1===isNaN(t)?e=t:"string"==typeof t&&0===t.indexOf("#")?e=this.spineById[t.substring(1)]:"string"==typeof t&&(t=t.split("#")[0],e=this.spineByHref[t]||this.spineByHref[encodeURI(t)]);return this.spineItems[e]||null}},{key:"append",value:function(t){var e=this.spineItems.length;return t.index=e,this.spineItems.push(t),this.spineByHref[decodeURI(t.href)]=e,this.spineByHref[encodeURI(t.href)]=e,this.spineByHref[t.href]=e,this.spineById[t.idref]=e,e}},{key:"prepend",value:function(t){return this.spineByHref[t.href]=0,this.spineById[t.idref]=0,this.spineItems.forEach((function(t,e){t.index=e})),0}},{key:"remove",value:function(t){var e=this.spineItems.indexOf(t);if(e>-1)return delete this.spineByHref[t.href],delete this.spineById[t.idref],this.spineItems.splice(e,1)}},{key:"each",value:function(){return this.spineItems.forEach.apply(this.spineItems,arguments)}},{key:"first",value:function(){var t=0;do{var e=this.get(t);if(e&&e.linear)return e;t+=1}while(t<this.spineItems.length)}},{key:"last",value:function(){var t=this.spineItems.length-1;do{var e=this.get(t);if(e&&e.linear)return e;t-=1}while(t>=0)}},{key:"destroy",value:function(){this.each((function(t){return t.destroy()})),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}])&&v(e.prototype,n),i&&v(e,i),t}(),y=(n(86),n(49)),m=n(1);function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var w=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spine=e,this.request=n,this.pause=i||100,this.q=new y.a(this),this.epubcfi=new u.a,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}var e,n,i;return e=t,(n=[{key:"generate",value:function(t){return t&&(this.break=t),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}},{key:"createRange",value:function(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}},{key:"process",value:function(t){return t.load(this.request).then(function(e){var n=new o.defer,i=this.parse(e,t.cfiBase);return this._locations=this._locations.concat(i),t.unload(),this.processingTimeout=setTimeout((function(){return n.resolve(i)}),this.pause),n.promise}.bind(this))}},{key:"parse",value:function(t,e,n){var i,r,s=[],a=t.ownerDocument,c=Object(o.qs)(a,"body"),h=0,l=n||this.break;if(Object(o.sprint)(c,function(t){var n,o=t.length,a=0;if(0===t.textContent.trim().length)return!1;for(0==h&&((i=this.createRange()).startContainer=t,i.startOffset=0),(n=l-h)>o&&(h+=o,a=o);a<o;)if(n=l-h,0===h&&(a+=1,(i=this.createRange()).startContainer=t,i.startOffset=a),a+n>=o)h+=o-a,a=o;else{a+=n,i.endContainer=t,i.endOffset=a;var c=new u.a(i,e).toString();s.push(c),h=0}r=t}.bind(this)),i&&i.startContainer&&r){i.endContainer=r,i.endOffset=r.length;var f=new u.a(i,e).toString();s.push(f),h=0}return s}},{key:"generateFromWords",value:function(t,e,n){var i=t?new u.a(t):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(t){t.linear&&(i?t.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),t,e,i,n):this.q.enqueue(this.processWords.bind(this),t,e,i,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}},{key:"processWords",value:function(t,e,n,i){return i&&this._locationsWords.length>=i?Promise.resolve():t.load(this.request).then(function(r){var s=new o.defer,a=this.parseWords(r,t,e,n),u=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(a.length>=i?a.slice(0,u):a),t.unload(),this.processingTimeout=setTimeout((function(){return s.resolve(a)}),this.pause),s.promise}.bind(this))}},{key:"countWords",value:function(t){return(t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length}},{key:"parseWords",value:function(t,e,n,i){var r,s=e.cfiBase,a=[],c=t.ownerDocument,h=Object(o.qs)(c,"body"),l=n,f=!i||i.spinePos!==e.index;return i&&e.index===i.spinePos&&(r=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,t.ownerDocument)),Object(o.sprint)(h,function(t){if(!f){if(t!==r)return!1;f=!0}if(t.textContent.length<10&&0===t.textContent.trim().length)return!1;var e,n=this.countWords(t.textContent),i=0;if(0===n)return!1;for((e=l-this._wordCounter)>n&&(this._wordCounter+=n,i=n);i<n;)if(i+(e=l-this._wordCounter)>=n)this._wordCounter+=n-i,i=n;else{i+=e;var o=new u.a(t,s);a.push({cfi:o.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}.bind(this)),a}},{key:"locationFromCfi",value:function(t){var e;return u.a.prototype.isCfiString(t)&&(t=new u.a(t)),0===this._locations.length?-1:(e=Object(o.locationOf)(t,this._locations,this.epubcfi.compare))>this.total?this.total:e}},{key:"percentageFromCfi",value:function(t){if(0===this._locations.length)return null;var e=this.locationFromCfi(t);return this.percentageFromLocation(e)}},{key:"percentageFromLocation",value:function(t){return t&&this.total?t/this.total:0}},{key:"cfiFromLocation",value:function(t){var e=-1;return"number"!=typeof t&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(e=this._locations[t]),e}},{key:"cfiFromPercentage",value:function(t){var e;if(t>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),t>=1){var n=new u.a(this._locations[this.total]);return n.collapse(),n.toString()}return e=Math.ceil(this.total*t),this.cfiFromLocation(e)}},{key:"load",value:function(t){return this._locations="string"==typeof t?JSON.parse(t):t,this.total=this._locations.length-1,this._locations}},{key:"save",value:function(){return JSON.stringify(this._locations)}},{key:"getCurrent",value:function(){return this._current}},{key:"setCurrent",value:function(t){var e;if("string"==typeof t)this._currentCfi=t;else{if("number"!=typeof t)return;this._current=t}0!==this._locations.length&&("string"==typeof t?(e=this.locationFromCfi(t),this._current=e):e=t,this.emit(m.c.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(e)}))}},{key:"length",value:function(){return this._locations.length}},{key:"destroy",value:function(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}},{key:"currentLocation",get:function(){return this._current},set:function(t){this.setCurrent(t)}}])&&b(e.prototype,n),i&&b(e,i),t}();r()(w.prototype);var k=w,x=n(26),E=n.n(x);function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){var e;if(!t)throw new Error("Container File Not Found");if(!(e=Object(o.qs)(t,"rootfile")))throw new Error("No RootFile Found");this.packagePath=e.getAttribute("full-path"),this.directory=E.a.dirname(this.packagePath),this.encoding=t.xmlEncoding}},{key:"destroy",value:function(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}])&&S(e.prototype,n),i&&S(e,i),t}();n(40);function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){var e,n,i;if(!t)throw new Error("Package File Not Found");if(!(e=Object(o.qs)(t,"metadata")))throw new Error("No Metadata Found");if(!(n=Object(o.qs)(t,"manifest")))throw new Error("No Manifest Found");if(!(i=Object(o.qs)(t,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,i),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=Object(o.indexOfElementNode)(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(e),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}},{key:"parseMetadata",value:function(t){var e={};return e.title=this.getElementText(t,"title"),e.creator=this.getElementText(t,"creator"),e.description=this.getElementText(t,"description"),e.pubdate=this.getElementText(t,"date"),e.publisher=this.getElementText(t,"publisher"),e.identifier=this.getElementText(t,"identifier"),e.language=this.getElementText(t,"language"),e.rights=this.getElementText(t,"rights"),e.modified_date=this.getPropertyText(t,"dcterms:modified"),e.layout=this.getPropertyText(t,"rendition:layout"),e.orientation=this.getPropertyText(t,"rendition:orientation"),e.flow=this.getPropertyText(t,"rendition:flow"),e.viewport=this.getPropertyText(t,"rendition:viewport"),e.media_active_class=this.getPropertyText(t,"media:active-class"),e.spread=this.getPropertyText(t,"rendition:spread"),e}},{key:"parseManifest",value:function(t){var e={},n=Object(o.qsa)(t,"item");return Array.prototype.slice.call(n).forEach((function(t){var n=t.getAttribute("id"),i=t.getAttribute("href")||"",r=t.getAttribute("media-type")||"",o=t.getAttribute("media-overlay")||"",s=t.getAttribute("properties")||"";e[n]={href:i,type:r,overlay:o,properties:s.length?s.split(" "):[]}})),e}},{key:"parseSpine",value:function(t,e){var n=[],i=Object(o.qsa)(t,"itemref");return Array.prototype.slice.call(i).forEach((function(t,e){var i=t.getAttribute("idref"),r=t.getAttribute("properties")||"",o=r.length?r.split(" "):[],s={idref:i,linear:t.getAttribute("linear")||"yes",properties:o,index:e};n.push(s)})),n}},{key:"findUniqueIdentifier",value:function(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e)return"";var n=t.getElementById(e);return n&&"identifier"===n.localName&&"http://purl.org/dc/elements/1.1/"===n.namespaceURI&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}},{key:"findNavPath",value:function(t){var e=Object(o.qsp)(t,"item",{properties:"nav"});return!!e&&e.getAttribute("href")}},{key:"findNcxPath",value:function(t,e){var n,i=Object(o.qsp)(t,"item",{"media-type":"application/x-dtbncx+xml"});return i||(n=e.getAttribute("toc"))&&(i=t.querySelector("#".concat(n))),!!i&&i.getAttribute("href")}},{key:"findCoverPath",value:function(t){Object(o.qs)(t,"package").getAttribute("version");var e=Object(o.qsp)(t,"item",{properties:"cover-image"});if(e)return e.getAttribute("href");var n=Object(o.qsp)(t,"meta",{name:"cover"});if(n){var i=n.getAttribute("content"),r=t.getElementById(i);return r?r.getAttribute("href"):""}return!1}},{key:"getElementText",value:function(t,e){var n,i=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e);return i&&0!==i.length&&(n=i[0]).childNodes.length?n.childNodes[0].nodeValue:""}},{key:"getPropertyText",value:function(t,e){var n=Object(o.qsp)(t,"meta",{property:e});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}},{key:"load",value:function(t){var e=this;this.metadata=t.metadata;var n=t.readingOrder||t.spine;return this.spine=n.map((function(t,e){return t.index=e,t.linear=t.linear||"yes",t})),t.resources.forEach((function(t,n){e.manifest[n]=t,t.rel&&"cover"===t.rel[0]&&(e.coverPath=t.href)})),this.spineNodeIndex=0,this.toc=t.toc.map((function(t,e){return t.label=t.title,t})),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}},{key:"destroy",value:function(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}])&&_(e.prototype,n),i&&_(e,i),t}();function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var R=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){var e,n,i=t.nodeType;i&&(e=Object(o.qs)(t,"html"),n=Object(o.qs)(t,"ncx")),i?e?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):n&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc)}},{key:"unpack",value:function(t){for(var e,n=0;n<t.length;n++)(e=t[n]).href&&(this.tocByHref[e.href]=n),e.id&&(this.tocById[e.id]=n),this.length++,e.subitems.length&&this.unpack(e.subitems)}},{key:"get",value:function(t){var e;return t?(0===t.indexOf("#")?e=this.tocById[t.substring(1)]:t in this.tocByHref&&(e=this.tocByHref[t]),this.getByIndex(t,e,this.toc)):this.toc}},{key:"getByIndex",value:function(t,e,n){if(0!==n.length){var i=n[e];if(!i||t!==i.id&&t!==i.href){for(var r,o=0;o<n.length&&!(r=this.getByIndex(t,e,n[o].subitems));++o);return r}return i}}},{key:"landmark",value:function(t){var e;return t?(e=this.landmarksByType[t],this.landmarks[e]):this.landmarks}},{key:"parseNav",value:function(t){var e,n,i=Object(o.querySelectorByType)(t,"nav","toc"),r=i?Object(o.qsa)(i,"li"):[],s=r.length,a={},u=[];if(!r||0===s)return u;for(e=0;e<s;++e)(n=this.navItem(r[e]))&&(a[n.id]=n,n.parent?a[n.parent].subitems.push(n):u.push(n));return u}},{key:"navItem",value:function(t){var e=t.getAttribute("id")||void 0,n=Object(o.filterChildren)(t,"a",!0);if(n){var i=n.getAttribute("href")||"";e||(e=i);var r,s=n.textContent||"",a=Object(o.getParentByTagName)(t,"li");if(a&&!(r=a.getAttribute("id"))){var u=Object(o.filterChildren)(a,"a",!0);r=u&&u.getAttribute("href")}for(;!r&&a;)if((a=Object(o.getParentByTagName)(a,"li"))&&!(r=a.getAttribute("id"))){var c=Object(o.filterChildren)(a,"a",!0);r=c&&c.getAttribute("href")}return{id:e,href:i,label:s,subitems:[],parent:r}}}},{key:"parseLandmarks",value:function(t){var e,n,i=Object(o.querySelectorByType)(t,"nav","landmarks"),r=i?Object(o.qsa)(i,"li"):[],s=r.length,a=[];if(!r||0===s)return a;for(e=0;e<s;++e)(n=this.landmarkItem(r[e]))&&(a.push(n),this.landmarksByType[n.type]=e);return a}},{key:"landmarkItem",value:function(t){var e=Object(o.filterChildren)(t,"a",!0);if(e){var n=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:e.getAttribute("href")||"",label:e.textContent||"",type:n}}}},{key:"parseNcx",value:function(t){var e,n,i=Object(o.qsa)(t,"navPoint"),r=i.length,s={},a=[];if(!i||0===r)return a;for(e=0;e<r;++e)s[(n=this.ncxItem(i[e])).id]=n,n.parent?s[n.parent].subitems.push(n):a.push(n);return a}},{key:"ncxItem",value:function(t){var e,n=t.getAttribute("id")||!1,i=Object(o.qs)(t,"content").getAttribute("src"),r=Object(o.qs)(t,"navLabel"),s=r.textContent?r.textContent:"",a=t.parentNode;return!a||"navPoint"!==a.nodeName&&"navPoint"!==a.nodeName.split(":").slice(-1)[0]||(e=a.getAttribute("id")),{id:n,href:i,label:s,subitems:[],parent:e}}},{key:"load",value:function(t){var e=this;return t.map((function(t){return t.label=t.title,t.subitems=t.children?e.load(t.children):[],t}))}},{key:"forEach",value:function(t){return this.toc.forEach(t)}}])&&T(e.prototype,n),i&&T(e,i),t}(),j=(n(62),n(67),{application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}}),I=function(){var t,e,n,i,r={};for(t in j)if(j.hasOwnProperty(t))for(e in j[t])if(j[t].hasOwnProperty(e))if("string"==typeof(n=j[t][e]))r[n]=t+"/"+e;else for(i=0;i<n.length;i++)r[n[i]]=t+"/"+e;return r}();var L={lookup:function(t){return t&&I[t.split(".").pop().toLowerCase()]||"text/plain"}};function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var N=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings={replacements:n&&n.replacements||"base64",archive:n&&n.archive,resolver:n&&n.resolver,request:n&&n.request},this.process(e)}var e,n,i;return e=t,(n=[{key:"process",value:function(t){this.manifest=t,this.resources=Object.keys(t).map((function(e){return t[e]})),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}},{key:"split",value:function(){this.html=this.resources.filter((function(t){if("application/xhtml+xml"===t.type||"text/html"===t.type)return!0})),this.assets=this.resources.filter((function(t){if("application/xhtml+xml"!==t.type&&"text/html"!==t.type)return!0})),this.css=this.resources.filter((function(t){if("text/css"===t.type)return!0}))}},{key:"splitUrls",value:function(){this.urls=this.assets.map(function(t){return t.href}.bind(this)),this.cssUrls=this.css.map((function(t){return t.href}))}},{key:"createUrl",value:function(t){var e=new s.a(t),n=L.lookup(e.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(t,"blob").then((function(t){return Object(o.blob2base64)(t)})).then((function(t){return Object(o.createBase64Url)(t,n)})):this.settings.request(t,"blob").then((function(t){return Object(o.createBlobUrl)(t,n)}))}},{key:"replacements",value:function(){var t=this;if("none"===this.settings.replacements)return new Promise(function(t){t(this.urls)}.bind(this));var e=this.urls.map((function(e){var n=t.settings.resolver(e);return t.createUrl(n).catch((function(t){return console.error(t),null}))}));return Promise.all(e).then((function(e){return t.replacementUrls=e.filter((function(t){return"string"==typeof t})),e}))}},{key:"replaceCss",value:function(t,e){var n=[];return t=t||this.settings.archive,e=e||this.settings.resolver,this.cssUrls.forEach(function(i){var r=this.createCssFile(i,t,e).then(function(t){var e=this.urls.indexOf(i);e>-1&&(this.replacementUrls[e]=t)}.bind(this));n.push(r)}.bind(this)),Promise.all(n)}},{key:"createCssFile",value:function(t){var e=this;if(E.a.isAbsolute(t))return new Promise((function(t){t()}));var n,i=this.settings.resolver(t);n=this.settings.archive?this.settings.archive.getText(i):this.settings.request(i,"text");var r=this.urls.map((function(t){var n=e.settings.resolver(t);return new a.a(i).relative(n)}));return n?n.then((function(t){return t=Object(h.e)(t,r,e.replacementUrls),"base64"===e.settings.replacements?Object(o.createBase64Url)(t,"text/css"):Object(o.createBlobUrl)(t,"text/css")}),(function(t){return new Promise((function(t){t()}))})):new Promise((function(t){t()}))}},{key:"relativeTo",value:function(t,e){return e=e||this.settings.resolver,this.urls.map(function(n){var i=e(n);return new a.a(t).relative(i)}.bind(this))}},{key:"get",value:function(t){var e=this.urls.indexOf(t);if(-1!==e)return this.replacementUrls.length?new Promise(function(t,n){t(this.replacementUrls[e])}.bind(this)):this.createUrl(t)}},{key:"substitute",value:function(t,e){var n;return n=e?this.relativeTo(e):this.urls,Object(h.e)(t,n,this.replacementUrls)}},{key:"destroy",value:function(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}])&&A(e.prototype,n),i&&A(e,i),t}();function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var D=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pages=[],this.locations=[],this.epubcfi=new u.a,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){var e=Object(o.qs)(t,"html"),n=Object(o.qs)(t,"ncx");return e?this.parseNav(t):n?this.parseNcx(t):void 0}},{key:"parseNav",value:function(t){var e,n,i=Object(o.querySelectorByType)(t,"nav","page-list"),r=i?Object(o.qsa)(i,"li"):[],s=r.length,a=[];if(!r||0===s)return a;for(e=0;e<s;++e)n=this.item(r[e]),a.push(n);return a}},{key:"parseNcx",value:function(t){var e,n,i,r,s=[],a=0;if(!(n=Object(o.qs)(t,"pageList")))return s;if(r=(i=Object(o.qsa)(n,"pageTarget")).length,!i||0===i.length)return s;for(a=0;a<r;++a)e=this.ncxItem(i[a]),s.push(e);return s}},{key:"ncxItem",value:function(t){var e=Object(o.qs)(t,"navLabel"),n=Object(o.qs)(e,"text").textContent;return{href:Object(o.qs)(t,"content").getAttribute("src"),page:parseInt(n,10)}}},{key:"item",value:function(t){var e,n,i=Object(o.qs)(t,"a"),r=i.getAttribute("href")||"",s=i.textContent||"",a=parseInt(s);return-1!=r.indexOf("epubcfi")?(n=(e=r.split("#"))[0],{cfi:e.length>1&&e[1],href:r,packageUrl:n,page:a}):{href:r,page:a}}},{key:"process",value:function(t){t.forEach((function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)}),this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}},{key:"pageFromCfi",value:function(t){var e=-1;if(0===this.locations.length)return-1;var n=Object(o.indexOfSorted)(t,this.locations,this.epubcfi.compare);return-1!=n?e=this.pages[n]:void 0!==(e=(n=Object(o.locationOf)(t,this.locations,this.epubcfi.compare))-1>=0?this.pages[n-1]:this.pages[0])||(e=-1),e}},{key:"cfiFromPage",value:function(t){var e=-1;"number"!=typeof t&&(t=parseInt(t));var n=this.pages.indexOf(t);return-1!=n&&(e=this.locations[n]),e}},{key:"pageFromPercentage",value:function(t){return Math.round(this.totalPages*t)}},{key:"percentageFromPage",value:function(t){var e=(t-this.firstPage)/this.totalPages;return Math.round(1e3*e)/1e3}},{key:"percentageFromCfi",value:function(t){var e=this.pageFromCfi(t);return this.percentageFromPage(e)}},{key:"destroy",value:function(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}])&&P(e.prototype,n),i&&P(e,i),t}(),z=n(88),B=(n(41),n(156)),M=n.n(B);function q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.zip=void 0,this.urlCache={},this.checkRequirements()}var e,n,i;return e=t,(n=[{key:"checkRequirements",value:function(){try{this.zip=new M.a}catch(t){throw new Error("JSZip lib not loaded")}}},{key:"open",value:function(t,e){return this.zip.loadAsync(t,{base64:e})}},{key:"openUrl",value:function(t,e){return l(t,"binary").then(function(t){return this.zip.loadAsync(t,{base64:e})}.bind(this))}},{key:"request",value:function(t,e){var n,i=new o.defer,r=new a.a(t);return e||(e=r.extension),(n="blob"==e?this.getBlob(t):this.getText(t))?n.then(function(t){var n=this.handleResponse(t,e);i.resolve(n)}.bind(this)):i.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),i.promise}},{key:"handleResponse",value:function(t,e){return"json"==e?JSON.parse(t):Object(o.isXml)(e)?Object(o.parse)(t,"text/xml"):"xhtml"==e?Object(o.parse)(t,"application/xhtml+xml"):"html"==e||"htm"==e?Object(o.parse)(t,"text/html"):t}},{key:"getBlob",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return e=e||L.lookup(i.name),i.async("uint8array").then((function(t){return new Blob([t],{type:e})}))}},{key:"getText",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then((function(t){return t}))}},{key:"getBase64",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return e=e||L.lookup(i.name),i.async("base64").then((function(t){return"data:"+e+";base64,"+t}))}},{key:"createUrl",value:function(t,e){var n,i,r=new o.defer,s=window.URL||window.webkitURL||window.mozURL,a=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(a?(i=this.getBase64(t))&&i.then(function(e){this.urlCache[t]=e,r.resolve(e)}.bind(this)):(i=this.getBlob(t))&&i.then(function(e){n=s.createObjectURL(e),this.urlCache[t]=n,r.resolve(n)}.bind(this)),i||r.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),r.promise)}},{key:"revokeUrl",value:function(t){var e=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[t];n&&e.revokeObjectURL(n)}},{key:"destroy",value:function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache)t.revokeObjectURL(e);this.zip=void 0,this.urlCache={}}}])&&q(e.prototype,n),i&&q(e,i),t}(),F=n(115),W=n.n(F);function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var V=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.urlCache={},this.storage=void 0,this.name=e,this.requester=n||l,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}var e,n,i;return e=t,(n=[{key:"checkRequirements",value:function(){try{var t;void 0===W.a&&(t=W.a),this.storage=t.createInstance({name:this.name})}catch(t){throw new Error("localForage lib not loaded")}}},{key:"addListeners",value:function(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}},{key:"removeListeners",value:function(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}},{key:"status",value:function(t){var e=navigator.onLine;this.online=e,e?this.emit("online",this):this.emit("offline",this)}},{key:"add",value:function(t,e){var n=this,i=t.resources.map((function(t){var i=t.href,r=n.resolver(i),o=window.encodeURIComponent(r);return n.storage.getItem(o).then((function(t){return!t||e?n.requester(r,"binary").then((function(t){return n.storage.setItem(o,t)})):t}))}));return Promise.all(i)}},{key:"put",value:function(t,e,n){var i=this,r=window.encodeURIComponent(t);return this.storage.getItem(r).then((function(o){return o||i.requester(t,"binary",e,n).then((function(t){return i.storage.setItem(r,t)}))}))}},{key:"request",value:function(t,e,n,i){var r=this;return this.online?this.requester(t,e,n,i).then((function(e){return r.put(t),e})):this.retrieve(t,e)}},{key:"retrieve",value:function(t,e){var n=this,i=(new o.defer,new a.a(t));return e||(e=i.extension),("blob"==e?this.getBlob(t):this.getText(t)).then((function(i){var r,s=new o.defer;return i?(r=n.handleResponse(i,e),s.resolve(r)):s.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),s.promise}))}},{key:"handleResponse",value:function(t,e){return"json"==e?JSON.parse(t):Object(o.isXml)(e)?Object(o.parse)(t,"text/xml"):"xhtml"==e?Object(o.parse)(t,"application/xhtml+xml"):"html"==e||"htm"==e?Object(o.parse)(t,"text/html"):t}},{key:"getBlob",value:function(t,e){var n=window.encodeURIComponent(t);return this.storage.getItem(n).then((function(n){if(n)return e=e||L.lookup(t),new Blob([n],{type:e})}))}},{key:"getText",value:function(t,e){var n=window.encodeURIComponent(t);return e=e||L.lookup(t),this.storage.getItem(n).then((function(t){var n,i=new o.defer,r=new FileReader;if(t)return n=new Blob([t],{type:e}),r.addEventListener("loadend",(function(){i.resolve(r.result)})),r.readAsText(n,e),i.promise}))}},{key:"getBase64",value:function(t,e){var n=window.encodeURIComponent(t);return e=e||L.lookup(t),this.storage.getItem(n).then((function(t){var n,i=new o.defer,r=new FileReader;if(t)return n=new Blob([t],{type:e}),r.addEventListener("loadend",(function(){i.resolve(r.result)})),r.readAsDataURL(n,e),i.promise}))}},{key:"createUrl",value:function(t,e){var n,i,r=new o.defer,s=window.URL||window.webkitURL||window.mozURL,a=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(a?(i=this.getBase64(t))&&i.then(function(e){this.urlCache[t]=e,r.resolve(e)}.bind(this)):(i=this.getBlob(t))&&i.then(function(e){n=s.createObjectURL(e),this.urlCache[t]=n,r.resolve(n)}.bind(this)),i||r.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),r.promise)}},{key:"revokeUrl",value:function(t){var e=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[t];n&&e.revokeObjectURL(n)}},{key:"destroy",value:function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache)t.revokeObjectURL(e);this.urlCache={},this.removeListeners()}}])&&H(e.prototype,n),i&&H(e,i),t}();r()(V.prototype);var X=V;function G(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}var e,n,i;return e=t,(n=[{key:"parse",value:function(t){var e=this;if(!t)return this;var n=Object(o.qs)(t,"display_options");return n?(Object(o.qsa)(n,"option").forEach((function(t){var n="";switch(t.childNodes.length&&(n=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":e.interactive=n;break;case"fixed-layout":e.fixedLayout=n;break;case"open-to-spread":e.openToSpread=n;break;case"orientation-lock":e.orientationLock=n}})),this):this}},{key:"destroy",value:function(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}])&&G(e.prototype,n),i&&G(e,i),t}();function K(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var $="binary",Z="base64",J="epub",Q="opf",tt="json",et="directory",nt=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===n&&"string"!=typeof e&&e instanceof Blob==!1&&e instanceof ArrayBuffer==!1&&(n=e,e=void 0),this.settings=Object(o.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),Object(o.extend)(this.settings,n),this.opening=new o.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new o.defer,spine:new o.defer,metadata:new o.defer,cover:new o.defer,navigation:new o.defer,pageList:new o.defer,resources:new o.defer,displayOptions:new o.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||l,this.spine=new g,this.locations=new k(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch((function(t){var n=new Error("Cannot load book at "+e);i.emit(m.c.BOOK.OPEN_FAILED,n)}))}var e,n,i;return e=t,(n=[{key:"open",value:function(t,e){var n,i=e||this.determineType(t);return i===$?(this.archived=!0,this.url=new s.a("/",""),n=this.openEpub(t)):i===Z?(this.archived=!0,this.url=new s.a("/",""),n=this.openEpub(t,i)):i===J?(this.archived=!0,this.url=new s.a("/",""),n=this.request(t,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):i==Q?(this.url=new s.a(t),n=this.openPackaging(this.url.Path.toString())):i==tt?(this.url=new s.a(t),n=this.openManifest(this.url.Path.toString())):(this.url=new s.a(t),n=this.openContainer("META-INF/container.xml").then(this.openPackaging.bind(this))),n}},{key:"openEpub",value:function(t,e){var n=this;return this.unarchive(t,e||this.settings.encoding).then((function(){return n.openContainer("META-INF/container.xml")})).then((function(t){return n.openPackaging(t)}))}},{key:"openContainer",value:function(t){var e=this;return this.load(t).then((function(t){return e.container=new O(t),e.resolve(e.container.packagePath)}))}},{key:"openPackaging",value:function(t){var e=this;return this.path=new a.a(t),this.load(t).then((function(t){return e.packaging=new C(t),e.unpack(e.packaging)}))}},{key:"openManifest",value:function(t){var e=this;return this.path=new a.a(t),this.load(t).then((function(t){return e.packaging=new C,e.packaging.load(t),e.unpack(e.packaging)}))}},{key:"load",value:function(t){var e=this.resolve(t);return this.archived?this.archive.request(e):this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders)}},{key:"resolve",value:function(t,e){if(t){var n=t;return t.indexOf("://")>-1?t:(this.path&&(n=this.path.resolve(t)),0!=e&&this.url&&(n=this.url.resolve(n)),n)}}},{key:"canonical",value:function(t){return t?this.settings.canonical?this.settings.canonical(t):this.resolve(t,!0):""}},{key:"determineType",value:function(t){var e;return"base64"===this.settings.encoding?Z:"string"!=typeof t?$:((e=new s.a(t).path().extension)&&(e=e.replace(/\?.*$/,"")),e?"epub"===e?J:"opf"===e?Q:"json"===e?tt:void 0:et)}},{key:"unpack",value:function(t){var e=this;this.package=t,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then((function(t){e.displayOptions=new Y(t),e.loading.displayOptions.resolve(e.displayOptions)})).catch((function(t){e.displayOptions=new Y,e.loading.displayOptions.resolve(e.displayOptions)})):(this.displayOptions=new Y,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new N(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then((function(){e.loading.navigation.resolve(e.navigation)})),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then((function(){e.loaded.displayOptions.then((function(){e.opening.resolve(e)}))})).catch((function(t){console.error(t)})):this.loaded.displayOptions.then((function(){e.opening.resolve(e)}))}},{key:"loadNavigation",value:function(t){var e=this,n=t.navPath||t.ncxPath,i=t.toc;return i?new Promise((function(n,r){e.navigation=new R(i),t.pageList&&(e.pageList=new D(t.pageList)),n(e.navigation)})):n?this.load(n,"xml").then((function(t){return e.navigation=new R(t),e.pageList=new D(t),e.navigation})):new Promise((function(t,n){e.navigation=new R,e.pageList=new D,t(e.navigation)}))}},{key:"section",value:function(t){return this.spine.get(t)}},{key:"renderTo",value:function(t,e){return this.rendition=new z.a(this,e),this.rendition.attachTo(t),this.rendition}},{key:"setRequestCredentials",value:function(t){this.settings.requestCredentials=t}},{key:"setRequestHeaders",value:function(t){this.settings.requestHeaders=t}},{key:"unarchive",value:function(t,e){return this.archive=new U,this.archive.open(t,e)}},{key:"store",value:function(t){var e=this,n=this.settings.replacements&&"none"!==this.settings.replacements,i=this.url,r=this.settings.requestMethod||l.bind(this);return this.storage=new X(t,r,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then((function(){e.archived&&(e.storage.requester=e.archive.request.bind(e.archive));var t=function(t,n){n.output=e.resources.substitute(t,n.url)};e.resources.settings.replacements=n||"blobUrl",e.resources.replacements().then((function(){return e.resources.replaceCss()})),e.storage.on("offline",(function(){e.url=new s.a("/",""),e.spine.hooks.serialize.register(t)})),e.storage.on("online",(function(){e.url=i,e.spine.hooks.serialize.deregister(t)}))})),this.storage}},{key:"coverUrl",value:function(){var t=this;return this.loaded.cover.then((function(){return t.cover?t.archived?t.archive.createUrl(t.cover):t.cover:null}))}},{key:"replacements",value:function(){var t=this;return this.spine.hooks.serialize.register((function(e,n){n.output=t.resources.substitute(e,n.url)})),this.resources.replacements().then((function(){return t.resources.replaceCss()}))}},{key:"getRange",value:function(t){var e=new u.a(t),n=this.spine.get(e.spinePos),i=this.load.bind(this);return n?n.load(i).then((function(t){return e.toRange(n.document)})):new Promise((function(t,e){e("CFI could not be found")}))}},{key:"key",value:function(t){var e=t||this.packaging.metadata.identifier||this.url.filename;return"epubjs:".concat(m.b,":").concat(e)}},{key:"destroy",value:function(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}])&&K(e.prototype,n),i&&K(e,i),t}();r()(nt.prototype);e.a=nt},function(t,e,n){var i=n(18),r=n(4),o=n(90);t.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var i=n(6),r=n(91),o=i["__core-js_shared__"]||r("__core-js_shared__",{});t.exports=o},function(t,e,n){var i=n(13),r=n(159),o=n(45),s=n(21);t.exports=function(t,e){for(var n=r(e),a=s.f,u=o.f,c=0;c<n.length;c++){var h=n[c];i(t,h)||a(t,h,u(e,h))}}},function(t,e,n){var i=n(6);t.exports=i},function(t,e,n){var i=n(13),r=n(32),o=n(94).indexOf,s=n(54);t.exports=function(t,e){var n,a=r(t),u=0,c=[];for(n in a)!i(s,n)&&i(a,n)&&c.push(n);for(;e.length>u;)i(a,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var i=n(99);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var i=n(38);t.exports=i("navigator","userAgent")||""},function(t,e,n){var i=n(18),r=n(21),o=n(9),s=n(79);t.exports=i?Object.defineProperties:function(t,e){o(t);for(var n,i=s(e),a=i.length,u=0;a>u;)r.f(t,n=i[u++],e[n]);return t}},function(t,e,n){var i=n(38);t.exports=i("document","documentElement")},function(t,e,n){"use strict";var i=n(3),r=n(127),o=n(59),s=n(101),a=n(43),u=n(27),c=n(28),h=n(5),l=n(47),f=n(58),d=n(128),p=d.IteratorPrototype,v=d.BUGGY_SAFARI_ITERATORS,g=h("iterator"),y=function(){return this};t.exports=function(t,e,n,h,d,m,b){r(n,e,h);var w,k,x,E=function(t){if(t===d&&T)return T;if(!v&&t in _)return _[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},S=e+" Iterator",O=!1,_=t.prototype,C=_[g]||_["@@iterator"]||d&&_[d],T=!v&&C||E(d),R="Array"==e&&_.entries||C;if(R&&(w=o(R.call(new t)),p!==Object.prototype&&w.next&&(l||o(w)===p||(s?s(w,p):"function"!=typeof w[g]&&u(w,g,y)),a(w,S,!0,!0),l&&(f[S]=y))),"values"==d&&C&&"values"!==C.name&&(O=!0,T=function(){return C.call(this)}),l&&!b||_[g]===T||u(_,g,T),f[e]=T,d)if(k={values:E("values"),keys:m?T:E("keys"),entries:E("entries")},b)for(x in k)(v||O||!(x in _))&&c(_,x,k[x]);else i({target:e,proto:!0,forced:v||O},k);return k}},function(t,e,n){"use strict";var i=n(128).IteratorPrototype,r=n(57),o=n(46),s=n(43),a=n(58),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=r(i,{next:o(1,n)}),s(t,c,!1,!0),a[c]=u,t}},function(t,e,n){"use strict";var i,r,o,s=n(59),a=n(27),u=n(13),c=n(5),h=n(47),l=c("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(r=s(s(o)))!==Object.prototype&&(i=r):f=!0),null==i&&(i={}),h||u(i,l)||a(i,l,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},function(t,e,n){var i=n(4);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){"use strict";var i=n(25),r=n(74),o=n(22);t.exports=function(t){for(var e=i(this),n=o(e.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:r(u,n);c>a;)e[a++]=t;return e}},function(t,e,n){var i=n(5),r=n(58),o=i("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||s[o]===t)}},function(t,e,n){var i=n(9);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},function(t,e,n){var i=n(9),r=n(44),o=n(5)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||null==(n=i(s)[o])?e:r(n)}},function(t,e,n){var i,r,o,s=n(6),a=n(4),u=n(37),c=n(60),h=n(125),l=n(90),f=n(135),d=s.location,p=s.setImmediate,v=s.clearImmediate,g=s.process,y=s.MessageChannel,m=s.Dispatch,b=0,w={},k=function(t){if(w.hasOwnProperty(t)){var e=w[t];delete w[t],e()}},x=function(t){return function(){k(t)}},E=function(t){k(t.data)},S=function(t){s.postMessage(t+"",d.protocol+"//"+d.host)};p&&v||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return w[++b]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},i(b),b},v=function(t){delete w[t]},"process"==u(g)?i=function(t){g.nextTick(x(t))}:m&&m.now?i=function(t){m.now(x(t))}:y&&!f?(o=(r=new y).port2,r.port1.onmessage=E,i=c(o.postMessage,o,1)):!s.addEventListener||"function"!=typeof postMessage||s.importScripts||a(S)||"file:"===d.protocol?i="onreadystatechange"in l("script")?function(t){h.appendChild(l("script")).onreadystatechange=function(){h.removeChild(this),k(t)}}:function(t){setTimeout(x(t),0)}:(i=S,s.addEventListener("message",E,!1))),t.exports={set:p,clear:v}},function(t,e,n){var i=n(123);t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(i)},function(t,e,n){"use strict";var i=n(44),r=function(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)};t.exports.f=function(t){return new r(t)}},function(t,e,n){"use strict";var i=n(4);function r(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=i((function(){var t=r("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=i((function(){var t=r("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,n){"use strict";var i=n(63).forEach,r=n(77),o=n(35),s=r("forEach"),a=o("forEach");t.exports=s&&a?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,n){var i=n(4);t.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(t,e,n){var i=n(3),r=n(4),o=n(32),s=n(45).f,a=n(18),u=r((function(){s(1)}));i({target:"Object",stat:!0,forced:!a||u,sham:!a},{getOwnPropertyDescriptor:function(t,e){return s(o(t),e)}})},function(t,e,n){var i=n(32),r=n(55).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},function(t,e,n){var i=n(4),r=n(5),o=n(47),s=r("iterator");t.exports=!i((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,n="";return t.pathname="c%20d",e.forEach((function(t,i){e.delete("b"),n+=i+t})),o&&!t.toJSON||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(t,e,n){"use strict";var i=n(18),r=n(4),o=n(79),s=n(96),a=n(89),u=n(25),c=n(53),h=Object.assign,l=Object.defineProperty;t.exports=!h||r((function(){if(i&&1!==h({b:1},h(l({},"a",{enumerable:!0,get:function(){l(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol();return t[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=h({},t)[n]||"abcdefghijklmnopqrst"!=o(h({},e)).join("")}))?function(t,e){for(var n=u(t),r=arguments.length,h=1,l=s.f,f=a.f;r>h;)for(var d,p=c(arguments[h++]),v=l?o(p).concat(l(p)):o(p),g=v.length,y=0;g>y;)d=v[y++],i&&!f.call(p,d)||(n[d]=p[d]);return n}:h},function(t,e,n){var i=n(5);e.f=i},function(t,e,n){var i=n(120),r=n(13),o=n(145),s=n(21).f;t.exports=function(t){var e=i.Symbol||(i.Symbol={});r(e,t)||s(e,t,{value:o.f(t)})}},function(t,e,n){"use strict";var i=n(3),r=n(53),o=n(32),s=n(77),a=[].join,u=r!=Object,c=s("join",",");i({target:"Array",proto:!0,forced:u||!c},{join:function(t){return a.call(o(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var i=n(83),r=n(9),o=n(22),s=n(33),a=n(108),u=n(84);i("match",1,(function(t,e,n){return[function(e){var n=s(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,n):new RegExp(e)[t](String(n))},function(t){var i=n(e,t,this);if(i.done)return i.value;var s=r(t),c=String(this);if(!s.global)return u(s,c);var h=s.unicode;s.lastIndex=0;for(var l,f=[],d=0;null!==(l=u(s,c));){var p=String(l[0]);f[d]=p,""===p&&(s.lastIndex=a(c,o(s.lastIndex),h)),d++}return 0===d?null:f}]}))},function(t,e,n){"use strict";var i=n(3),r=n(63).find,o=n(78),s=n(35),a=!0,u=s("find");"find"in[]&&Array(1).find((function(){a=!1})),i({target:"Array",proto:!0,forced:a||!u},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o("find")},function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var i=n(3),r=n(94).includes,o=n(78);i({target:"Array",proto:!0,forced:!n(35)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(t,e,n){"use strict";var i=n(3),r=n(204),o=n(33);i({target:"String",proto:!0,forced:!n(205)("includes")},{includes:function(t){return!!~String(o(this)).indexOf(r(t),arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(210),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();t.exports=o},function(t,e,n){var i=n(153).Symbol;t.exports=i},function(t,e,n){var i=n(113),r=n(111);t.exports=function(t,e,n){var o=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return r(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),i(t,e,{leading:o,maxWait:e,trailing:s})}},function(t,n){t.exports=e},function(t,e,n){"use strict";n.r(e),function(t){var i=n(116),r=n(88),o=n(2),s=n(68),a=n(0),u=n(1);n(112),n(50),n(114);function c(t,e){return new i.a(t,e)}c.VERSION=u.b,void 0!==t&&(t.EPUBJS_VERSION=u.b),c.Book=i.a,c.Rendition=r.a,c.Contents=s.a,c.CFI=o.a,c.utils=a,e.default=c}.call(this,n(70))},function(t,e,n){var i=n(6),r=n(92),o=i.WeakMap;t.exports="function"==typeof o&&/native code/.test(r(o))},function(t,e,n){var i=n(38),r=n(55),o=n(96),s=n(9);t.exports=i("Reflect","ownKeys")||function(t){var e=r.f(s(t)),n=o.f;return n?e.concat(n(t)):e}},function(t,e,n){var i=n(8);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,n){"use strict";var i=n(3),r=n(6),o=n(162),s=n(103),a=o.ArrayBuffer;i({global:!0,forced:r.ArrayBuffer!==a},{ArrayBuffer:a}),s("ArrayBuffer")},function(t,e,n){"use strict";var i=n(6),r=n(18),o=n(163),s=n(27),a=n(102),u=n(4),c=n(80),h=n(42),l=n(22),f=n(164),d=n(165),p=n(59),v=n(101),g=n(55).f,y=n(21).f,m=n(130),b=n(43),w=n(34),k=w.get,x=w.set,E=i.ArrayBuffer,S=E,O=i.DataView,_=O&&O.prototype,C=Object.prototype,T=i.RangeError,R=d.pack,j=d.unpack,I=function(t){return[255&t]},L=function(t){return[255&t,t>>8&255]},A=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},N=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},P=function(t){return R(t,23,4)},D=function(t){return R(t,52,8)},z=function(t,e){y(t.prototype,e,{get:function(){return k(this)[e]}})},B=function(t,e,n,i){var r=f(n),o=k(t);if(r+e>o.byteLength)throw T("Wrong index");var s=k(o.buffer).bytes,a=r+o.byteOffset,u=s.slice(a,a+e);return i?u:u.reverse()},M=function(t,e,n,i,r,o){var s=f(n),a=k(t);if(s+e>a.byteLength)throw T("Wrong index");for(var u=k(a.buffer).bytes,c=s+a.byteOffset,h=i(+r),l=0;l<e;l++)u[c+l]=h[o?l:e-l-1]};if(o){if(!u((function(){E(1)}))||!u((function(){new E(-1)}))||u((function(){return new E,new E(1.5),new E(NaN),"ArrayBuffer"!=E.name}))){for(var q,U=(S=function(t){return c(this,S),new E(f(t))}).prototype=E.prototype,F=g(E),W=0;F.length>W;)(q=F[W++])in S||s(S,q,E[q]);U.constructor=S}v&&p(_)!==C&&v(_,C);var H=new O(new S(2)),V=_.setInt8;H.setInt8(0,2147483648),H.setInt8(1,2147483649),!H.getInt8(0)&&H.getInt8(1)||a(_,{setInt8:function(t,e){V.call(this,t,e<<24>>24)},setUint8:function(t,e){V.call(this,t,e<<24>>24)}},{unsafe:!0})}else S=function(t){c(this,S,"ArrayBuffer");var e=f(t);x(this,{bytes:m.call(new Array(e),0),byteLength:e}),r||(this.byteLength=e)},O=function(t,e,n){c(this,O,"DataView"),c(t,S,"DataView");var i=k(t).byteLength,o=h(e);if(o<0||o>i)throw T("Wrong offset");if(o+(n=void 0===n?i-o:l(n))>i)throw T("Wrong length");x(this,{buffer:t,byteLength:n,byteOffset:o}),r||(this.buffer=t,this.byteLength=n,this.byteOffset=o)},r&&(z(S,"byteLength"),z(O,"buffer"),z(O,"byteLength"),z(O,"byteOffset")),a(O.prototype,{getInt8:function(t){return B(this,1,t)[0]<<24>>24},getUint8:function(t){return B(this,1,t)[0]},getInt16:function(t){var e=B(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=B(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return N(B(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return N(B(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return j(B(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return j(B(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){M(this,1,t,I,e)},setUint8:function(t,e){M(this,1,t,I,e)},setInt16:function(t,e){M(this,2,t,L,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){M(this,2,t,L,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){M(this,4,t,A,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){M(this,4,t,A,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){M(this,4,t,P,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){M(this,8,t,D,e,arguments.length>2?arguments[2]:void 0)}});b(S,"ArrayBuffer"),b(O,"DataView"),t.exports={ArrayBuffer:S,DataView:O}},function(t,e){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(t,e,n){var i=n(42),r=n(22);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length or index");return n}},function(t,e){var n=Math.abs,i=Math.pow,r=Math.floor,o=Math.log,s=Math.LN2;t.exports={pack:function(t,e,a){var u,c,h,l=new Array(a),f=8*a-e-1,d=(1<<f)-1,p=d>>1,v=23===e?i(2,-24)-i(2,-77):0,g=t<0||0===t&&1/t<0?1:0,y=0;for((t=n(t))!=t||t===1/0?(c=t!=t?1:0,u=d):(u=r(o(t)/s),t*(h=i(2,-u))<1&&(u--,h*=2),(t+=u+p>=1?v/h:v*i(2,1-p))*h>=2&&(u++,h/=2),u+p>=d?(c=0,u=d):u+p>=1?(c=(t*h-1)*i(2,e),u+=p):(c=t*i(2,p-1)*i(2,e),u=0));e>=8;l[y++]=255&c,c/=256,e-=8);for(u=u<<e|c,f+=e;f>0;l[y++]=255&u,u/=256,f-=8);return l[--y]|=128*g,l},unpack:function(t,e){var n,r=t.length,o=8*r-e-1,s=(1<<o)-1,a=s>>1,u=o-7,c=r-1,h=t[c--],l=127&h;for(h>>=7;u>0;l=256*l+t[c],c--,u-=8);for(n=l&(1<<-u)-1,l>>=-u,u+=e;u>0;n=256*n+t[c],c--,u-=8);if(0===l)l=1-a;else{if(l===s)return n?NaN:h?-1/0:1/0;n+=i(2,e),l-=a}return(h?-1:1)*n*i(2,l-e)}}},function(t,e,n){"use strict";var i=n(104),r=n(105);t.exports=i?{}.toString:function(){return"[object "+r(this)+"]"}},function(t,e,n){var i=n(6);t.exports=i.Promise},function(t,e,n){var i=n(9),r=n(131),o=n(22),s=n(60),a=n(81),u=n(132),c=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,e,n,h,l){var f,d,p,v,g,y,m,b=s(e,n,h?2:1);if(l)f=t;else{if("function"!=typeof(d=a(t)))throw TypeError("Target is not iterable");if(r(d)){for(p=0,v=o(t.length);v>p;p++)if((g=h?b(i(m=t[p])[0],m[1]):b(t[p]))&&g instanceof c)return g;return new c(!1)}f=d.call(t)}for(y=f.next;!(m=y.call(f)).done;)if("object"==typeof(g=u(f,b,m.value,h))&&g&&g instanceof c)return g;return new c(!1)}).stop=function(t){return new c(!0,t)}},function(t,e,n){var i=n(5)("iterator"),r=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){r=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}},function(t,e,n){var i,r,o,s,a,u,c,h,l=n(6),f=n(45).f,d=n(37),p=n(134).set,v=n(135),g=l.MutationObserver||l.WebKitMutationObserver,y=l.process,m=l.Promise,b="process"==d(y),w=f(l,"queueMicrotask"),k=w&&w.value;k||(i=function(){var t,e;for(b&&(t=y.domain)&&t.exit();r;){e=r.fn,r=r.next;try{e()}catch(t){throw r?s():o=void 0,t}}o=void 0,t&&t.enter()},b?s=function(){y.nextTick(i)}:g&&!v?(a=!0,u=document.createTextNode(""),new g(i).observe(u,{characterData:!0}),s=function(){u.data=a=!a}):m&&m.resolve?(c=m.resolve(void 0),h=c.then,s=function(){h.call(c,i)}):s=function(){p.call(l,i)}),t.exports=k||function(t){var e={fn:t,next:void 0};o&&(o.next=e),r||(r=e,s()),o=e}},function(t,e,n){var i=n(9),r=n(8),o=n(136);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var i=n(6);t.exports=function(t,e){var n=i.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,e,n){"use strict";var i=n(175),r=n(183),o=n(184),s=n(185);(t.exports=function(t,e){var n,o,a,u,c;return arguments.length<2||"string"!=typeof t?(u=e,e=t,t=null):u=arguments[2],null==t?(n=a=!0,o=!1):(n=s.call(t,"c"),o=s.call(t,"e"),a=s.call(t,"w")),c={value:e,configurable:n,enumerable:o,writable:a},u?i(r(u),c):c}).gs=function(t,e,n){var a,u,c,h;return"string"!=typeof t?(c=n,n=e,e=t,t=null):c=arguments[3],null==e?e=void 0:o(e)?null==n?n=void 0:o(n)||(c=n,n=void 0):(c=e,e=n=void 0),null==t?(a=!0,u=!1):(a=s.call(t,"c"),u=s.call(t,"e")),h={get:e,set:n,configurable:a,enumerable:u},c?i(r(c),h):h}},function(t,e,n){"use strict";t.exports=n(176)()?Object.assign:n(177)},function(t,e,n){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,e,n){"use strict";var i=n(178),r=n(182),o=Math.max;t.exports=function(t,e){var n,s,a,u=o(arguments.length,2);for(t=Object(r(t)),a=function(i){try{t[i]=e[i]}catch(t){n||(n=t)}},s=1;s<u;++s)i(e=arguments[s]).forEach(a);if(void 0!==n)throw n;return t}},function(t,e,n){"use strict";t.exports=n(179)()?Object.keys:n(180)},function(t,e,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,e,n){"use strict";var i=n(109),r=Object.keys;t.exports=function(t){return r(i(t)?Object(t):t)}},function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";var i=n(109);t.exports=function(t){if(!i(t))throw new TypeError("Cannot use null or undefined");return t}},function(t,e,n){"use strict";var i=n(109),r=Array.prototype.forEach,o=Object.create,s=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return r.call(arguments,(function(t){i(t)&&s(Object(t),e)})),e}},function(t,e,n){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,e,n){"use strict";t.exports=n(186)()?String.prototype.contains:n(187)},function(t,e,n){"use strict";var i="razdwatrzy";t.exports=function(){return"function"==typeof i.contains&&(!0===i.contains("dwa")&&!1===i.contains("foo"))}},function(t,e,n){"use strict";var i=String.prototype.indexOf;t.exports=function(t){return i.call(this,t,arguments[1])>-1}},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,e,n){var i=n(3),r=n(140),o=n(4),s=n(8),a=n(190).onFreeze,u=Object.freeze;i({target:"Object",stat:!0,forced:o((function(){u(1)})),sham:!r},{freeze:function(t){return u&&s(t)?u(a(t)):t}})},function(t,e,n){var i=n(54),r=n(8),o=n(13),s=n(21).f,a=n(73),u=n(140),c=a("meta"),h=0,l=Object.isExtensible||function(){return!0},f=function(t){s(t,c,{value:{objectID:"O"+ ++h,weakData:{}}})},d=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,c)){if(!l(t))return"F";if(!e)return"E";f(t)}return t[c].objectID},getWeakData:function(t,e){if(!o(t,c)){if(!l(t))return!0;if(!e)return!1;f(t)}return t[c].weakData},onFreeze:function(t){return u&&d.REQUIRED&&l(t)&&!o(t,c)&&f(t),t}};i[c]=!0},function(t,e,n){var i=n(3),r=n(4),o=n(142).f;i({target:"Object",stat:!0,forced:r((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},function(t,e,n){"use strict";var i=n(60),r=n(25),o=n(132),s=n(131),a=n(22),u=n(76),c=n(81);t.exports=function(t){var e,n,h,l,f,d,p=r(t),v="function"==typeof this?this:Array,g=arguments.length,y=g>1?arguments[1]:void 0,m=void 0!==y,b=c(p),w=0;if(m&&(y=i(y,g>2?arguments[2]:void 0,2)),null==b||v==Array&&s(b))for(n=new v(e=a(p.length));e>w;w++)d=m?y(p[w],w):p[w],u(n,w,d);else for(f=(l=b.call(p)).next,n=new v;!(h=f.call(l)).done;w++)d=m?o(l,y,[h.value,w],!0):h.value,u(n,w,d);return n.length=w,n}},function(t,e,n){"use strict";var i=/[^\0-\u007E]/,r=/[.\u3002\uFF0E\uFF61]/g,o="Overflow: input needs wider integers to process",s=Math.floor,a=String.fromCharCode,u=function(t){return t+22+75*(t<26)},c=function(t,e,n){var i=0;for(t=n?s(t/700):t>>1,t+=s(t/e);t>455;i+=36)t=s(t/35);return s(i+36*t/(t+38))},h=function(t){var e,n,i=[],r=(t=function(t){for(var e=[],n=0,i=t.length;n<i;){var r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=t.charCodeAt(n++);56320==(64512&o)?e.push(((1023&r)<<10)+(1023&o)+65536):(e.push(r),n--)}else e.push(r)}return e}(t)).length,h=128,l=0,f=72;for(e=0;e<t.length;e++)(n=t[e])<128&&i.push(a(n));var d=i.length,p=d;for(d&&i.push("-");p<r;){var v=2147483647;for(e=0;e<t.length;e++)(n=t[e])>=h&&n<v&&(v=n);var g=p+1;if(v-h>s((2147483647-l)/g))throw RangeError(o);for(l+=(v-h)*g,h=v,e=0;e<t.length;e++){if((n=t[e])<h&&++l>2147483647)throw RangeError(o);if(n==h){for(var y=l,m=36;;m+=36){var b=m<=f?1:m>=f+26?26:m-f;if(y<b)break;var w=y-b,k=36-b;i.push(a(u(b+w%k))),y=s(w/k)}i.push(a(u(y))),f=c(l,g,p==d),l=0,++p}}++l,++h}return i.join("")};t.exports=function(t){var e,n,o=[],s=t.toLowerCase().replace(r,".").split(".");for(e=0;e<s.length;e++)n=s[e],o.push(i.test(n)?"xn--"+h(n):n);return o.join(".")}},function(t,e,n){"use strict";n(15);var i=n(3),r=n(38),o=n(143),s=n(28),a=n(102),u=n(43),c=n(127),h=n(34),l=n(80),f=n(13),d=n(60),p=n(105),v=n(9),g=n(8),y=n(57),m=n(46),b=n(195),w=n(81),k=n(5),x=r("fetch"),E=r("Headers"),S=k("iterator"),O=h.set,_=h.getterFor("URLSearchParams"),C=h.getterFor("URLSearchParamsIterator"),T=/\+/g,R=Array(4),j=function(t){return R[t-1]||(R[t-1]=RegExp("((?:%[\\da-f]{2}){"+t+"})","gi"))},I=function(t){try{return decodeURIComponent(t)}catch(e){return t}},L=function(t){var e=t.replace(T," "),n=4;try{return decodeURIComponent(e)}catch(t){for(;n;)e=e.replace(j(n--),I);return e}},A=/[!'()~]|%20/g,N={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},P=function(t){return N[t]},D=function(t){return encodeURIComponent(t).replace(A,P)},z=function(t,e){if(e)for(var n,i,r=e.split("&"),o=0;o<r.length;)(n=r[o++]).length&&(i=n.split("="),t.push({key:L(i.shift()),value:L(i.join("="))}))},B=function(t){this.entries.length=0,z(this.entries,t)},M=function(t,e){if(t<e)throw TypeError("Not enough arguments")},q=c((function(t,e){O(this,{type:"URLSearchParamsIterator",iterator:b(_(t).entries),kind:e})}),"Iterator",(function(){var t=C(this),e=t.kind,n=t.iterator.next(),i=n.value;return n.done||(n.value="keys"===e?i.key:"values"===e?i.value:[i.key,i.value]),n})),U=function(){l(this,U,"URLSearchParams");var t,e,n,i,r,o,s,a,u,c=arguments.length>0?arguments[0]:void 0,h=this,d=[];if(O(h,{type:"URLSearchParams",entries:d,updateURL:function(){},updateSearchParams:B}),void 0!==c)if(g(c))if("function"==typeof(t=w(c)))for(n=(e=t.call(c)).next;!(i=n.call(e)).done;){if((s=(o=(r=b(v(i.value))).next).call(r)).done||(a=o.call(r)).done||!o.call(r).done)throw TypeError("Expected sequence with length 2");d.push({key:s.value+"",value:a.value+""})}else for(u in c)f(c,u)&&d.push({key:u,value:c[u]+""});else z(d,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},F=U.prototype;a(F,{append:function(t,e){M(arguments.length,2);var n=_(this);n.entries.push({key:t+"",value:e+""}),n.updateURL()},delete:function(t){M(arguments.length,1);for(var e=_(this),n=e.entries,i=t+"",r=0;r<n.length;)n[r].key===i?n.splice(r,1):r++;e.updateURL()},get:function(t){M(arguments.length,1);for(var e=_(this).entries,n=t+"",i=0;i<e.length;i++)if(e[i].key===n)return e[i].value;return null},getAll:function(t){M(arguments.length,1);for(var e=_(this).entries,n=t+"",i=[],r=0;r<e.length;r++)e[r].key===n&&i.push(e[r].value);return i},has:function(t){M(arguments.length,1);for(var e=_(this).entries,n=t+"",i=0;i<e.length;)if(e[i++].key===n)return!0;return!1},set:function(t,e){M(arguments.length,1);for(var n,i=_(this),r=i.entries,o=!1,s=t+"",a=e+"",u=0;u<r.length;u++)(n=r[u]).key===s&&(o?r.splice(u--,1):(o=!0,n.value=a));o||r.push({key:s,value:a}),i.updateURL()},sort:function(){var t,e,n,i=_(this),r=i.entries,o=r.slice();for(r.length=0,n=0;n<o.length;n++){for(t=o[n],e=0;e<n;e++)if(r[e].key>t.key){r.splice(e,0,t);break}e===n&&r.push(t)}i.updateURL()},forEach:function(t){for(var e,n=_(this).entries,i=d(t,arguments.length>1?arguments[1]:void 0,3),r=0;r<n.length;)i((e=n[r++]).value,e.key,this)},keys:function(){return new q(this,"keys")},values:function(){return new q(this,"values")},entries:function(){return new q(this,"entries")}},{enumerable:!0}),s(F,S,F.entries),s(F,"toString",(function(){for(var t,e=_(this).entries,n=[],i=0;i<e.length;)t=e[i++],n.push(D(t.key)+"="+D(t.value));return n.join("&")}),{enumerable:!0}),u(U,"URLSearchParams"),i({global:!0,forced:!o},{URLSearchParams:U}),o||"function"!=typeof x||"function"!=typeof E||i({global:!0,enumerable:!0,forced:!0},{fetch:function(t){var e,n,i,r=[t];return arguments.length>1&&(g(e=arguments[1])&&(n=e.body,"URLSearchParams"===p(n)&&((i=e.headers?new E(e.headers):new E).has("content-type")||i.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),e=y(e,{body:m(0,String(n)),headers:m(0,i)}))),r.push(e)),x.apply(this,r)}}),t.exports={URLSearchParams:U,getState:_}},function(t,e,n){var i=n(9),r=n(81);t.exports=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return i(e.call(t))}},function(t,e,n){"use strict";var i=n(83),r=n(9),o=n(33),s=n(197),a=n(84);i("search",1,(function(t,e,n){return[function(e){var n=o(this),i=null==e?void 0:e[t];return void 0!==i?i.call(e,n):new RegExp(e)[t](String(n))},function(t){var i=n(e,t,this);if(i.done)return i.value;var o=r(t),u=String(this),c=o.lastIndex;s(c,0)||(o.lastIndex=0);var h=a(o,u);return s(o.lastIndex,c)||(o.lastIndex=c),null===h?-1:h.index}]}))},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var i=n(3),r=n(199).left,o=n(77),s=n(35),a=o("reduce"),u=s("reduce",{1:0});i({target:"Array",proto:!0,forced:!a||!u},{reduce:function(t){return r(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(44),r=n(25),o=n(53),s=n(22),a=function(t){return function(e,n,a,u){i(n);var c=r(e),h=o(c),l=s(c.length),f=t?l-1:0,d=t?-1:1;if(a<2)for(;;){if(f in h){u=h[f],f+=d;break}if(f+=d,t?f<0:l<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:l>f;f+=d)f in h&&(u=n(u,h[f],f,c));return u}};t.exports={left:a(!1),right:a(!0)}},function(t,e,n){var i=n(18),r=n(6),o=n(97),s=n(201),a=n(21).f,u=n(55).f,c=n(110),h=n(106),l=n(137),f=n(28),d=n(4),p=n(34).set,v=n(103),g=n(5)("match"),y=r.RegExp,m=y.prototype,b=/a/g,w=/a/g,k=new y(b)!==b,x=l.UNSUPPORTED_Y;if(i&&o("RegExp",!k||x||d((function(){return w[g]=!1,y(b)!=b||y(w)==w||"/a/i"!=y(b,"i")})))){for(var E=function(t,e){var n,i=this instanceof E,r=c(t),o=void 0===e;if(!i&&r&&t.constructor===E&&o)return t;k?r&&!o&&(t=t.source):t instanceof E&&(o&&(e=h.call(t)),t=t.source),x&&(n=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var a=s(k?new y(t,e):y(t,e),i?this:m,E);return x&&n&&p(a,{sticky:n}),a},S=function(t){t in E||a(E,t,{configurable:!0,get:function(){return y[t]},set:function(e){y[t]=e}})},O=u(y),_=0;O.length>_;)S(O[_++]);m.constructor=E,E.prototype=m,f(r,"RegExp",E)}v("RegExp")},function(t,e,n){var i=n(8),r=n(101);t.exports=function(t,e,n){var o,s;return r&&"function"==typeof(o=e.constructor)&&o!==n&&i(s=o.prototype)&&s!==n.prototype&&r(t,s),t}},function(t,e,n){var i=n(33),r="["+n(150)+"]",o=RegExp("^"+r+r+"*"),s=RegExp(r+r+"*$"),a=function(t){return function(e){var n=String(i(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:a(1),end:a(2),trim:a(3)}},function(t,e,n){var i=n(4),r=n(150);t.exports=function(t){return i((function(){return!!r[t]()||"​᠎"!="​᠎"[t]()||r[t].name!==t}))}},function(t,e,n){var i=n(110);t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,n){var i=n(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,n){var i=n(3),r=n(144);i({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},function(t,e,n){"use strict";function i(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}Object.defineProperty(e,"__esModule",{value:!0}),e.createElement=i,e.default={createElement:i}},function(t,e,n){"use strict";function i(t,e){function n(n){for(var i=e.length-1;i>=0;i--){var s=e[i],a=n.clientX,u=n.clientY;if(n.touches&&n.touches.length&&(a=n.touches[0].clientX,u=n.touches[0].clientY),o(s,t,a,u)){s.dispatchEvent(r(n));break}}}if("iframe"===t.nodeName||"IFRAME"===t.nodeName)try{this.target=t.contentDocument}catch(e){this.target=t}else this.target=t;for(var i=["mouseup","mousedown","click","touchstart"],s=0;s<i.length;s++){var a=i[s];this.target.addEventListener(a,(function(t){return n(t)}),!1)}}function r(t){var e=Object.assign({},t,{bubbles:!1});try{return new MouseEvent(t.type,e)}catch(i){var n=document.createEvent("MouseEvents");return n.initMouseEvent(t.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),n}}function o(t,e,n,i){var r=e.getBoundingClientRect();function o(t,e,n){var i=t.top-r.top,o=t.left-r.left,s=i+t.height,a=o+t.width;return i<=n&&o<=e&&s>n&&a>e}if(!o(t.getBoundingClientRect(),n,i))return!1;for(var s=t.getClientRects(),a=0,u=s.length;a<u;a++)if(o(s[a],n,i))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.proxyMouse=i,e.clone=r,e.default={proxyMouse:i}},function(t,e,n){var i=n(153);t.exports=function(){return i.Date.now()}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(70))},function(t,e,n){var i=n(111),r=n(212),o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(r(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=a.test(t);return n||u.test(t)?c(t.slice(2),n?2:8):s.test(t)?NaN:+t}},function(t,e,n){var i=n(213),r=n(216);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}},function(t,e,n){var i=n(154),r=n(214),o=n(215),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?r(t):o(t)}},function(t,e,n){var i=n(154),r=Object.prototype,o=r.hasOwnProperty,s=r.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),n=t[a];try{t[a]=void 0;var i=!0}catch(t){}var r=s.call(t);return i&&(e?t[a]=n:delete t[a]),r}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var i=n(3),r=n(130),o=n(78);i({target:"Array",proto:!0},{fill:r}),o("fill")},function(t,e,n){var i=n(3),r=n(4),o=n(25),s=n(59),a=n(129);i({target:"Object",stat:!0,forced:r((function(){s(1)})),sham:!a},{getPrototypeOf:function(t){return s(o(t))}})},function(t,e,n){var i=n(3),r=n(38),o=n(44),s=n(9),a=n(8),u=n(57),c=n(220),h=n(4),l=r("Reflect","construct"),f=h((function(){function t(){}return!(l((function(){}),[],t)instanceof t)})),d=!h((function(){l((function(){}))})),p=f||d;i({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(d&&!f)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(c.apply(t,i))}var r=n.prototype,h=u(a(r)?r:Object.prototype),p=Function.apply.call(t,h,e);return a(p)?p:h}})},function(t,e,n){"use strict";var i=n(44),r=n(8),o=[].slice,s={},a=function(t,e,n){if(!(e in s)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";s[e]=Function("C,a","return new C("+i.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=o.call(arguments,1),s=function(){var i=n.concat(o.call(arguments));return this instanceof s?a(e,i.length,i):e.apply(t,i)};return r(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e,n){var i=n(3),r=n(8),o=n(9),s=n(13),a=n(45),u=n(59);i({target:"Reflect",stat:!0},{get:function t(e,n){var i,c,h=arguments.length<3?e:arguments[2];return o(e)===h?e[n]:(i=a.f(e,n))?s(i,"value")?i.value:void 0===i.get?void 0:i.get.call(h):r(c=u(e))?t(c,n,h):void 0}})}]).default}));